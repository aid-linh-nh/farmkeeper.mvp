<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá th·ªëng Form GAP - S·∫ßu ri√™ng</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }
        
        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .nav-tab:hover {
            background: #e9ecef;
        }
        
        .nav-tab.active {
            background: white;
            border-bottom-color: #007bff;
            color: #007bff;
            font-weight: 600;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.3s ease-in;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 4px solid #007bff;
        }
        
        .form-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
        }
        
        .form-section h3::before {
            content: "üìã";
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            margin: 5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745, #1e7e34);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffc107, #e0a800);
            color: #212529;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .data-table th,
        .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .data-table th {
            background: linear-gradient(135deg, #495057, #6c757d);
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
        }
        
        .data-table tr:hover {
            background: #f8f9fa;
        }
        
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #007bff;
        }
        
        .summary-card {
            background: linear-gradient(135deg, #e8f5e8, #f0f8f0);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #28a745;
        }
        
        .summary-card h4 {
            color: #155724;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .export-section {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
            text-align: center;
        }
        
        .export-section h3 {
            color: #856404;
            margin-bottom: 20px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid;
        }
        
        .alert-info {
            background: #d1ecf1;
            border-color: #17a2b8;
            color: #0c5460;
        }
        
        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü•≠ H·ªá th·ªëng GAP S·∫ßu ri√™ng</h1>
            <p>Qu·∫£n l√Ω s·∫£n xu·∫•t theo ti√™u chu·∫©n GAP - T√≠ch h·ª£p ph·∫ßn m·ªÅm</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('farm-info')">Th√¥ng tin v∆∞·ªùn</button>
            <button class="nav-tab" onclick="showTab('fertilizer')">Qu·∫£n l√Ω ph√¢n b√≥n</button>
            <button class="nav-tab" onclick="showTab('pesticide')">Thu·ªëc BVTV</button>
            <button class="nav-tab" onclick="showTab('care')">ChƒÉm s√≥c</button>
            <button class="nav-tab" onclick="showTab('harvest')">Thu ho·∫°ch</button>
            <button class="nav-tab" onclick="showTab('export')">Xu·∫•t b√°o c√°o</button>
        </div>
        
        <!-- Tab 1: Th√¥ng tin v∆∞·ªùn -->
        <div id="farm-info" class="tab-content active">
            <div class="form-section">
                <h3>Th√¥ng tin c∆° b·∫£n</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>T√™n c∆° s·ªü s·∫£n xu·∫•t</label>
                        <input type="text" id="farm-name" placeholder="Nh·∫≠p t√™n c∆° s·ªü">
                    </div>
                    <div class="form-group">
                        <label>M√£ GAP</label>
                        <input type="text" id="gap-code" placeholder="VD: GAP-001-2025">
                    </div>
                    <div class="form-group">
                        <label>Ch·ªß c∆° s·ªü</label>
                        <input type="text" id="owner-name" placeholder="H·ªç t√™n ch·ªß c∆° s·ªü">
                    </div>
                    <div class="form-group">
                        <label>ƒêi·ªán tho·∫°i</label>
                        <input type="tel" id="phone" placeholder="0xxx xxx xxx">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Th√¥ng tin l√¥ ƒë·∫•t</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>M√£ l√¥</label>
                        <input type="text" id="plot-code" placeholder="VD: L01">
                    </div>
                    <div class="form-group">
                        <label>Di·ªán t√≠ch (ha)</label>
                        <input type="number" id="area" step="0.1" placeholder="VD: 2.5">
                    </div>
                    <div class="form-group">
                        <label>Gi·ªëng s·∫ßu ri√™ng</label>
                        <select id="durian-variety">
                            <option value="">Ch·ªçn gi·ªëng</option>
                            <option value="ri6">Ri6</option>
                            <option value="monthong">Monthong</option>
                            <option value="chanee">Chanee</option>
                            <option value="dona">Dona</option>
                            <option value="other">Kh√°c</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tu·ªïi v∆∞·ªùn (nƒÉm)</label>
                        <input type="number" id="tree-age" placeholder="VD: 5">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="addPlot()">Th√™m l√¥ ƒë·∫•t</button>
            </div>
        </div>
        
        <!-- Tab 2: Qu·∫£n l√Ω ph√¢n b√≥n -->
        <div id="fertilizer" class="tab-content">
            <div class="form-section">
                <h3>Ghi nh·∫≠n s·ª≠ d·ª•ng ph√¢n b√≥n</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ng√†y b√≥n</label>
                        <input type="date" id="fertilizer-date">
                    </div>
                    <div class="form-group">
                        <label>L√¥ ƒë·∫•t</label>
                        <select id="fertilizer-plot">
                            <option value="">Ch·ªçn l√¥ ƒë·∫•t</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Giai ƒëo·∫°n c√¢y</label>
                        <select id="tree-stage">
                            <option value="">Ch·ªçn giai ƒëo·∫°n</option>
                            <option value="growth">Sinh tr∆∞·ªüng</option>
                            <option value="flowering">Ra hoa</option>
                            <option value="fruit-set">ƒê·∫≠u tr√°i</option>
                            <option value="fruit-development">Ph√°t tri·ªÉn tr√°i</option>
                            <option value="post-harvest">Sau thu ho·∫°ch</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Lo·∫°i ph√¢n</label>
                        <input type="text" id="fertilizer-type" placeholder="VD: NPK 16-16-8">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Li·ªÅu l∆∞·ª£ng (kg/c√¢y)</label>
                        <input type="number" id="fertilizer-amount" step="0.1" placeholder="VD: 0.5">
                    </div>
                    <div class="form-group">
                        <label>Ph∆∞∆°ng ph√°p</label>
                        <select id="fertilizer-method">
                            <option value="">Ch·ªçn ph∆∞∆°ng ph√°p</option>
                            <option value="soil">B√≥n ƒë·∫•t</option>
                            <option value="foliar">Phun l√°</option>
                            <option value="hole">B√≥n l·ªó</option>
                            <option value="surface">R√£i m·∫∑t</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ng∆∞·ªùi th·ª±c hi·ªán</label>
                        <input type="text" id="fertilizer-worker" placeholder="T√™n ng∆∞·ªùi b√≥n ph√¢n">
                    </div>
                    <div class="form-group">
                        <label>Ghi ch√∫</label>
                        <input type="text" id="fertilizer-note" placeholder="Ghi ch√∫ th√™m">
                    </div>
                </div>
                <button class="btn btn-success" onclick="addFertilizerRecord()">Ghi nh·∫≠n b√≥n ph√¢n</button>
            </div>
            
            <div class="summary-card">
                <h4>üìä T√≥m t·∫Øt s·ª≠ d·ª•ng ph√¢n b√≥n</h4>
                <table class="data-table" id="fertilizer-summary">
                    <thead>
                        <tr>
                            <th>Ng√†y</th>
                            <th>L√¥ ƒë·∫•t</th>
                            <th>Giai ƒëo·∫°n</th>
                            <th>Lo·∫°i ph√¢n</th>
                            <th>Li·ªÅu l∆∞·ª£ng</th>
                            <th>Ph∆∞∆°ng ph√°p</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Tab 3: Thu·ªëc BVTV -->
        <div id="pesticide" class="tab-content">
            <div class="form-section">
                <h3>Ghi nh·∫≠n s·ª≠ d·ª•ng thu·ªëc BVTV</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ng√†y x·ª≠ l√Ω</label>
                        <input type="date" id="pesticide-date">
                    </div>
                    <div class="form-group">
                        <label>L√¥ ƒë·∫•t</label>
                        <select id="pesticide-plot">
                            <option value="">Ch·ªçn l√¥ ƒë·∫•t</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ƒê·ªëi t∆∞·ª£ng h·∫°i</label>
                        <select id="pest-target">
                            <option value="">Ch·ªçn ƒë·ªëi t∆∞·ª£ng</option>
                            <option value="stem-borer">S√¢u ƒë·ª•c th√¢n</option>
                            <option value="fruit-borer">S√¢u ƒë·ª•c tr√°i</option>
                            <option value="root-rot">B·ªánh th·ªëi g·ªëc</option>
                            <option value="leaf-blight">B·ªánh ch√°y l√°</option>
                            <option value="fruit-fly">Ru·ªìi tr√°i c√¢y</option>
                            <option value="other">Kh√°c</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>M·ª©c ƒë·ªô thi·ªát h·∫°i</label>
                        <select id="damage-level">
                            <option value="">Ch·ªçn m·ª©c ƒë·ªô</option>
                            <option value="1">R·∫•t nh·∫π (<5%)</option>
                            <option value="2">Nh·∫π (5-15%)</option>
                            <option value="3">Trung b√¨nh (15-30%)</option>
                            <option value="4">N·∫∑ng (30-50%)</option>
                            <option value="5">R·∫•t n·∫∑ng (>50%)</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>T√™n thu·ªëc</label>
                        <input type="text" id="pesticide-name" placeholder="T√™n th∆∞∆°ng m·∫°i">
                    </div>
                    <div class="form-group">
                        <label>Ho·∫°t ch·∫•t</label>
                        <input type="text" id="active-ingredient" placeholder="T√™n ho·∫°t ch·∫•t">
                    </div>
                    <div class="form-group">
                        <label>N·ªìng ƒë·ªô (%)</label>
                        <input type="number" id="concentration" step="0.01" placeholder="VD: 0.2">
                    </div>
                    <div class="form-group">
                        <label>Th·ªùi gian c√°ch ly (ng√†y)</label>
                        <input type="number" id="isolation-period" placeholder="VD: 14">
                    </div>
                </div>
                <button class="btn btn-warning" onclick="addPesticideRecord()">Ghi nh·∫≠n x·ª≠ l√Ω</button>
            </div>
        </div>
        
        <!-- Tab 4: ChƒÉm s√≥c -->
        <div id="care" class="tab-content">
            <div class="form-section">
                <h3>Ho·∫°t ƒë·ªông chƒÉm s√≥c h√†ng ng√†y</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ng√†y th·ª±c hi·ªán</label>
                        <input type="date" id="care-date">
                    </div>
                    <div class="form-group">
                        <label>L√¥ ƒë·∫•t</label>
                        <select id="care-plot">
                            <option value="">Ch·ªçn l√¥ ƒë·∫•t</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ho·∫°t ƒë·ªông</label>
                        <select id="care-activity">
                            <option value="">Ch·ªçn ho·∫°t ƒë·ªông</option>
                            <option value="watering">T∆∞·ªõi n∆∞·ªõc</option>
                            <option value="weeding">L√†m c·ªè</option>
                            <option value="pruning">T·ªâa c√†nh</option>
                            <option value="flower-induction">K√≠ch th√≠ch ra hoa</option>
                            <option value="pollination">Th·ª• ph√¢n nh√¢n t·∫°o</option>
                            <option value="fruit-thinning">T·ªâa tr√°i non</option>
                            <option value="fruit-bagging">B·ªçc tr√°i</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ng∆∞·ªùi th·ª±c hi·ªán</label>
                        <input type="text" id="care-worker" placeholder="T√™n ng∆∞·ªùi th·ª±c hi·ªán">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ph∆∞∆°ng ph√°p</label>
                        <textarea id="care-method" rows="3" placeholder="M√¥ t·∫£ ph∆∞∆°ng ph√°p th·ª±c hi·ªán"></textarea>
                    </div>
                    <div class="form-group">
                        <label>K·∫øt qu·∫£</label>
                        <textarea id="care-result" rows="3" placeholder="K·∫øt qu·∫£ ƒë·∫°t ƒë∆∞·ª£c"></textarea>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="addCareRecord()">Ghi nh·∫≠n ho·∫°t ƒë·ªông</button>
            </div>
        </div>
        
        <!-- Tab 5: Thu ho·∫°ch -->
        <div id="harvest" class="tab-content">
            <div class="form-section">
                <h3>Ghi nh·∫≠n thu ho·∫°ch</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ng√†y thu ho·∫°ch</label>
                        <input type="date" id="harvest-date">
                    </div>
                    <div class="form-group">
                        <label>L√¥ ƒë·∫•t</label>
                        <select id="harvest-plot">
                            <option value="">Ch·ªçn l√¥ ƒë·∫•t</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>S·ªë c√¢y thu ho·∫°ch</label>
                        <input type="number" id="trees-harvested" placeholder="S·ªë c√¢y">
                    </div>
                    <div class="form-group">
                        <label>T·ªïng s·ªë tr√°i</label>
                        <input type="number" id="total-fruits" placeholder="S·ªë tr√°i">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Tr·ªçng l∆∞·ª£ng trung b√¨nh (kg/tr√°i)</label>
                        <input type="number" id="avg-weight" step="0.1" placeholder="VD: 2.5">
                    </div>
                    <div class="form-group">
                        <label>Ph√¢n lo·∫°i ch·∫•t l∆∞·ª£ng</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="number" id="grade1" placeholder="0" style="width: 60px;">
                                <label>Lo·∫°i 1 (‚â•2kg)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="number" id="grade2" placeholder="0" style="width: 60px;">
                                <label>Lo·∫°i 2 (1-2kg)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="number" id="grade3" placeholder="0" style="width: 60px;">
                                <label>Lo·∫°i 3 (<1kg)</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ng∆∞·ªùi thu ho·∫°ch</label>
                        <input type="text" id="harvest-worker" placeholder="T√™n ng∆∞·ªùi thu ho·∫°ch">
                    </div>
                    <div class="form-group">
                        <label>ƒêi·ªÅu ki·ªán th·ªùi ti·∫øt</label>
                        <select id="weather">
                            <option value="">Ch·ªçn th·ªùi ti·∫øt</option>
                            <option value="sunny">N·∫Øng</option>
                            <option value="cloudy">√Çm u</option>
                            <option value="rainy">M∆∞a</option>
                            <option value="windy">Gi√≥</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-success" onclick="addHarvestRecord()">Ghi nh·∫≠n thu ho·∫°ch</button>
            </div>
            
            <div class="summary-card">
                <h4>üìà Th·ªëng k√™ thu ho·∫°ch</h4>
                <div id="harvest-stats">
                    <p><strong>T·ªïng s·∫£n l∆∞·ª£ng:</strong> <span id="total-yield">0</span> kg</p>
                    <p><strong>NƒÉng su·∫•t trung b√¨nh:</strong> <span id="avg-yield">0</span> kg/c√¢y</p>
                    <p><strong>T·ª∑ l·ªá lo·∫°i 1:</strong> <span id="grade1-percent">0</span>%</p>
                </div>
            </div>
        </div>
        
        <!-- Tab 6: Xu·∫•t b√°o c√°o -->
        <div id="export" class="tab-content">
            <div class="alert alert-info">
                <strong>üí° H∆∞·ªõng d·∫´n:</strong> Ch·ªçn lo·∫°i b√°o c√°o mu·ªën xu·∫•t. D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c t·ªïng h·ª£p t·ª´ c√°c form ƒë√£ nh·∫≠p.
            </div>
            
            <div class="export-section">
                <h3>üìÑ Xu·∫•t b√°o c√°o GAP</h3>
                <p>T·∫°o c√°c b√°o c√°o ti√™u chu·∫©n t·ª´ d·ªØ li·ªáu ƒë√£ nh·∫≠p</p>
                
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin: 20px 0;">
                    <button class="btn btn-primary" onclick="exportReport('complete')">
                        üìã Nh·∫≠t k√Ω ƒë·∫ßy ƒë·ªß
                    </button>
                    <button class="btn btn-success" onclick="exportReport('fertilizer')">
                        üå± B√°o c√°o ph√¢n b√≥n
                    </button>
                    <button class="btn btn-warning" onclick="exportReport('pesticide')">
                        üõ°Ô∏è B√°o c√°o thu·ªëc BVTV
                    </button>
                    <button class="btn btn-primary" onclick="exportReport('harvest')">
                        ü•≠ B√°o c√°o thu ho·∫°ch
                    </button>
                </div>
                
                <div class="form-row" style="max-width: 600px; margin: 20px auto;">
                    <div class="form-group">
                        <label>T·ª´ ng√†y</label>
                        <input type="date" id="export-from">
                    </div>
                    <div class="form-group">
                        <label>ƒê·∫øn ng√†y</label>
                        <input type="date" id="export-to">
                    </div>
                </div>
                
                <p style="color: #6c757d; font-style: italic; margin-top: 20px;">
                    B√°o c√°o s·∫Ω ƒë∆∞·ª£c xu·∫•t d∆∞·ªõi d·∫°ng PDF ho·∫∑c Excel ph√π h·ª£p v·ªõi y√™u c·∫ßu GAP
                </p>
            </div>
        </div>
    </div>

    <script>
        // D·ªØ li·ªáu l∆∞u tr·ªØ (trong th·ª±c t·∫ø s·∫Ω k·∫øt n·ªëi v·ªõi database)
        let farmData = {
            plots: [],
            fertilizers: [],
            pesticides: [],
            careActivities: [],
            harvests: []
        };

        // Chuy·ªÉn ƒë·ªïi tab
        function showTab(tabId) {
            // ·∫®n t·∫•t c·∫£ tab content
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // B·ªè active t·ª´ t·∫•t c·∫£ nav-tab
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Hi·ªÉn th·ªã tab ƒë∆∞·ª£c ch·ªçn
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        // Th√™m l√¥ ƒë·∫•t
        function addPlot() {
            const plot = {
                code: document.getElementById('plot-code').value,
                area: document.getElementById('area').value,
                variety: document.getElementById('durian-variety').value,
                age: document.getElementById('tree-age').value
            };
            
            if (plot.code && plot.area) {
                farmData.plots.push(plot);
                updatePlotSelectors();
                clearPlotForm();
                alert('ƒê√£ th√™m l√¥ ƒë·∫•t th√†nh c√¥ng!');
            } else {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin l√¥ ƒë·∫•t!');
            }
        }

        // C·∫≠p nh·∫≠t dropdown l√¥ ƒë·∫•t
        function updatePlotSelectors() {
            const selectors = ['fertilizer-plot', 'pesticide-plot', 'care-plot', 'harvest-plot'];
            selectors.forEach(selectorId => {
                const selector = document.getElementById(selectorId);
                selector.innerHTML = '<option value="">Ch·ªçn l√¥ ƒë·∫•t</option>';
                farmData.plots.forEach(plot => {
                    selector.innerHTML += `<option value="${plot.code}">${plot.code} (${plot.area}ha - ${plot.variety})</option>`;
                });
            });
        }

        // X√≥a form l√¥ ƒë·∫•t
        function clearPlotForm() {
            document.getElementById('plot-code').value = '';
            document.getElementById('area').value = '';
            document.getElementById('durian-variety').value = '';
            document.getElementById('tree-age').value = '';
        }

        // Th√™m b·∫£n ghi ph√¢n b√≥n
        function addFertilizerRecord() {
            const record = {
                date: document.getElementById('fertilizer-date').value,
                plot: document.getElementById('fertilizer-plot').value,
                stage: document.getElementById('tree-stage').value,
                type: document.getElementById('fertilizer-type').value,
                amount: document.getElementById('fertilizer-amount').value,
                method: document.getElementById('fertilizer-method').value,
                worker: document.getElementById('fertilizer-worker').value,
                note: document.getElementById('fertilizer-note').value
            };

            if (record.date && record.plot && record.type && record.amount) {
                farmData.fertilizers.push(record);
                updateFertilizerTable();
                clearFertilizerForm();
                alert('ƒê√£ ghi nh·∫≠n b√≥n ph√¢n th√†nh c√¥ng!');
            } else {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc!');
            }
        }

        // C·∫≠p nh·∫≠t b·∫£ng ph√¢n b√≥n
        function updateFertilizerTable() {
            const tbody = document.querySelector('#fertilizer-summary tbody');
            tbody.innerHTML = '';
            
            farmData.fertilizers.forEach(record => {
                const stageNames = {
                    'growth': 'Sinh tr∆∞·ªüng',
                    'flowering': 'Ra hoa',
                    'fruit-set': 'ƒê·∫≠u tr√°i',
                    'fruit-development': 'Ph√°t tri·ªÉn tr√°i',
                    'post-harvest': 'Sau thu ho·∫°ch'
                };
                
                const methodNames = {
                    'soil': 'B√≥n ƒë·∫•t',
                    'foliar': 'Phun l√°',
                    'hole': 'B√≥n l·ªó',
                    'surface': 'R√£i m·∫∑t'
                };

                tbody.innerHTML += `
                    <tr>
                        <td>${record.date}</td>
                        <td>${record.plot}</td>
                        <td>${stageNames[record.stage] || record.stage}</td>
                        <td>${record.type}</td>
                        <td>${record.amount} kg/c√¢y</td>
                        <td>${methodNames[record.method] || record.method}</td>
                    </tr>
                `;
            });
        }

        // X√≥a form ph√¢n b√≥n
        function clearFertilizerForm() {
            document.getElementById('fertilizer-date').value = '';
            document.getElementById('fertilizer-plot').value = '';
            document.getElementById('tree-stage').value = '';
            document.getElementById('fertilizer-type').value = '';
            document.getElementById('fertilizer-amount').value = '';
            document.getElementById('fertilizer-method').value = '';
            document.getElementById('fertilizer-worker').value = '';
            document.getElementById('fertilizer-note').value = '';
        }

        // Th√™m b·∫£n ghi thu·ªëc BVTV
        function addPesticideRecord() {
            const record = {
                date: document.getElementById('pesticide-date').value,
                plot: document.getElementById('pesticide-plot').value,
                target: document.getElementById('pest-target').value,
                damageLevel: document.getElementById('damage-level').value,
                name: document.getElementById('pesticide-name').value,
                activeIngredient: document.getElementById('active-ingredient').value,
                concentration: document.getElementById('concentration').value,
                isolationPeriod: document.getElementById('isolation-period').value
            };

            if (record.date && record.plot && record.target && record.name) {
                farmData.pesticides.push(record);
                alert('ƒê√£ ghi nh·∫≠n s·ª≠ d·ª•ng thu·ªëc BVTV th√†nh c√¥ng!');
            } else {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc!');
            }
        }

        // Th√™m ho·∫°t ƒë·ªông chƒÉm s√≥c
        function addCareRecord() {
            const record = {
                date: document.getElementById('care-date').value,
                plot: document.getElementById('care-plot').value,
                activity: document.getElementById('care-activity').value,
                worker: document.getElementById('care-worker').value,
                method: document.getElementById('care-method').value,
                result: document.getElementById('care-result').value
            };

            if (record.date && record.plot && record.activity) {
                farmData.careActivities.push(record);
                alert('ƒê√£ ghi nh·∫≠n ho·∫°t ƒë·ªông chƒÉm s√≥c th√†nh c√¥ng!');
            } else {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc!');
            }
        }

        // Th√™m b·∫£n ghi thu ho·∫°ch
        function addHarvestRecord() {
            const record = {
                date: document.getElementById('harvest-date').value,
                plot: document.getElementById('harvest-plot').value,
                treesHarvested: parseInt(document.getElementById('trees-harvested').value) || 0,
                totalFruits: parseInt(document.getElementById('total-fruits').value) || 0,
                avgWeight: parseFloat(document.getElementById('avg-weight').value) || 0,
                grade1: parseInt(document.getElementById('grade1').value) || 0,
                grade2: parseInt(document.getElementById('grade2').value) || 0,
                grade3: parseInt(document.getElementById('grade3').value) || 0,
                worker: document.getElementById('harvest-worker').value,
                weather: document.getElementById('weather').value
            };

            if (record.date && record.plot && record.treesHarvested && record.totalFruits) {
                farmData.harvests.push(record);
                updateHarvestStats();
                alert('ƒê√£ ghi nh·∫≠n thu ho·∫°ch th√†nh c√¥ng!');
            } else {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc!');
            }
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™ thu ho·∫°ch
        function updateHarvestStats() {
            const totalYield = farmData.harvests.reduce((sum, record) => 
                sum + (record.totalFruits * record.avgWeight), 0);
            
            const totalTrees = farmData.harvests.reduce((sum, record) => 
                sum + record.treesHarvested, 0);
            
            const avgYieldPerTree = totalTrees > 0 ? (totalYield / totalTrees).toFixed(1) : 0;
            
            const totalGrade1 = farmData.harvests.reduce((sum, record) => sum + record.grade1, 0);
            const totalFruits = farmData.harvests.reduce((sum, record) => sum + record.totalFruits, 0);
            const grade1Percent = totalFruits > 0 ? ((totalGrade1 / totalFruits) * 100).toFixed(1) : 0;

            document.getElementById('total-yield').textContent = totalYield.toFixed(1);
            document.getElementById('avg-yield').textContent = avgYieldPerTree;
            document.getElementById('grade1-percent').textContent = grade1Percent;
        }

        // Xu·∫•t b√°o c√°o
        function exportReport(type) {
            const fromDate = document.getElementById('export-from').value;
            const toDate = document.getElementById('export-to').value;
            
            if (!fromDate || !toDate) {
                alert('Vui l√≤ng ch·ªçn kho·∫£ng th·ªùi gian b√°o c√°o!');
                return;
            }

            // Trong th·ª±c t·∫ø, ƒë√¢y s·∫Ω l√† API call ƒë·ªÉ t·∫°o v√† t·∫£i b√°o c√°o
            let reportData = {};
            
            switch(type) {
                case 'complete':
                    reportData = {
                        plots: farmData.plots,
                        fertilizers: farmData.fertilizers.filter(record => 
                            record.date >= fromDate && record.date <= toDate),
                        pesticides: farmData.pesticides.filter(record => 
                            record.date >= fromDate && record.date <= toDate),
                        careActivities: farmData.careActivities.filter(record => 
                            record.date >= fromDate && record.date <= toDate),
                        harvests: farmData.harvests.filter(record => 
                            record.date >= fromDate && record.date <= toDate)
                    };
                    break;
                case 'fertilizer':
                    reportData = farmData.fertilizers.filter(record => 
                        record.date >= fromDate && record.date <= toDate);
                    break;
                case 'pesticide':
                    reportData = farmData.pesticides.filter(record => 
                        record.date >= fromDate && record.date <= toDate);
                    break;
                case 'harvest':
                    reportData = farmData.harvests.filter(record => 
                        record.date >= fromDate && record.date <= toDate);
                    break;
            }

            // M√¥ ph·ªèng vi·ªác t·∫°o b√°o c√°o
            console.log('Xu·∫•t b√°o c√°o:', type, reportData);
            
            // Trong th·ª±c t·∫ø, b·∫°n s·∫Ω g·ªçi API ƒë·ªÉ t·∫°o file PDF/Excel
            alert(`ƒêang t·∫°o b√°o c√°o ${type} t·ª´ ${fromDate} ƒë·∫øn ${toDate}...\n\nTrong ·ª©ng d·ª•ng th·ª±c t·∫ø, file s·∫Ω ƒë∆∞·ª£c t·ª± ƒë·ªông t·∫£i v·ªÅ.`);
        }

        // Kh·ªüi t·∫°o ng√†y hi·ªán t·∫°i cho c√°c form
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('export-from').value = new Date(new Date().setMonth(new Date().getMonth() - 1)).toISOString().split('T')[0];
            document.getElementById('export-to').value = today;
        });
    </script>
</body>
</html>