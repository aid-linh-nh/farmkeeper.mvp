<!DOCTYPE html>
<html lang="vi" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Lý Thư Viện KPI</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        /* Simple toggle switch styles */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #22C55E; /* green-500 */
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #22C55E; /* green-500 */
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 font-sans p-6 lg:p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="flex flex-col md:flex-row justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold text-white">Quản Lý Thư Viện KPI</h1>
                <p class="text-gray-400 mt-1">Xây dựng và duy trì kho chỉ số đo lường hiệu suất trung tâm của công ty.</p>
            </div>
            <button id="add-kpi-btn" class="mt-4 md:mt-0 w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md flex items-center justify-center">
                <i data-lucide="plus" class="w-5 h-5 mr-2"></i> Thêm KPI mới
            </button>
        </div>

        <!-- Add/Edit KPI Form (Initially hidden) -->
        <div id="kpi-form-container" class="hidden mb-8 bg-gray-800 p-8 rounded-xl border border-gray-700">
            <h2 id="form-title" class="text-2xl font-bold text-white mb-6">Thêm KPI Mới</h2>
            <form id="kpi-form">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Column 1 -->
                    <div>
                        <div>
                            <label for="kpi_name" class="block text-sm font-medium text-gray-300 mb-2">Tên KPI</label>
                            <input type="text" id="kpi_name" placeholder="VD: Doanh số Vật tư" class="w-full bg-gray-900 border-gray-600 text-white rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div class="mt-6">
                            <label for="kpi_id" class="block text-sm font-medium text-gray-300 mb-2">Mã KPI (System ID)</label>
                            <input type="text" id="kpi_id" placeholder="VD: kpi_sales (không dấu, không khoảng trắng)" class="w-full bg-gray-900 border-gray-600 text-white rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div class="mt-6">
                            <label for="kpi_group" class="block text-sm font-medium text-gray-300 mb-2">Nhóm Chiến Lược</label>
                            <select id="kpi_group" class="w-full bg-gray-900 border-gray-600 text-white rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                                <option>I. Hiệu quả Chuỗi Giá trị</option>
                                <option>II. Tăng trưởng & Dịch vụ</option>
                                <option>III. Vận hành & Năng lực</option>
                            </select>
                        </div>
                         <div class="mt-6">
                            <label for="kpi_description" class="block text-sm font-medium text-gray-300 mb-2">Mô tả chi tiết</label>
                            <textarea id="kpi_description" rows="5" class="w-full bg-gray-900 border-gray-600 text-white rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Giải thích rõ mục đích và cách đo lường của KPI..."></textarea>
                        </div>
                    </div>
                    <!-- Column 2 -->
                    <div>
                        <div>
                            <label for="kpi_unit" class="block text-sm font-medium text-gray-300 mb-2">Đơn vị tính</label>
                            <select id="kpi_unit" class="w-full bg-gray-900 border-gray-600 text-white rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                                <option>VNĐ</option>
                                <option>%</option>
                                <option>Điểm</option>
                                <option>tấn/ha</option>
                                <option>Vườn</option>
                                <option>Giờ</option>
                            </select>
                        </div>
                        <div class="mt-6">
                            <label for="kpi_source" class="block text-sm font-medium text-gray-300 mb-2">Nguồn Dữ liệu</label>
                            <select id="kpi_source" class="w-full bg-gray-900 border-gray-600 text-white rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                                <option>Hệ thống ERP / Bán hàng</option>
                                <option>Module Quản lý Chất lượng (QC)</option>
                                <option>Module Dự báo & Quản lý Thu hoạch</option>
                                <option>Nhật ký thu hoạch</option>
                                <option>Hệ thống CRM / Hợp đồng</option>
                                <option>Module Khảo sát</option>
                                <option>Checklist đánh giá tại vườn</option>
                                <option>Nhật ký công việc & Báo cáo</option>
                                <option>Hệ thống LMS / Đào tạo</option>
                            </select>
                        </div>
                        <div class="mt-6">
                            <label for="kpi_direction" class="block text-sm font-medium text-gray-300 mb-2">Chiều hướng đo lường</label>
                            <select id="kpi_direction" class="w-full bg-gray-900 border-gray-600 text-white rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                                <option>Càng cao càng tốt</option>
                                <option>Càng thấp càng tốt</option>
                            </select>
                        </div>
                        <div class="mt-6">
                            <label class="block text-sm font-medium text-gray-300 mb-2">Trạng thái</label>
                            <div class="relative inline-block w-40 h-8 flex items-center">
                                <input type="checkbox" id="kpi_status" class="absolute w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer toggle-checkbox" checked/>
                                <label for="kpi_status" class="block w-14 h-8 overflow-hidden bg-gray-600 rounded-full cursor-pointer toggle-label"></label>
                                <span class="ml-4 text-sm font-medium text-gray-300">Đang hoạt động</span>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Action Buttons -->
                <div class="mt-8 flex justify-end space-x-4">
                    <button type="button" id="cancel-btn" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-md">Hủy</button>
                    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-md">Lưu KPI</button>
                </div>
            </form>
        </div>

        <!-- KPI List Table -->
        <div class="bg-gray-800 rounded-xl border border-gray-700 overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left text-gray-400">
                    <thead class="text-xs text-gray-300 uppercase bg-gray-700/50">
                        <tr>
                            <th scope="col" class="px-6 py-3">Mã KPI</th>
                            <th scope="col" class="px-6 py-3">Tên KPI</th>
                            <th scope="col" class="px-6 py-3">Nhóm Chiến Lược</th>
                            <th scope="col" class="px-6 py-3">Nguồn Dữ liệu</th>
                            <th scope="col" class="px-6 py-3 text-center">Trạng thái</th>
                            <th scope="col" class="px-6 py-3 text-center">Hành động</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Sample Row 1 -->
                        <tr class="bg-gray-800 border-b border-gray-700 hover:bg-gray-700/50">
                            <td class="px-6 py-4 font-mono text-xs">kpi_sales</td>
                            <td class="px-6 py-4 font-medium text-white">Doanh số Vật tư</td>
                            <td class="px-6 py-4">I. Hiệu quả Chuỗi Giá trị</td>
                            <td class="px-6 py-4">Hệ thống ERP / Bán hàng</td>
                            <td class="px-6 py-4 text-center"><span class="px-2 py-1 text-xs font-medium rounded-full bg-green-900 text-green-300">Hoạt động</span></td>
                            <td class="px-6 py-4 text-center">
                                <button class="p-2 text-gray-400 hover:text-white"><i data-lucide="edit-2" class="w-4 h-4"></i></button>
                            </td>
                        </tr>
                        <!-- Sample Row 2 -->
                        <tr class="bg-gray-800 border-b border-gray-700 hover:bg-gray-700/50">
                            <td class="px-6 py-4 font-mono text-xs">kpi_qc_score</td>
                            <td class="px-6 py-4 font-medium text-white">Chất lượng Nông sản Thu mua</td>
                            <td class="px-6 py-4">I. Hiệu quả Chuỗi Giá trị</td>
                            <td class="px-6 py-4">Module Quản lý Chất lượng (QC)</td>
                            <td class="px-6 py-4 text-center"><span class="px-2 py-1 text-xs font-medium rounded-full bg-green-900 text-green-300">Hoạt động</span></td>
                            <td class="px-6 py-4 text-center">
                                <button class="p-2 text-gray-400 hover:text-white"><i data-lucide="edit-2" class="w-4 h-4"></i></button>
                            </td>
                        </tr>
                        <!-- Sample Row 3 -->
                        <tr class="bg-gray-800 border-b border-gray-700 hover:bg-gray-700/50">
                            <td class="px-6 py-4 font-mono text-xs">kpi_farmer_adherence</td>
                            <td class="px-6 py-4 font-medium text-white">Tỷ lệ Nông dân Tuân thủ Quy trình</td>
                            <td class="px-6 py-4">III. Vận hành & Năng lực</td>
                            <td class="px-6 py-4">Checklist đánh giá tại vườn</td>
                            <td class="px-6 py-4 text-center"><span class="px-2 py-1 text-xs font-medium rounded-full bg-green-900 text-green-300">Hoạt động</span></td>
                            <td class="px-6 py-4 text-center">
                                <button class="p-2 text-gray-400 hover:text-white"><i data-lucide="edit-2" class="w-4 h-4"></i></button>
                            </td>
                        </tr>
                        <!-- Sample Row 4 -->
                        <tr class="bg-gray-800 border-b border-gray-700 hover:bg-gray-700/50">
                            <td class="px-6 py-4 font-mono text-xs">kpi_response_time</td>
                            <td class="px-6 py-4 font-medium text-white">Thời gian Phản hồi Yêu cầu</td>
                            <td class="px-6 py-4">III. Vận hành & Năng lực</td>
                            <td class="px-6 py-4">Module hỗ trợ khách hàng</td>
                            <td class="px-6 py-4 text-center"><span class="px-2 py-1 text-xs font-medium rounded-full bg-red-900 text-red-300">Không hoạt động</span></td>
                            <td class="px-6 py-4 text-center">
                                <button class="p-2 text-gray-400 hover:text-white"><i data-lucide="edit-2" class="w-4 h-4"></i></button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        const addKpiBtn = document.getElementById('add-kpi-btn');
        const kpiFormContainer = document.getElementById('kpi-form-container');
        const cancelBtn = document.getElementById('cancel-btn');
        const kpiForm = document.getElementById('kpi-form');
        const formTitle = document.getElementById('form-title');

        function showForm() {
            kpiFormContainer.classList.remove('hidden');
        }

        function hideForm() {
            kpiFormContainer.classList.add('hidden');
            kpiForm.reset();
            formTitle.textContent = "Thêm KPI Mới";
        }

        addKpiBtn.addEventListener('click', showForm);
        cancelBtn.addEventListener('click', hideForm);
        
        // Logic to handle form submission (for demonstration)
        kpiForm.addEventListener('submit', function(e) {
            e.preventDefault();
            // In a real application, you would collect form data and send to the server
            alert('Đã lưu KPI thành công!');
            hideForm();
        });

    </script>
</body>
</html>
