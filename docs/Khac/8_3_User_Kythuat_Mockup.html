<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FarmKeeper Technician - T·ªëi ∆∞u</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* Mobile-first optimized design */
        .mobile-container {
            max-width: 390px;
            margin: 0 auto;
            background: #f8fafc;
            min-height: 100vh;
            position: relative;
            border: 1px solid #e2e8f0;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        .status-bar {
            height: 24px;
            background: #000;
            color: white;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 16px;
        }
        
        .app-header {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            padding: 12px 16px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .content-area {
            flex: 1;
            padding-bottom: 80px;
            overflow-y: auto;
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 390px;
            background: white;
            border-top: 1px solid #e2e8f0;
            padding: 8px 0;
            display: flex;
            justify-content: around;
            z-index: 100;
        }
        
        .nav-item {
            flex: 1;
            text-align: center;
            padding: 8px 4px;
            color: #6b7280;
            transition: all 0.2s;
            position: relative;
            cursor: pointer;
        }
        
        .nav-item.active {
            color: #3b82f6;
        }
        
        .nav-item i {
            display: block;
            font-size: 20px;
            margin-bottom: 4px;
        }
        
        .nav-item span {
            font-size: 11px;
            font-weight: 500;
        }
        
        /* Optimized Card System */
        .unified-card {
            background: white;
            border-radius: 12px;
            margin: 8px 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid #f1f5f9;
            overflow: hidden;
        }
        
        .card-header {
            padding: 16px 16px 12px 16px;
            border-bottom: 1px solid #f1f5f9;
            background: #fafbfc;
        }
        
        .card-content {
            padding: 12px 16px;
        }
        
        .card-actions {
            padding: 8px 16px 16px 16px;
            background: #fafbfc;
            border-top: 1px solid #f1f5f9;
        }
        
        /* Status System */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-critical {
            background: #fef2f2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }
        
        .status-warning {
            background: #fffbeb;
            color: #d97706;
            border: 1px solid #fed7aa;
        }
        
        .status-success {
            background: #f0fdf4;
            color: #16a34a;
            border: 1px solid #bbf7d0;
        }
        
        .status-info {
            background: #eff6ff;
            color: #2563eb;
            border: 1px solid #dbeafe;
        }
        
        /* Metric Grid */
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin: 12px 0;
        }
        
        .metric-item {
            background: white;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            border: 1px solid #f1f5f9;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .metric-label {
            font-size: 12px;
            color: #6b7280;
        }
        
        /* Unified List Items */
        .list-item {
            padding: 12px;
            border-bottom: 1px solid #f1f5f9;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .list-item:last-child {
            border-bottom: none;
        }
        
        .list-item:active {
            background: #f8fafc;
            transform: scale(0.98);
        }
        
        .list-item-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .list-item-title {
            font-weight: 600;
            color: #1f2937;
            flex: 1;
        }
        
        .list-item-meta {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 8px;
        }
        
        .list-item-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        /* Action Buttons */
        .action-btn {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .action-btn:active {
            transform: scale(0.95);
        }
        
        .btn-primary {
            background: #3b82f6;
            color: white;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-warning {
            background: #f59e0b;
            color: white;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        /* Quick Access Floating Button */
        .fab {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: #3b82f6;
            color: white;
            border: none;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
            z-index: 90;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .fab:active {
            transform: scale(0.95);
        }
        
        /* Tab Content */
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Filter Tabs */
        .filter-tabs {
            display: flex;
            overflow-x: auto;
            gap: 8px;
            padding: 0 16px 16px 16px;
            margin-top: 16px;
        }
        
        .filter-tab {
            flex-shrink: 0;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            border: 1px solid #e2e8f0;
            background: white;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }
        
        .filter-tab.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        /* Alert Badge */
        .alert-badge {
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: -6px;
            right: -6px;
            animation: pulse 2s infinite;
        }
        
        /* Priority Indicators */
        .priority-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .priority-critical {
            background: #ef4444;
            animation: pulse 2s infinite;
        }
        
        .priority-high {
            background: #f59e0b;
        }
        
        .priority-medium {
            background: #3b82f6;
        }
        
        .priority-low {
            background: #10b981;
        }
        
        /* Progress Bars */
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #f1f5f9;
            border-radius: 3px;
            overflow: hidden;
            margin: 8px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            transition: width 0.3s ease;
        }
        
        /* Enhanced Animations */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes slideInUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .slide-in {
            animation: slideInUp 0.3s ease-out;
        }
        
        /* Data Grid for metrics */
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 8px;
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
            margin: 8px 0;
        }
        
        .data-item {
            text-align: center;
        }
        
        .data-value {
            font-size: 16px;
            font-weight: bold;
            color: #1f2937;
        }
        
        .data-label {
            font-size: 10px;
            color: #6b7280;
            margin-top: 2px;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="mobile-container">
        <!-- Status Bar -->
        <div class="status-bar">
            <span>09:41</span>
            <span>üì∂ üì∂ üì∂ üíæ üîã</span>
        </div>
        
        <!-- App Header -->
        <div class="app-header">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-white bg-opacity-20 rounded-lg flex items-center justify-center">
                        <i class="fas fa-user-tie text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold">KS. Ph·∫°m VƒÉn Minh</h1>
                        <p class="text-sm opacity-90">ID: KTV001 ‚Ä¢ Rank: #1 ‚Ä¢ 98% hi·ªáu su·∫•t</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="flex items-center space-x-1">
                        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                        <span class="text-xs opacity-80">Sync</span>
                    </div>
                    <div class="relative">
                        <button class="bg-white bg-opacity-20 p-2 rounded-lg" onclick="openNotifications()">
                            <i class="fas fa-bell text-white"></i>
                        </button>
                        <div class="alert-badge">7</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filter Tabs -->
        <div class="filter-tabs">
            <button class="filter-tab active" onclick="filterContent('all')">T·∫•t c·∫£</button>
            <button class="filter-tab" onclick="filterContent('urgent')">Kh·∫©n c·∫•p</button>
            <button class="filter-tab" onclick="filterContent('today')">H√¥m nay</button>
            <button class="filter-tab" onclick="filterContent('farms')">V∆∞·ªùn</button>
            <button class="filter-tab" onclick="filterContent('tasks')">C√¥ng vi·ªác</button>
            <button class="filter-tab" onclick="filterContent('reports')">B√°o c√°o</button>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-content active">
                <!-- Critical Alerts - T√≠ch h·ª£p t·∫•t c·∫£ c·∫£nh b√°o quan tr·ªçng -->
                <div class="unified-card slide-in">
                    <div class="card-header">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold text-red-800 flex items-center">
                                <i class="fas fa-exclamation-triangle text-red-600 mr-2"></i>
                                C·∫£nh b√°o kh·∫©n c·∫•p
                            </h3>
                            <span class="status-critical">7 v·∫•n ƒë·ªÅ</span>
                        </div>
                    </div>
                    <div class="card-content">
                        <div class="space-y-3">
                            <div class="list-item">
                                <div class="list-item-header">
                                    <div class="flex items-center">
                                        <div class="priority-dot priority-critical"></div>
                                        <span class="list-item-title text-red-800">S√¢u ph·ªß qu·∫£</span>
                                    </div>
                                    <span class="status-critical">4 v∆∞·ªùn</span>
                                </div>
                                <div class="list-item-meta">
                                    V∆∞·ªùn Anh Hi·ªÅn, Ch√∫ D≈©ng, B√°c T√¢m, C√¥ Lan
                                </div>
                                <div class="list-item-actions">
                                    <button class="action-btn btn-danger" onclick="handleMassEmergency('pest')">
                                        üö® X·ª≠ l√Ω h√†ng lo·∫°t
                                    </button>
                                    <button class="action-btn btn-primary" onclick="createGroupChat('pest')">
                                        üí¨ Chat nh√≥m
                                    </button>
                                </div>
                            </div>
                            
                            <div class="list-item">
                                <div class="list-item-header">
                                    <div class="flex items-center">
                                        <div class="priority-dot priority-high"></div>
                                        <span class="list-item-title text-yellow-800">Thi·∫øu ph√¢n NPK</span>
                                    </div>
                                    <span class="status-warning">3 v∆∞·ªùn</span>
                                </div>
                                <div class="list-item-meta">
                                    C·∫ßn ƒë·∫∑t h√†ng kh·∫©n c·∫•p trong h√¥m nay
                                </div>
                                <div class="list-item-actions">
                                    <button class="action-btn btn-warning" onclick="orderFertilizer()">
                                        üì¶ ƒê·∫∑t h√†ng ngay
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Dashboard - T√≠ch h·ª£p metrics v√† AI -->
                <div class="unified-card">
                    <div class="card-header">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-chart-pie text-blue-600 mr-2"></i>
                            Dashboard hi·ªáu su·∫•t
                        </h3>
                    </div>
                    <div class="card-content">
                        <div class="metric-grid">
                            <div class="metric-item">
                                <div class="metric-value text-blue-700">23</div>
                                <div class="metric-label">V∆∞·ªùn qu·∫£n l√Ω</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value text-green-700">18</div>
                                <div class="metric-label">Ho√†n th√†nh h√¥m nay</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value text-orange-700">5</div>
                                <div class="metric-label">ƒêang th·ª±c hi·ªán</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value text-purple-700">94%</div>
                                <div class="metric-label">Hi·ªáu su·∫•t tu·∫ßn</div>
                            </div>
                        </div>
                        
                        <!-- AI Assistant Integration -->
                        <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-3 border border-blue-200 mt-4">
                            <div class="flex items-center space-x-2 mb-2">
                                <i class="fas fa-robot text-blue-600"></i>
                                <span class="font-bold text-blue-800">AI Assistant</span>
                                <span class="status-info">Beta</span>
                            </div>
                            <p class="text-sm text-blue-700 mb-2">"H√¥m nay n√™n ∆∞u ti√™n x·ª≠ l√Ω s√¢u ph·ªß qu·∫£ ·ªü v∆∞·ªùn Anh Hi·ªÅn tr∆∞·ªõc khi m∆∞a"</p>
                            <div class="flex space-x-2">
                                <button class="action-btn btn-primary" onclick="followAIAdvice()">
                                    ‚úì √Åp d·ª•ng
                                </button>
                                <button class="action-btn btn-secondary" onclick="askAI()">
                                    üí¨ H·ªèi th√™m
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Today's Unified Workload - T√≠ch h·ª£p l·ªãch v√† c√¥ng vi·ªác -->
                <div class="unified-card">
                    <div class="card-header">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold text-gray-800 flex items-center">
                                <i class="fas fa-calendar-check text-green-600 mr-2"></i>
                                C√¥ng vi·ªác h√¥m nay
                            </h3>
                            <div class="flex items-center space-x-2">
                                <span class="status-info">8 vi·ªác</span>
                                <button class="action-btn btn-success" onclick="optimizeRoute()">
                                    üó∫Ô∏è T·ªëi ∆∞u l·ªô tr√¨nh
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-content">
                        <!-- Route Optimization -->
                        <div class="bg-green-50 rounded-lg p-3 border border-green-200 mb-4">
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-bold text-green-800">L·ªô tr√¨nh t·ªëi ∆∞u</span>
                                <span class="text-sm text-green-700">Ti·∫øt ki·ªám 45 ph√∫t</span>
                            </div>
                            <div class="data-grid">
                                <div class="data-item">
                                    <div class="data-value text-green-700">4h15m</div>
                                    <div class="data-label">Th·ªùi gian</div>
                                </div>
                                <div class="data-item">
                                    <div class="data-value text-green-700">67.3km</div>
                                    <div class="data-label">Qu√£ng ƒë∆∞·ªùng</div>
                                </div>
                                <div class="data-item">
                                    <div class="data-value text-green-700">8</div>
                                    <div class="data-label">ƒêi·ªÉm ƒë·∫øn</div>
                                </div>
                            </div>
                            <button class="action-btn btn-success w-full mt-2" onclick="startOptimizedRoute()">
                                üöó B·∫Øt ƒë·∫ßu d·∫´n ƒë∆∞·ªùng
                            </button>
                        </div>

                        <!-- Today's Tasks -->
                        <div class="space-y-2">
                            <div class="list-item bg-green-50 border border-green-200 rounded-lg">
                                <div class="list-item-header">
                                    <span class="list-item-title text-green-800">8:00 - V∆∞·ªùn Anh Hi·ªÅn</span>
                                    <span class="status-success">H√¥m nay</span>
                                </div>
                                <div class="list-item-meta">
                                    Ki·ªÉm tra s√¢u ph·ªß qu·∫£ ‚Ä¢ C√∫ M'Gar, DL
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 0%"></div>
                                </div>
                                <div class="list-item-actions">
                                    <button class="action-btn btn-success" onclick="startTask('task-1')">
                                        üöó B·∫Øt ƒë·∫ßu
                                    </button>
                                    <button class="action-btn btn-primary" onclick="callFarmer('farm-1')">
                                        üìû G·ªçi
                                    </button>
                                    <button class="action-btn btn-secondary" onclick="viewDetails('task-1')">
                                        ‚ÑπÔ∏è Chi ti·∫øt
                                    </button>
                                </div>
                            </div>
                            
                            <div class="list-item">
                                <div class="list-item-header">
                                    <span class="list-item-title text-blue-800">14:00 - V∆∞·ªùn B√°c T√¢m</span>
                                    <span class="status-info">S·∫Øp t·ªõi</span>
                                </div>
                                <div class="list-item-meta">
                                    H∆∞·ªõng d·∫´n b√≥n ph√¢n ‚Ä¢ Tr·∫£ng Bom, DN
                                </div>
                                <div class="list-item-actions">
                                    <button class="action-btn btn-primary" onclick="setReminder('task-2')">
                                        ‚è∞ Nh·∫Øc nh·ªü
                                    </button>
                                    <button class="action-btn btn-secondary" onclick="prepareVisit('task-2')">
                                        üìã Chu·∫©n b·ªã
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Farms & Reports Tab - T√≠ch h·ª£p qu·∫£n l√Ω v∆∞·ªùn v√† b√°o c√°o -->
            <div id="farms-tab" class="tab-content">
                <!-- Farm Status Overview -->
                <div class="unified-card">
                    <div class="card-header">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold text-gray-800 flex items-center">
                                <i class="fas fa-map-marked-alt text-green-600 mr-2"></i>
                                T·ªïng quan v∆∞·ªùn & b√°o c√°o
                            </h3>
                            <div class="flex items-center space-x-2">
                                <button class="action-btn btn-primary" onclick="sendProgressReport()">
                                    üìä B√°o c√°o ti·∫øn ƒë·ªô
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-content">
                        <!-- Progress Summary -->
                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-3 border border-blue-200 mb-4">
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-bold text-blue-800">Ti·∫øn ƒë·ªô h√¥m nay</span>
                                <span class="status-success">18/23 ho√†n th√†nh</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 78%"></div>
                            </div>
                            <div class="data-grid mt-2">
                                <div class="data-item">
                                    <div class="data-value text-green-700">18</div>
                                    <div class="data-label">Ho√†n th√†nh</div>
                                </div>
                                <div class="data-item">
                                    <div class="data-value text-yellow-700">3</div>
                                    <div class="data-label">ƒêang l√†m</div>
                                </div>
                                <div class="data-item">
                                    <div class="data-value text-red-700">2</div>
                                    <div class="data-label">Tr·ªÖ h·∫πn</div>
                                </div>
                                <div class="data-item">
                                    <div class="data-value text-purple-700">94%</div>
                                    <div class="data-label">Hi·ªáu su·∫•t</div>
                                </div>
                            </div>
                        </div>

                        <!-- Manager Communication -->
                        <div class="bg-indigo-50 rounded-lg p-3 border border-indigo-200">
                            <div class="flex items-center space-x-2 mb-2">
                                <img src="https://via.placeholder.com/32x32/6366F1/FFFFFF?text=KS" alt="Manager" class="w-8 h-8 rounded-full">
                                <div class="flex-1">
                                    <span class="font-semibold text-indigo-800">KS. Nguy·ªÖn VƒÉn Sang</span>
                                    <span class="text-xs text-indigo-600 ml-2">15 ph√∫t tr∆∞·ªõc</span>
                                </div>
                            </div>
                            <p class="text-sm text-indigo-700 mb-2">"Anh Minh l√†m t·ªët l·∫Øm! V∆∞·ªùn Anh Hi·ªÅn ƒë√£ x·ª≠ l√Ω s√¢u ph·ªß qu·∫£ hi·ªáu qu·∫£."</p>
                            <div class="flex space-x-2">
                                <button class="action-btn btn-primary" onclick="thankManager()">
                                    üôè C·∫£m ∆°n
                                </button>
                                <button class="action-btn btn-secondary" onclick="shareAdditionalInfo()">
                                    ‚ÑπÔ∏è Th√™m th√¥ng tin
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Integrated Farm List -->
                <div class="unified-card">
                    <div class="card-header">
                        <h3 class="font-bold text-gray-800 flex items-center">
                            <i class="fas fa-seedling text-green-600 mr-2"></i>
                            Danh s√°ch v∆∞·ªùn (23 v∆∞·ªùn)
                        </h3>
                    </div>
                    <div class="card-content space-y-3">
                        <!-- Critical Farm -->
                        <div class="list-item bg-red-50 border border-red-200 rounded-lg">
                            <div class="list-item-header">
                                <div class="flex items-center">
                                    <div class="priority-dot priority-critical"></div>
                                    <span class="list-item-title text-red-800">V∆∞·ªùn Anh Hi·ªÅn</span>
                                </div>
                                <span class="status-critical">Kh·∫©n c·∫•p</span>
                            </div>
                            <div class="list-item-meta">
                                12.5ha ‚Ä¢ 156 c√¢y ‚Ä¢ C√∫ M'Gar, DL<br>
                                <strong>S√¢u ph·ªß qu·∫£ - 35 c√¢y b·ªã ·∫£nh h∆∞·ªüng</strong>
                            </div>
                            <div class="data-grid">
                                <div class="data-item">
                                    <div class="data-value text-orange-600">34¬∞C</div>
                                    <div class="data-label">Nhi·ªát ƒë·ªô</div>
                                </div>
                                <div class="data-item">
                                    <div class="data-value text-blue-600">72%</div>
                                    <div class="data-label">ƒê·ªô ·∫©m</div>
                                </div>
                                <div class="data-item">
                                    <div class="data-value text-green-600">6.2</div>
                                    <div class="data-label">pH ƒë·∫•t</div>
                                </div>
                            </div>
                            <div class="list-item-actions">
                                <button class="action-btn btn-danger" onclick="handleFarmEmergency('farm-1')">
                                    üö® X·ª≠ l√Ω ngay
                                </button>
                                <button class="action-btn btn-primary" onclick="openAICamera('farm-1')">
                                    üì∏ AI Scan
                                </button>
                                <button class="action-btn btn-success" onclick="startNavigation('farm-1')">
                                    üß≠ D·∫´n ƒë∆∞·ªùng
                                </button>
                            </div>
                        </div>

                        <!-- Warning Farm -->
                        <div class="list-item bg-yellow-50 border border-yellow-200 rounded-lg">
                            <div class="list-item-header">
                                <div class="flex items-center">
                                    <div class="priority-dot priority-high"></div>
                                    <span class="list-item-title text-yellow-800">V∆∞·ªùn B√°c T√¢m</span>
                                </div>
                                <span class="status-warning">Theo d√µi</span>
                            </div>
                            <div class="list-item-meta">
                                8.2ha ‚Ä¢ 98 c√¢y ‚Ä¢ Tr·∫£ng Bom, DN<br>
                                <strong>Thi·∫øu ph√¢n NPK - C·∫ßn ƒë·∫∑t h√†ng</strong>
                            </div>
                            <div class="list-item-actions">
                                <button class="action-btn btn-warning" onclick="scheduleFertilizer('farm-2')">
                                    üì¶ ƒê·∫∑t ph√¢n
                                </button>
                                <button class="action-btn btn-primary" onclick="callFarmer('farm-2')">
                                    üìû G·ªçi
                                </button>
                                <button class="action-btn btn-secondary" onclick="chatFarmer('farm-2')">
                                    üí¨ Chat
                                </button>
                            </div>
                        </div>

                        <!-- Normal Farm -->
                        <div class="list-item">
                            <div class="list-item-header">
                                <div class="flex items-center">
                                    <div class="priority-dot priority-low"></div>
                                    <span class="list-item-title text-green-800">V∆∞·ªùn Ch√∫ D≈©ng</span>
                                </div>
                                <span class="status-success">T·ªët</span>
                            </div>
                            <div class="list-item-meta">
                                15.8ha ‚Ä¢ 201 c√¢y ‚Ä¢ Xu√¢n L·ªôc, DN<br>
                                <strong>Ti·∫øn ƒë·ªô b√≥n ph√¢n: 78% ho√†n th√†nh</strong>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 78%"></div>
                            </div>
                            <div class="list-item-actions">
                                <button class="action-btn btn-success" onclick="viewProgress('farm-3')">
                                    üìä Xem ti·∫øn ƒë·ªô
                                </button>
                                <button class="action-btn btn-primary" onclick="callFarmer('farm-3')">
                                    üìû G·ªçi
                                </button>
                                <button class="action-btn btn-secondary" onclick="scheduleVisit('farm-3')">
                                    üìÖ H·∫πn thƒÉm
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="action-btn btn-secondary w-full" onclick="loadMoreFarms()">
                            <i class="fas fa-chevron-down mr-2"></i>Xem th√™m 20 v∆∞·ªùn
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tools & Knowledge Tab - T√≠ch h·ª£p c√¥ng c·ª• v√† ki·∫øn th·ª©c -->
            <div id="tools-tab" class="tab-content">
                <!-- AI Tools Section -->
                <div class="unified-card">
                    <div class="card-header">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-robot text-blue-600 mr-2"></i>
                            C√¥ng c·ª• AI & Ph√¢n t√≠ch
                        </h3>
                    </div>
                    <div class="card-content">
                        <div class="grid grid-cols-2 gap-3">
                            <div class="list-item bg-blue-50 border border-blue-200 rounded-lg" onclick="openPestIdentifier()">
                                <div class="text-center">
                                    <i class="fas fa-search text-blue-600 text-2xl mb-2"></i>
                                    <div class="font-bold text-blue-800 text-sm">AI Nh·∫≠n di·ªán</div>
                                    <div class="text-xs text-blue-700">S√¢u b·ªánh</div>
                                </div>
                            </div>
                            
                            <div class="list-item bg-green-50 border border-green-200 rounded-lg" onclick="openDosageCalculator()">
                                <div class="text-center">
                                    <i class="fas fa-calculator text-green-600 text-2xl mb-2"></i>
                                    <div class="font-bold text-green-800 text-sm">T√≠nh li·ªÅu l∆∞·ª£ng</div>
                                    <div class="text-xs text-green-700">Thu·ªëc & ph√¢n</div>
                                </div>
                            </div>
                            
                            <div class="list-item bg-purple-50 border border-purple-200 rounded-lg" onclick="openPlantHealthScanner()">
                                <div class="text-center">
                                    <i class="fas fa-heartbeat text-purple-600 text-2xl mb-2"></i>
                                    <div class="font-bold text-purple-800 text-sm">S·ª©c kh·ªèe c√¢y</div>
                                    <div class="text-xs text-purple-700">Qu√©t AI</div>
                                </div>
                            </div>
                            
                            <div class="list-item bg-yellow-50 border border-yellow-200 rounded-lg" onclick="openWeatherAnalyzer()">
                                <div class="text-center">
                                    <i class="fas fa-cloud-sun text-yellow-600 text-2xl mb-2"></i>
                                    <div class="font-bold text-yellow-800 text-sm">Th·ªùi ti·∫øt</div>
                                    <div class="text-xs text-yellow-700">D·ª± b√°o & t∆∞ v·∫•n</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Tools & References -->
                <div class="unified-card">
                    <div class="card-header">
                        <h3 class="font-bold text-gray-800 flex items-center">
                            <i class="fas fa-tools text-orange-600 mr-2"></i>
                            C√¥ng c·ª• nhanh & T√†i li·ªáu
                        </h3>
                    </div>
                    <div class="card-content">
                        <div class="grid grid-cols-3 gap-2 mb-4">
                            <div class="list-item text-center" onclick="openVoiceRecorder()">
                                <i class="fas fa-microphone text-red-600 text-lg mb-1"></i>
                                <div class="text-xs font-medium">Ghi √¢m</div>
                            </div>
                            
                            <div class="list-item text-center" onclick="openQRScanner()">
                                <i class="fas fa-qrcode text-indigo-600 text-lg mb-1"></i>
                                <div class="text-xs font-medium">Qu√©t QR</div>
                            </div>
                            
                            <div class="list-item text-center" onclick="openMeasurementTool()">
                                <i class="fas fa-ruler text-green-600 text-lg mb-1"></i>
                                <div class="text-xs font-medium">ƒêo l∆∞·ªùng</div>
                            </div>
                            
                            <div class="list-item text-center" onclick="openColorAnalyzer()">
                                <i class="fas fa-palette text-purple-600 text-lg mb-1"></i>
                                <div class="text-xs font-medium">M√†u l√°</div>
                            </div>
                            
                            <div class="list-item text-center" onclick="openOfflineSync()">
                                <i class="fas fa-sync text-blue-600 text-lg mb-1"></i>
                                <div class="text-xs font-medium">Sync</div>
                            </div>
                            
                            <div class="list-item text-center" onclick="openEmergencyHelp()">
                                <i class="fas fa-exclamation-triangle text-red-600 text-lg mb-1"></i>
                                <div class="text-xs font-medium">SOS</div>
                            </div>
                        </div>

                        <!-- Knowledge Base - T√≠ch h·ª£p t√†i li·ªáu -->
                        <div class="space-y-2">
                            <h4 class="font-semibold text-gray-800">üìö T√†i li·ªáu tham kh·∫£o</h4>
                            
                            <div class="list-item bg-red-50 border border-red-200 rounded" onclick="openKnowledgeItem('pest-guide')">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-bug text-red-600"></i>
                                    <div class="flex-1">
                                        <div class="font-medium text-red-800">C·∫©m nang S√¢u b·ªánh</div>
                                        <div class="text-xs text-gray-600">150+ lo·∫°i ‚Ä¢ 23 n√¥ng d√¢n ƒë√£ d√πng ‚Ä¢ ‚≠ê 4.8</div>
                                    </div>
                                    <span class="status-critical">Hot</span>
                                </div>
                            </div>
                            
                            <div class="list-item bg-green-50 border border-green-200 rounded" onclick="openKnowledgeItem('fertilizer-guide')">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-seedling text-green-600"></i>
                                    <div class="flex-1">
                                        <div class="font-medium text-green-800">H∆∞·ªõng d·∫´n Ph√¢n b√≥n</div>
                                        <div class="text-xs text-gray-600">Theo giai ƒëo·∫°n ‚Ä¢ 45 n√¥ng d√¢n ‚Ä¢ ‚≠ê 4.9</div>
                                    </div>
                                    <span class="status-success">New</span>
                                </div>
                            </div>
                            
                            <div class="list-item bg-blue-50 border border-blue-200 rounded" onclick="openKnowledgeItem('vietgap-standards')">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-certificate text-blue-600"></i>
                                    <div class="flex-1">
                                        <div class="font-medium text-blue-800">Ti√™u chu·∫©n VietGAP</div>
                                        <div class="text-xs text-gray-600">Ch√≠nh th·ª©c ‚Ä¢ 12 n√¥ng d√¢n ‚Ä¢ ‚≠ê 4.7</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="action-btn btn-secondary w-full" onclick="viewAllKnowledge()">
                            üìñ Xem t·∫•t c·∫£ t√†i li·ªáu
                        </button>
                    </div>
                </div>

                <!-- Production Process Builder -->
                <div class="unified-card">
                    <div class="card-header">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold text-gray-800 flex items-center">
                                <i class="fas fa-project-diagram text-indigo-600 mr-2"></i>
                                Quy tr√¨nh s·∫£n xu·∫•t
                            </h3>
                            <button class="action-btn btn-primary" onclick="createNewProcess()">
                                <i class="fas fa-plus mr-1"></i>T·∫°o m·ªõi
                            </button>
                        </div>
                    </div>
                    <div class="card-content">
                        <!-- Process Templates -->
                        <div class="grid grid-cols-2 gap-3 mb-4">
                            <div class="list-item bg-green-50 border border-green-200 rounded-lg" onclick="useTemplate('durian-standard')">
                                <div class="text-center">
                                    <i class="fas fa-seedling text-green-600 text-xl mb-2"></i>
                                    <div class="font-bold text-green-800 text-sm">S·∫ßu ri√™ng VietGAP</div>
                                    <div class="text-xs text-green-700">Quy tr√¨nh chu·∫©n 18 th√°ng</div>
                                </div>
                            </div>
                            
                            <div class="list-item bg-orange-50 border border-orange-200 rounded-lg" onclick="useTemplate('durian-organic')">
                                <div class="text-center">
                                    <i class="fas fa-leaf text-orange-600 text-xl mb-2"></i>
                                    <div class="font-bold text-orange-800 text-sm">S·∫ßu ri√™ng H·ªØu c∆°</div>
                                    <div class="text-xs text-orange-700">Theo ti√™u chu·∫©n JAS</div>
                                </div>
                            </div>
                            
                            <div class="list-item bg-blue-50 border border-blue-200 rounded-lg" onclick="useTemplate('durian-intensive')">
                                <div class="text-center">
                                    <i class="fas fa-tachometer-alt text-blue-600 text-xl mb-2"></i>
                                    <div class="font-bold text-blue-800 text-sm">Th√¢m canh cao</div>
                                    <div class="text-xs text-blue-700">NƒÉng su·∫•t t·ªëi ƒëa</div>
                                </div>
                            </div>
                            
                            <div class="list-item bg-purple-50 border border-purple-200 rounded-lg" onclick="createCustomProcess()">
                                <div class="text-center">
                                    <i class="fas fa-edit text-purple-600 text-xl mb-2"></i>
                                    <div class="font-bold text-purple-800 text-sm">T√πy ch·ªânh</div>
                                    <div class="text-xs text-purple-700">T·∫°o quy tr√¨nh ri√™ng</div>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Processes -->
                        <div class="space-y-2">
                            <h4 class="font-semibold text-gray-800">üìã Quy tr√¨nh g·∫ßn ƒë√¢y</h4>
                            
                            <div class="list-item bg-white border border-gray-200 rounded" onclick="editProcess('process-1')">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-file-alt text-indigo-600"></i>
                                        <div>
                                            <div class="font-medium text-gray-800">S·∫ßu ri√™ng Monthong - V∆∞·ªùn Anh Hi·ªÅn</div>
                                            <div class="text-xs text-gray-600">18 giai ƒëo·∫°n ‚Ä¢ C·∫≠p nh·∫≠t: 2 ng√†y tr∆∞·ªõc</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="status-success">Ho√†n th√†nh</span>
                                        <button class="action-btn btn-secondary" onclick="shareProcess('process-1')" title="Chia s·∫ª">
                                            <i class="fas fa-share-alt"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="list-item bg-white border border-gray-200 rounded" onclick="editProcess('process-2')">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-file-alt text-yellow-600"></i>
                                        <div>
                                            <div class="font-medium text-gray-800">Ri6 H·ªØu c∆° - V∆∞·ªùn B√°c T√¢m</div>
                                            <div class="text-xs text-gray-600">12 giai ƒëo·∫°n ‚Ä¢ ƒêang so·∫°n th·∫£o</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="status-warning">Nh√°p</span>
                                        <button class="action-btn btn-secondary" onclick="duplicateProcess('process-2')" title="Nh√¢n b·∫£n">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-actions">
                        <div class="flex space-x-2">
                            <button class="action-btn btn-secondary flex-1" onclick="viewProcessLibrary()">
                                üìö Th∆∞ vi·ªán quy tr√¨nh
                            </button>
                            <button class="action-btn btn-primary flex-1" onclick="openProcessBuilder()">
                                üõ†Ô∏è C√¥ng c·ª• so·∫°n th·∫£o
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Equipment Status -->
                <div class="unified-card">
                    <div class="card-header">
                        <h3 class="font-bold text-gray-800 flex items-center">
                            <i class="fas fa-cogs text-gray-600 mr-2"></i>
                            T√¨nh tr·∫°ng thi·∫øt b·ªã
                        </h3>
                    </div>
                    <div class="card-content">
                        <div class="space-y-2">
                            <div class="list-item">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-spray-can text-gray-600"></i>
                                        <div>
                                            <div class="font-medium text-gray-800">B√¨nh x·ªãt thu·ªëc</div>
                                            <div class="text-xs text-gray-600">B·∫£o d∆∞·ª°ng: 5 ng√†y tr∆∞·ªõc</div>
                                        </div>
                                    </div>
                                    <span class="status-success">T·ªët</span>
                                </div>
                            </div>
                            
                            <div class="list-item">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-thermometer-half text-gray-600"></i>
                                        <div>
                                            <div class="font-medium text-gray-800">Nhi·ªát k·∫ø & pH meter</div>
                                            <div class="text-xs text-gray-600">C·∫ßn hi·ªáu ch·ªânh</div>
                                        </div>
                                    </div>
                                    <span class="status-warning">C·∫ßn ki·ªÉm tra</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Access Floating Button -->
        <button class="fab" onclick="toggleQuickActions()">
            <i class="fas fa-plus"></i>
        </button>

        <!-- Optimized Bottom Navigation -->
        <div class="bottom-nav">
            <div class="nav-item active" onclick="showTab('dashboard')">
                <i class="fas fa-tachometer-alt"></i>
                <span>T·ªïng quan</span>
            </div>
            <div class="nav-item" onclick="showTab('farms')">
                <i class="fas fa-chart-line"></i>
                <span>V∆∞·ªùn & BC</span>
                <div class="alert-badge">5</div>
            </div>
            <div class="nav-item" onclick="showTab('tools')">
                <i class="fas fa-toolbox"></i>
                <span>C√¥ng c·ª•</span>
            </div>
        </div>
    </div>

    <script>
        // Optimized JavaScript with unified functions
        
        // Tab navigation
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const selectedTab = document.getElementById(tabName + '-tab');
            if (selectedTab) {
                selectedTab.classList.add('active');
                selectedTab.classList.add('slide-in');
            }
            
            event.currentTarget.classList.add('active');
            
            loadTabData(tabName);
        }

        // Filter content across all tabs
        function filterContent(filter) {
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // Filter logic based on current tab and filter type
            showNotification(`L·ªçc n·ªôi dung: ${filter}`, 'info');
        }

        // Unified data loading
        function loadTabData(tabName) {
            switch(tabName) {
                case 'dashboard':
                    updateDashboardMetrics();
                    break;
                case 'farms':
                    loadFarmsAndReports();
                    break;
                case 'tools':
                    loadToolsAndKnowledge();
                    break;
            }
        }

        // Dashboard functions
        function updateDashboardMetrics() {
            // Update metrics with real data
            const metrics = {
                farms: 23,
                completed: Math.floor(Math.random() * 5) + 16,
                inProgress: Math.floor(Math.random() * 3) + 3,
                efficiency: Math.floor(Math.random() * 5) + 92
            };
            
            // Update progress bars
            document.querySelectorAll('.progress-fill').forEach(bar => {
                const progress = Math.floor(Math.random() * 40) + 60;
                bar.style.width = progress + '%';
            });
        }

        function loadFarmsAndReports() {
            showNotification('ƒêang t·∫£i d·ªØ li·ªáu v∆∞·ªùn v√† b√°o c√°o...', 'info');
        }

        function loadToolsAndKnowledge() {
            showNotification('ƒêang t·∫£i c√¥ng c·ª• v√† t√†i li·ªáu...', 'info');
        }

        // Emergency and urgent actions
        function handleMassEmergency(type) {
            showNotification(`Kh·ªüi ƒë·ªông x·ª≠ l√Ω ${type} h√†ng lo·∫°t`, 'warning');
        }

        function handleFarmEmergency(farmId) {
            showNotification(`X·ª≠ l√Ω kh·∫©n c·∫•p t·∫°i ${farmId}`, 'warning');
        }

        function startEmergencyCall() {
            showNotification('K·∫øt n·ªëi kh·∫©n c·∫•p...', 'warning');
        }

        // Route and navigation
        function optimizeRoute() {
            showNotification('T·ªëi ∆∞u h√≥a l·ªô tr√¨nh...', 'info');
            setTimeout(() => {
                showNotification('ƒê√£ t·ªëi ∆∞u! Ti·∫øt ki·ªám ƒë∆∞·ª£c 45 ph√∫t', 'success');
            }, 2000);
        }

        function startOptimizedRoute() {
            showNotification('B·∫Øt ƒë·∫ßu d·∫´n ƒë∆∞·ªùng theo l·ªô tr√¨nh t·ªëi ∆∞u...', 'info');
        }

        function startNavigation(farmId) {
            showNotification(`D·∫´n ƒë∆∞·ªùng ƒë·∫øn ${farmId}...`, 'info');
        }

        // Task management
        function startTask(taskId) {
            showNotification(`B·∫Øt ƒë·∫ßu c√¥ng vi·ªác ${taskId}...`, 'info');
            // Update progress bar
            const progressBar = event.target.closest('.list-item').querySelector('.progress-fill');
            if (progressBar) {
                progressBar.style.width = '20%';
            }
        }

        // Communication
        function callFarmer(farmId) {
            showNotification(`G·ªçi ƒëi·ªán cho n√¥ng d√¢n ${farmId}...`, 'info');
        }

        function chatFarmer(farmId) {
            showNotification(`M·ªü chat v·ªõi ${farmId}...`, 'info');
        }

        function sendProgressReport() {
            showNotification('ƒêang g·ª≠i b√°o c√°o ti·∫øn ƒë·ªô...', 'info');
            setTimeout(() => {
                showNotification('B√°o c√°o ƒë√£ g·ª≠i th√†nh c√¥ng!', 'success');
            }, 2000);
        }

        function thankManager() {
            showNotification('ƒê√£ g·ª≠i l·ªùi c·∫£m ∆°n', 'success');
        }

        function shareAdditionalInfo() {
            showNotification('Chia s·∫ª th√¥ng tin b·ªï sung...', 'info');
        }

        // AI Tools
        function openPestIdentifier() {
            showNotification('M·ªü c√¥ng c·ª• nh·∫≠n di·ªán s√¢u b·ªánh AI...', 'info');
        }

        function openDosageCalculator() {
            showNotification('M·ªü m√°y t√≠nh li·ªÅu l∆∞·ª£ng...', 'info');
        }

        function openPlantHealthScanner() {
            showNotification('M·ªü c√¥ng c·ª• ƒë√°nh gi√° s·ª©c kh·ªèe c√¢y...', 'info');
        }

        function openWeatherAnalyzer() {
            showNotification('M·ªü ph√¢n t√≠ch th·ªùi ti·∫øt...', 'info');
        }

        function openAICamera(farmId) {
            showNotification('M·ªü AI Camera...', 'info');
        }

        // Quick tools
        function openVoiceRecorder() {
            showNotification('B·∫Øt ƒë·∫ßu ghi √¢m...', 'info');
        }

        function openQRScanner() {
            showNotification('M·ªü qu√©t QR code...', 'info');
        }

        function openMeasurementTool() {
            showNotification('M·ªü c√¥ng c·ª• ƒëo l∆∞·ªùng...', 'info');
        }

        function openColorAnalyzer() {
            showNotification('M·ªü ph√¢n t√≠ch m√†u l√°...', 'info');
        }

        function openOfflineSync() {
            showNotification('ƒê·ªìng b·ªô d·ªØ li·ªáu offline...', 'info');
        }

        function openEmergencyHelp() {
            showNotification('K√≠ch ho·∫°t h·ªó tr·ª£ kh·∫©n c·∫•p...', 'warning');
        }

        // Knowledge base
        function openKnowledgeItem(itemId) {
            showNotification(`M·ªü t√†i li·ªáu: ${itemId}`, 'info');
        }

        function viewAllKnowledge() {
            showNotification('M·ªü kho t√†i li·ªáu ƒë·∫ßy ƒë·ªß...', 'info');
        }

        // Production Process Builder Functions
        function createNewProcess() {
            showNotification('M·ªü tr√¨nh so·∫°n th·∫£o quy tr√¨nh m·ªõi...', 'info');
            openProcessBuilder();
        }

        function useTemplate(templateId) {
            const templates = {
                'durian-standard': 'S·∫ßu ri√™ng VietGAP',
                'durian-organic': 'S·∫ßu ri√™ng H·ªØu c∆°', 
                'durian-intensive': 'S·∫ßu ri√™ng Th√¢m canh cao',
            };
            
            showNotification(`S·ª≠ d·ª•ng template: ${templates[templateId]}`, 'info');
            setTimeout(() => {
                openProcessBuilder(templateId);
            }, 1000);
        }

        function createCustomProcess() {
            showNotification('T·∫°o quy tr√¨nh t√πy ch·ªânh...', 'info');
            openProcessBuilder('custom');
        }

        function editProcess(processId) {
            showNotification(`Ch·ªânh s·ª≠a quy tr√¨nh: ${processId}`, 'info');
            openProcessBuilder(null, processId);
        }

        function shareProcess(processId) {
            event.stopPropagation();
            showNotification(`Chia s·∫ª quy tr√¨nh: ${processId}`, 'info');
            // Generate shareable link or export options
            setTimeout(() => {
                showNotification('ƒê√£ sao ch√©p link chia s·∫ª!', 'success');
            }, 1500);
        }

        function duplicateProcess(processId) {
            event.stopPropagation();
            showNotification(`Nh√¢n b·∫£n quy tr√¨nh: ${processId}`, 'info');
            setTimeout(() => {
                showNotification('ƒê√£ t·∫°o b·∫£n sao th√†nh c√¥ng!', 'success');
            }, 1500);
        }

        function viewProcessLibrary() {
            showNotification('M·ªü th∆∞ vi·ªán quy tr√¨nh...', 'info');
            // Open process library with search and filter capabilities
        }

        function openProcessBuilder(templateId = null, processId = null) {
            // Create process builder modal/screen
            const builderModal = createProcessBuilderModal(templateId, processId);
            document.body.appendChild(builderModal);
            
            if (templateId) {
                showNotification(`ƒêang t·∫£i template ${templateId}...`, 'info');
            } else if (processId) {
                showNotification(`ƒêang t·∫£i quy tr√¨nh ${processId}...`, 'info');
            } else {
                showNotification('M·ªü tr√¨nh so·∫°n th·∫£o quy tr√¨nh...', 'info');
            }
        }

        function createProcessBuilderModal(templateId, processId) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
            modal.onclick = function(e) {
                if (e.target === modal) closeProcessBuilder();
            };
            
            modal.innerHTML = `
                <div class="bg-white rounded-lg w-full max-w-md max-h-full overflow-y-auto">
                    <div class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white p-4 rounded-t-lg">
                        <div class="flex items-center justify-between">
                            <h2 class="text-lg font-bold flex items-center">
                                <i class="fas fa-project-diagram mr-2"></i>
                                So·∫°n th·∫£o quy tr√¨nh
                            </h2>
                            <button onclick="closeProcessBuilder()" class="text-white hover:text-gray-200">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="p-4 space-y-4">
                        <!-- Process Info -->
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">T√™n quy tr√¨nh</label>
                                <input type="text" class="w-full p-2 border border-gray-300 rounded-lg" 
                                       placeholder="VD: S·∫ßu ri√™ng Monthong - V∆∞·ªùn ABC" value="${processId ? 'S·∫ßu ri√™ng Monthong - V∆∞·ªùn Anh Hi·ªÅn' : ''}">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Lo·∫°i c√¢y tr·ªìng</label>
                                <select class="w-full p-2 border border-gray-300 rounded-lg">
                                    <option>S·∫ßu ri√™ng</option>
                                    <option>Xo√†i</option>
                                    <option>Nh√£n</option>
                                    <option>Ch√¥m ch√¥m</option>
                                    <option>Kh√°c...</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Ti√™u chu·∫©n √°p d·ª•ng</label>
                                <select class="w-full p-2 border border-gray-300 rounded-lg">
                                    <option>VietGAP</option>
                                    <option>GlobalGAP</option>
                                    <option>H·ªØu c∆° JAS</option>
                                    <option>H·ªØu c∆° USDA</option>
                                    <option>T·ª± do</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Process Phases -->
                        <div class="border-t pt-4">
                            <div class="flex items-center justify-between mb-3">
                                <h3 class="font-bold text-gray-800">C√°c giai ƒëo·∫°n</h3>
                                <button onclick="addPhase()" class="action-btn btn-primary">
                                    <i class="fas fa-plus mr-1"></i>Th√™m giai ƒëo·∫°n
                                </button>
                            </div>
                            
                            <div id="phasesList" class="space-y-2">
                                ${generateSamplePhases(templateId)}
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="border-t pt-4 flex space-x-2">
                            <button onclick="saveProcess()" class="action-btn btn-success flex-1">
                                <i class="fas fa-save mr-1"></i>L∆∞u quy tr√¨nh
                            </button>
                            <button onclick="previewProcess()" class="action-btn btn-primary flex-1">
                                <i class="fas fa-eye mr-1"></i>Xem tr∆∞·ªõc
                            </button>
                        </div>
                        
                        <div class="flex space-x-2">
                            <button onclick="exportProcess()" class="action-btn btn-secondary flex-1">
                                <i class="fas fa-download mr-1"></i>Xu·∫•t PDF
                            </button>
                            <button onclick="shareProcessBuilder()" class="action-btn btn-secondary flex-1">
                                <i class="fas fa-share-alt mr-1"></i>Chia s·∫ª
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            return modal;
        }

        function generateSamplePhases(templateId) {
            const phases = {
                'durian-standard': [
                    { name: 'Chu·∫©n b·ªã ƒë·∫•t', duration: '2 tu·∫ßn', description: 'X·ªõi ƒë·∫•t, b√≥n ph√¢n h·ªØu c∆°' },
                    { name: 'Tr·ªìng c√¢y', duration: '1 tu·∫ßn', description: 'ƒê√†o h·ªë, tr·ªìng gi·ªëng' },
                    { name: 'ChƒÉm s√≥c non', duration: '6 th√°ng', description: 'T∆∞·ªõi n∆∞·ªõc, b√≥n ph√¢n ƒë·ªãnh k·ª≥' },
                    { name: 'T·∫°o t√°n', duration: '12 th√°ng', description: 'C·∫Øt t·ªâa, ƒë·ªãnh h√¨nh t√°n' }
                ],
                'durian-organic': [
                    { name: 'Chu·∫©n b·ªã ƒë·∫•t h·ªØu c∆°', duration: '3 tu·∫ßn', description: 'X·ª≠ l√Ω ƒë·∫•t theo chu·∫©n h·ªØu c∆°' },
                    { name: 'Tr·ªìng gi·ªëng h·ªØu c∆°', duration: '1 tu·∫ßn', description: 'S·ª≠ d·ª•ng gi·ªëng ƒë∆∞·ª£c ch·ª©ng nh·∫≠n' },
                    { name: 'ChƒÉm s√≥c h·ªØu c∆°', duration: '8 th√°ng', description: 'Ch·ªâ s·ª≠ d·ª•ng ph√¢n v√† thu·ªëc h·ªØu c∆°' }
                ]
            };
            
            const defaultPhases = phases[templateId] || [
                { name: 'Giai ƒëo·∫°n 1', duration: '1 th√°ng', description: 'M√¥ t·∫£ c√¥ng vi·ªác...' }
            ];
            
            return defaultPhases.map((phase, index) => `
                <div class="phase-item border border-gray-200 rounded-lg p-3">
                    <div class="flex items-center justify-between mb-2">
                        <span class="font-medium text-gray-800">Giai ƒëo·∫°n ${index + 1}</span>
                        <button onclick="removePhase(${index})" class="text-red-600 hover:text-red-800">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                    <input type="text" placeholder="T√™n giai ƒëo·∫°n" value="${phase.name}" 
                           class="w-full p-2 border border-gray-300 rounded mb-2 text-sm">
                    <input type="text" placeholder="Th·ªùi gian" value="${phase.duration}" 
                           class="w-full p-2 border border-gray-300 rounded mb-2 text-sm">
                    <textarea placeholder="M√¥ t·∫£ c√¥ng vi·ªác..." 
                              class="w-full p-2 border border-gray-300 rounded text-sm h-16">${phase.description}</textarea>
                    
                    <div class="mt-2 flex space-x-2">
                        <button onclick="addTask(${index})" class="action-btn btn-secondary text-xs">
                            <i class="fas fa-plus mr-1"></i>Th√™m c√¥ng vi·ªác
                        </button>
                        <button onclick="addChecklist(${index})" class="action-btn btn-secondary text-xs">
                            <i class="fas fa-check mr-1"></i>Checklist
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function closeProcessBuilder() {
            const modal = document.querySelector('.fixed.inset-0');
            if (modal) {
                modal.remove();
            }
        }

        function addPhase() {
            const phasesList = document.getElementById('phasesList');
            const newPhaseIndex = phasesList.children.length;
            
            const newPhase = document.createElement('div');
            newPhase.className = 'phase-item border border-gray-200 rounded-lg p-3 slide-in';
            newPhase.innerHTML = `
                <div class="flex items-center justify-between mb-2">
                    <span class="font-medium text-gray-800">Giai ƒëo·∫°n ${newPhaseIndex + 1}</span>
                    <button onclick="removePhase(${newPhaseIndex})" class="text-red-600 hover:text-red-800">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
                <input type="text" placeholder="T√™n giai ƒëo·∫°n" 
                       class="w-full p-2 border border-gray-300 rounded mb-2 text-sm">
                <input type="text" placeholder="Th·ªùi gian (VD: 2 tu·∫ßn)" 
                       class="w-full p-2 border border-gray-300 rounded mb-2 text-sm">
                <textarea placeholder="M√¥ t·∫£ c√¥ng vi·ªác chi ti·∫øt..." 
                          class="w-full p-2 border border-gray-300 rounded text-sm h-16"></textarea>
                
                <div class="mt-2 flex space-x-2">
                    <button onclick="addTask(${newPhaseIndex})" class="action-btn btn-secondary text-xs">
                        <i class="fas fa-plus mr-1"></i>Th√™m c√¥ng vi·ªác
                    </button>
                    <button onclick="addChecklist(${newPhaseIndex})" class="action-btn btn-secondary text-xs">
                        <i class="fas fa-check mr-1"></i>Checklist
                    </button>
                </div>
            `;
            
            phasesList.appendChild(newPhase);
            showNotification('ƒê√£ th√™m giai ƒëo·∫°n m·ªõi', 'success');
        }

        function removePhase(index) {
            const phasesList = document.getElementById('phasesList');
            const phases = phasesList.children;
            
            if (phases.length > 1 && phases[index]) {
                phases[index].remove();
                showNotification('ƒê√£ x√≥a giai ƒëo·∫°n', 'info');
                
                // Renumber remaining phases
                Array.from(phases).forEach((phase, newIndex) => {
                    const title = phase.querySelector('.font-medium');
                    if (title) {
                        title.textContent = `Giai ƒëo·∫°n ${newIndex + 1}`;
                    }
                });
            } else {
                showNotification('C·∫ßn √≠t nh·∫•t 1 giai ƒëo·∫°n', 'warning');
            }
        }

        function addTask(phaseIndex) {
            showNotification(`Th√™m c√¥ng vi·ªác cho giai ƒëo·∫°n ${phaseIndex + 1}`, 'info');
            // Implementation for adding specific tasks to a phase
        }

        function addChecklist(phaseIndex) {
            showNotification(`Th√™m checklist cho giai ƒëo·∫°n ${phaseIndex + 1}`, 'info');
            // Implementation for adding checklist items to a phase
        }

        function saveProcess() {
            showNotification('ƒêang l∆∞u quy tr√¨nh...', 'info');
            setTimeout(() => {
                showNotification('Quy tr√¨nh ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!', 'success');
                closeProcessBuilder();
            }, 2000);
        }

        function previewProcess() {
            showNotification('ƒêang t·∫°o b·∫£n xem tr∆∞·ªõc...', 'info');
            // Generate preview of the process
        }

        function exportProcess() {
            showNotification('ƒêang xu·∫•t file PDF...', 'info');
            setTimeout(() => {
                showNotification('ƒê√£ xu·∫•t quy tr√¨nh th√†nh c√¥ng!', 'success');
            }, 2000);
        }

        function shareProcessBuilder() {
            showNotification('T·∫°o link chia s·∫ª...', 'info');
            setTimeout(() => {
                showNotification('ƒê√£ sao ch√©p link chia s·∫ª!', 'success');
            }, 1500);
        }

        // Farm management
        function scheduleFertilizer(farmId) {
            showNotification(`L·∫≠p ƒë∆°n ƒë·∫∑t ph√¢n cho ${farmId}`, 'info');
        }

        function viewProgress(farmId) {
            showNotification(`Xem ti·∫øn ƒë·ªô ${farmId}`, 'info');
        }

        function scheduleVisit(farmId) {
            showNotification(`L√™n l·ªãch thƒÉm ${farmId}`, 'info');
        }

        function loadMoreFarms() {
            showNotification('ƒêang t·∫£i th√™m 20 v∆∞·ªùn...', 'info');
        }

        // AI and automation
        function followAIAdvice() {
            showNotification('√Åp d·ª•ng g·ª£i √Ω t·ª´ AI...', 'success');
        }

        function askAI() {
            showNotification('M·ªü AI Assistant...', 'info');
        }

        // Utility functions
        function createGroupChat(topic) {
            showNotification(`T·∫°o nh√≥m chat v·ªÅ ${topic}`, 'info');
        }

        function orderFertilizer() {
            showNotification('ƒê·∫∑t h√†ng ph√¢n b√≥n kh·∫©n c·∫•p...', 'info');
        }

        function setReminder(taskId) {
            showNotification('ƒê√£ ƒë·∫∑t nh·∫Øc nh·ªü', 'success');
        }

        function prepareVisit(taskId) {
            showNotification('Chu·∫©n b·ªã cho chuy·∫øn thƒÉm...', 'info');
        }

        function viewDetails(taskId) {
            showNotification('Xem chi ti·∫øt c√¥ng vi·ªác...', 'info');
        }

        function toggleQuickActions() {
            showNotification('M·ªü menu h√†nh ƒë·ªông nhanh...', 'info');
        }

        function openNotifications() {
            showNotification('Hi·ªÉn th·ªã th√¥ng b√°o...', 'info');
        }

        // Enhanced notification system
        function showNotification(message, type = 'info') {
            const colors = {
                'info': 'bg-blue-500',
                'success': 'bg-green-500',
                'warning': 'bg-yellow-500',
                'error': 'bg-red-500'
            };
            
            const notification = document.createElement('div');
            notification.className = `fixed top-20 left-1/2 transform -translate-x-1/2 ${colors[type]} text-white px-4 py-2 rounded-lg text-sm z-50 shadow-lg slide-in`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Auto-refresh data
        function refreshData() {
            showNotification('L√†m m·ªõi d·ªØ li·ªáu...', 'info');
            updateDashboardMetrics();
            setTimeout(() => {
                showNotification('D·ªØ li·ªáu ƒë√£ c·∫≠p nh·∫≠t', 'success');
            }, 1500);
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('FarmKeeper Technician Optimized App initialized');
            
            // Auto-refresh every 30 seconds
            setInterval(refreshData, 30000);
            
            // Initialize with dashboard
            updateDashboardMetrics();
            
            // Add pull-to-refresh gesture
            let touchStartY = 0;
            document.addEventListener('touchstart', function(e) {
                touchStartY = e.touches[0].clientY;
            });
            
            document.addEventListener('touchend', function(e) {
                const touchEndY = e.changedTouches[0].clientY;
                const deltaY = touchStartY - touchEndY;
                
                if (deltaY < -100) {
                    refreshData();
                }
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case '1':
                            showTab('dashboard');
                            break;
                        case '2':
                            showTab('farms');
                            break;
                        case '3':
                            showTab('tools');
                            break;
                        case 'r':
                            e.preventDefault();
                            refreshData();
                            break;
                    }
                }
            });
        });
    </script>
</body>
</html>