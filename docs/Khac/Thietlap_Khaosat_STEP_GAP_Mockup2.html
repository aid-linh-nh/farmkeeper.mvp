<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FarmKeeper - Thi·∫øt l·∫≠p Th√¥ng tin V∆∞·ªùn/Farm (Multi-Step)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f1f5f9; }
        .form-input, .form-select, .form-textarea, .form-checkbox {
            border: 1px solid #cbd5e1; border-radius: 0.5rem; transition: all 0.2s ease-in-out; width: 100%; background-color: white;
        }
        .form-input, .form-select, .form-textarea { padding: 0.75rem 1rem; }
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            border-color: #2E7D32; outline: none; box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.2);
        }
        .file-input-wrapper {
            border: 2px dashed #cbd5e1; border-radius: 0.75rem; padding: 2rem; text-align: center; cursor: pointer; transition: all 0.2s ease-in-out;
            background-color: #f8fafc; display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%;
        }
        .file-input-wrapper:hover { border-color: #2E7D32; background-color: #f0fdf4; }

        /* Stepper Styles */
        .step { display: flex; align-items: center; flex: 1; }
        .step-circle {
            width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-weight: 700; transition: all 0.3s ease; border: 3px solid;
        }
        .step-label { font-weight: 600; transition: all 0.3s ease; }
        .step-connector { flex-grow: 1; height: 2px; transition: all 0.3s ease; }

        /* Inactive State */
        .step.inactive .step-circle { border-color: #e2e8f0; background-color: #f8fafc; color: #94a3b8; }
        .step.inactive .step-label { color: #64748b; }
        .step.inactive .step-connector { background-color: #e2e8f0; }

        /* Active State */
        .step.active .step-circle { border-color: #2563eb; background-color: #2563eb; color: white; }
        .step.active .step-label { color: #1e40af; }
        .step.active .step-connector { background-color: #e2e8f0; }
        
        /* Completed State */
        .step.completed .step-circle { border-color: #16a34a; background-color: #16a34a; color: white; }
        .step.completed .step-label { color: #166534; }
        .step.completed .step-connector { background-color: #16a34a; }
    </style>
</head>
<body class="min-h-screen">
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4"><div class="flex items-center justify-between py-4"><div class="flex items-center space-x-4"><h1 class="text-3xl lg:text-4xl font-bold"><span style="color: #2E7D32;">FARM</span><span style="color: #1a1a1a;">KEEPER</span></h1></div><div class="flex items-center space-x-4"><span class="font-semibold text-gray-700">Ch√†o, Anh Ba!</span><img src="https://i.pravatar.cc/150?u=a042581f4e29026704d" alt="User Avatar" class="w-10 h-10 rounded-full"></div></div></div>
    </header>

    <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pb-12 pt-8">
        <div class="bg-white p-6 md:p-8 rounded-2xl shadow-xl border border-gray-200">
            
            <div id="stepper" class="w-full mb-12">
                <div class="flex items-start">
                    <div class="step" data-step-label="Th√¥ng tin C∆° b·∫£n">
                        <div class="step-circle">1</div>
                        <div class="step-label hidden md:block ml-3">C∆° b·∫£n</div>
                    </div>
                    <div class="step-connector"></div>
                    <div class="step" data-step-label="M√¥i tr∆∞·ªùng & Th·ªï nh∆∞·ª°ng">
                        <div class="step-circle">2</div>
                        <div class="step-label hidden md:block ml-3">M√¥i tr∆∞·ªùng</div>
                    </div>
                    <div class="step-connector"></div>
                    <div class="step" data-step-label="S∆° ƒë·ªì & ƒê·ªãnh v·ªã">
                        <div class="step-circle">3</div>
                        <div class="step-label hidden md:block ml-3">S∆° ƒë·ªì</div>
                    </div>
                    <div class="step-connector"></div>
                    <div class="step" data-step-label="Ngu·ªìn l·ª±c & Con ng∆∞·ªùi">
                        <div class="step-circle">4</div>
                        <div class="step-label hidden md:block ml-3">Ngu·ªìn l·ª±c</div>
                    </div>
                    <div class="step-connector"></div>
                    <div class="step" data-step-label="Canh t√°c & Ch·ª©ng nh·∫≠n">
                        <div class="step-circle">5</div>
                        <div class="step-label hidden md:block ml-3">Canh t√°c</div>
                    </div>
                    <div class="step-connector"></div>
                     <div class="step" data-step-label="ƒê·ªëi t√°c & Ho√†n t·∫•t">
                        <div class="step-circle">6</div>
                        <div class="step-label hidden md:block ml-3">Ho√†n t·∫•t</div>
                    </div>
                </div>
                 <div id="stepper-label" class="text-center font-bold text-lg mt-4 text-gray-700"></div>
            </div>

            <form id="multiStepForm" action="#" method="POST">
                <div class="form-step space-y-12">
                    <div>
                        <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center"><div class="w-8 h-8 flex items-center justify-center bg-green-100 text-green-600 rounded-lg mr-3"><i class="fas fa-info-circle"></i></div>I. Th√¥ng tin chung & NƒÉng su·∫•t</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label for="farm-name" class="block text-sm font-medium text-gray-700 mb-1">Lo·∫°i C√¢y tr·ªìng</label><input type="text" name="farm-name" id="farm-name" class="form-input" value="S·∫ßu ri√™ng" readonly></div>
                            <div><label for="total-area" class="block text-sm font-medium text-gray-700 mb-1">T·ªïng di·ªán t√≠ch (ha)</label><input type="number" step="0.1" name="total-area" id="total-area" class="form-input" placeholder="VD: 2.5"></div>
                            <div><label for="total-trees" class="block text-sm font-medium text-gray-700 mb-1">T·ªïng s·ªë c√¢y</label><input type="number" name="total-trees" id="total-trees" class="form-input" placeholder="VD: 1500"></div>
                            <div><label for="harvest-per-year" class="block text-sm font-medium text-gray-700 mb-1">NƒÉm b·∫Øt ƒë·∫ßu thu ho·∫°ch</label><input type="number" name="harvest-per-year" id="harvest-per-year" class="form-input" placeholder="VD: 2020"></div>
                            <div><label for="last-year-yield" class="block text-sm font-medium text-gray-700 mb-1">S·∫£n l∆∞·ª£ng nƒÉm tr∆∞·ªõc (T·∫•n)</label><input type="number" step="0.1" name="last-year-yield" id="last-year-yield" class="form-input" placeholder="VD: 15.5"></div>
                            <div><label for="forecast-yield" class="block text-sm font-medium text-gray-700 mb-1">S·∫£n l∆∞·ª£ng d·ª± b√°o (T·∫•n)</label><input type="number" step="0.1" name="forecast-yield" id="forecast-yield" class="form-input bg-gray-100" placeholder="T·ª± ƒë·ªông t√≠nh" readonly></div>
                        </div>
                    </div>
                    <div class="border-t pt-12">
                        <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center"><div class="w-8 h-8 flex items-center justify-center bg-green-100 text-green-600 rounded-lg mr-3"><i class="fas fa-seedling"></i></div>II. Th√¥ng tin Gi·ªëng & C√¢y tr·ªìng</h2>
                        <div id="variety-list" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 p-4 border rounded-lg bg-slate-50 items-center">
                                <div><label class="block text-sm font-medium text-gray-700">T√™n Gi·ªëng</label><input type="text" class="form-input mt-1" value="Ri6"></div>
                                 <div><label class="block text-sm font-medium text-gray-700">Ngu·ªìn g·ªëc gi·ªëng</label><input type="text" class="form-input mt-1" placeholder="VD: Vi·ªán c√¢y ƒÉn qu·∫£ Mi·ªÅn Nam"></div>
                                <div><label class="block text-sm font-medium text-gray-700">S·ªë l∆∞·ª£ng c√¢y</label><input type="number" class="form-input mt-1" value="120"></div>
                                <div><label class="block text-sm font-medium text-gray-700">Giai ƒëo·∫°n</label><select class="form-select mt-1"><option>C√¢y non</option><option>Ph·ª•c h·ªìi</option><option selected>Kinh doanh</option></select></div>
                            </div>
                            <button type="button" class="w-full border-2 border-dashed border-gray-300 text-gray-500 rounded-lg py-2 hover:border-green-500 hover:text-green-600 transition"><i class="fas fa-plus mr-2"></i>Th√™m gi·ªëng</button>
                        </div>
                    </div>
                </div>

                <div class="form-step space-y-12">
                    <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center"><div class="w-8 h-8 flex items-center justify-center bg-green-100 text-green-600 rounded-lg mr-3"><i class="fas fa-vial"></i></div>III. Th·ªï nh∆∞·ª°ng & M√¥i tr∆∞·ªùng</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div><label for="soil-type" class="block text-sm font-medium text-gray-700 mb-1">Lo·∫°i ƒë·∫•t</label><input type="text" name="soil-type" id="soil-type" class="form-input" placeholder="VD: ƒê·∫•t ƒë·ªè bazan"></div>
                        <div><label for="water-source" class="block text-sm font-medium text-gray-700 mb-1">Ngu·ªìn n∆∞·ªõc</label><select id="water-source" class="form-select"><option>S√¥ng/su·ªëi</option><option>Gi·∫øng khoan</option><option>N∆∞·ªõc m∆∞a</option><option>H·ªì ch·ª©a</option></select></div>
                        <div><label for="land-history" class="block text-sm font-medium text-gray-700 mb-1">L·ªãch s·ª≠ s·ª≠ d·ª•ng ƒë·∫•t (2 nƒÉm tr∆∞·ªõc)</label><input type="text" id="land-history" class="form-input" placeholder="VD: Tr·ªìng c√† ph√™, ƒë√£ b·ªè tr·ªëng 1 nƒÉm"></div>
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">K·∫øt qu·∫£ ph√¢n t√≠ch m·∫´u n∆∞·ªõc</label><div class="file-input-wrapper h-auto py-2"><input type="file" class="sr-only" id="water-report-upload"><label for="water-report-upload" class="cursor-pointer"><i class="fas fa-cloud-upload-alt text-gray-400 text-2xl"></i><p class="text-sm text-gray-500 mt-1">T·∫£i file b√°o c√°o</p></label></div></div>
                    </div>
                     <div class="p-4 border rounded-lg bg-slate-50 mb-6">
                        <h3 class="font-semibold text-gray-700 mb-4">ƒê√°nh gi√° nguy c∆° √¥ nhi·ªÖm t·ª´ khu v·ª±c xung quanh</h3>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                           <label class="flex items-center"><input type="checkbox" class="form-checkbox h-4 w-4 rounded border-gray-300 text-green-600"><span class="ml-2 text-sm text-gray-600">G·∫ßn khu c√¥ng nghi·ªáp</span></label>
                           <label class="flex items-center"><input type="checkbox" class="form-checkbox h-4 w-4 rounded border-gray-300 text-green-600"><span class="ml-2 text-sm text-gray-600">G·∫ßn b√£i r√°c/n∆∞·ªõc th·∫£i</span></label>
                           <label class="flex items-center"><input type="checkbox" class="form-checkbox h-4 w-4 rounded border-gray-300 text-green-600"><span class="ml-2 text-sm text-gray-600">G·∫ßn khu chƒÉn nu√¥i</span></label>
                           <label class="flex items-center"><input type="checkbox" class="form-checkbox h-4 w-4 rounded border-gray-300 text-green-600"><span class="ml-2 text-sm text-gray-600">G·∫ßn b·ªánh vi·ªán/nghƒ©a trang</span></label>
                           <label class="flex items-center"><input type="checkbox" class="form-checkbox h-4 w-4 rounded border-gray-300 text-green-600"><span class="ml-2 text-sm text-gray-600">G·∫ßn ƒë∆∞·ªùng qu·ªëc l·ªô l·ªõn</span></label>
                           <label class="flex items-center"><input type="checkbox" class="form-checkbox h-4 w-4 rounded border-gray-300 text-green-600"><span class="ml-2 text-sm text-gray-600">Kh√¥ng c√≥ nguy c∆°</span></label>
                        </div>
                        <label for="risk-mitigation" class="block text-sm font-medium text-gray-700 mt-4 mb-1">Bi·ªán ph√°p ph√≤ng ng·ª´a/kh·∫Øc ph·ª•c (n·∫øu c√≥)</label>
                        <input type="text" id="risk-mitigation" class="form-input" placeholder="VD: Tr·ªìng h√†ng r√†o c√¢y xanh c√°ch ly, x√¢y m∆∞∆°ng tho√°t n∆∞·ªõc...">
                    </div>
                    <div class="p-4 border rounded-lg bg-slate-50 mb-6">
                        <h3 class="font-semibold text-gray-700 mb-4">üìä K·∫øt qu·∫£ Test nhanh t·∫°i v∆∞·ªùn <span class="text-sm font-normal text-gray-500">(C·∫≠p nh·∫≠t t·ª´ IoT/Test Kit)</span></h3>
                        <div id="quick-test-list" class="space-y-3">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-3 items-center">
                                <label class="hidden md:block text-sm font-medium text-gray-700 md:col-span-1">Ch·ªâ s·ªë</label>
                                <label class="hidden md:block text-sm font-medium text-gray-700">Gi√° tr·ªã</label>
                                <label class="hidden md:block text-sm font-medium text-gray-700 md:col-span-2">ƒê∆°n v·ªã</label>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-3 items-center">
                                <input type="text" class="form-input font-semibold" value="pH ƒë·∫•t">
                                <input type="number" step="0.1" class="form-input" placeholder="VD: 5.5">
                                <div class="flex items-center md:col-span-2">
                                    <input type="text" class="form-input" placeholder="ƒê∆°n v·ªã ƒëo">
                                    <button type="button" class="ml-3 text-gray-400 hover:text-red-500 flex-shrink-0 p-2"><i class="fas fa-trash-alt"></i></button>
                                </div>
                            </div>
                             <div class="grid grid-cols-1 md:grid-cols-4 gap-3 items-center">
                                <input type="text" class="form-input font-semibold" value="N (ƒê·∫°m t·ªïng s·ªë)">
                                <input type="number" step="0.01" class="form-input" placeholder="VD: 0.12">
                                <div class="flex items-center md:col-span-2">
                                    <input type="text" class="form-input" value="%" placeholder="ƒê∆°n v·ªã ƒëo">
                                    <button type="button" class="ml-3 text-gray-400 hover:text-red-500 flex-shrink-0 p-2"><i class="fas fa-trash-alt"></i></button>
                                </div>
                            </div>
                             <div class="grid grid-cols-1 md:grid-cols-4 gap-3 items-center">
                                <input type="text" class="form-input font-semibold" value="P (L√¢n h·ªØu hi·ªáu)">
                                <input type="number" step="1" class="form-input" placeholder="VD: 65">
                                <div class="flex items-center md:col-span-2">
                                    <input type="text" class="form-input" value="mg/100g" placeholder="ƒê∆°n v·ªã ƒëo">
                                    <button type="button" class="ml-3 text-gray-400 hover:text-red-500 flex-shrink-0 p-2"><i class="fas fa-trash-alt"></i></button>
                                </div>
                            </div>
                             <div class="grid grid-cols-1 md:grid-cols-4 gap-3 items-center">
                                <input type="text" class="form-input font-semibold" value="K (Kali h·ªØu hi·ªáu)">
                                <input type="number" step="1" class="form-input" placeholder="VD: 80">
                                <div class="flex items-center md:col-span-2">
                                    <input type="text" class="form-input" value="mg/100g" placeholder="ƒê∆°n v·ªã ƒëo">
                                    <button type="button" class="ml-3 text-gray-400 hover:text-red-500 flex-shrink-0 p-2"><i class="fas fa-trash-alt"></i></button>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="mt-4 w-full border-2 border-dashed border-gray-300 text-gray-500 rounded-lg py-2 hover:border-green-500 hover:text-green-600 transition"><i class="fas fa-plus mr-2"></i>Th√™m ch·ªâ s·ªë</button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                        <div><label for="soil-nutrients" class="block text-sm font-medium text-gray-700 mb-1">K·∫øt qu·∫£ ph√¢n t√≠ch ƒë·∫•t t·ª´ ph√≤ng Lab</label><textarea id="soil-nutrients" name="soil-nutrients" rows="4" class="form-textarea" placeholder="Nh·∫≠p k·∫øt qu·∫£ chi ti·∫øt ho·∫∑c di·ªÖn gi·∫£i..."></textarea></div>
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">Ho·∫∑c t·∫£i l√™n file b√°o c√°o Lab</label><div class="file-input-wrapper"><input type="file" class="sr-only" id="soil-report-upload"><label for="soil-report-upload" class="cursor-pointer"><i class="fas fa-cloud-upload-alt text-gray-400 text-3xl"></i><p class="text-sm text-gray-500 mt-2">T·∫£i file b√°o c√°o Lab</p></label></div></div>
                    </div>
                </div>

                <div class="form-step space-y-12">
                     <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center"><div class="w-8 h-8 flex items-center justify-center bg-blue-100 text-blue-600 rounded-lg mr-3"><i class="fas fa-sitemap"></i></div>IV. S∆° ƒë·ªì v∆∞·ªùn & ƒê·ªãnh v·ªã c√¢y</h2>
                    <div class="mb-8">
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">T·∫£i l√™n s∆° ƒë·ªì t·ªïng th·ªÉ c·ªßa v∆∞·ªùn</label><div class="file-input-wrapper"><input type="file" class="sr-only" id="farm-map-upload"><label for="farm-map-upload" class="cursor-pointer"><i class="fas fa-map-marked-alt text-gray-400 text-3xl"></i><p class="text-sm text-gray-500 mt-2">T·∫£i file b·∫£n ƒë·ªì (·∫£nh, PDF, KML...)</p></label></div></div>
                    </div>
                    <div class="mb-8 border-t pt-12">
                        <h3 class="font-semibold text-gray-700 mb-4 flex items-center"><i class="fas fa-layer-group text-blue-600 mr-2"></i>1. T·∫°o L√¥/Khu v·ª±c</h3>
                        <div id="plot-list" class="space-y-4">
                            <div class="p-4 border-2 border-blue-200 rounded-lg bg-blue-50" id="plot-1">
                                <div class="flex items-center justify-between mb-4">
                                    <input type="text" class="form-input font-semibold text-lg w-1/3" placeholder="S·ªë L√¥ (VD: A1)" value="L√¥ A1">
                                    <button type="button" class="text-red-500 hover:text-red-700 ml-4 flex-shrink-0" onclick="removePlot(this)"><i class="fas fa-trash-alt"></i></button>
                                </div>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    <div><label class="block text-sm font-medium text-gray-700 mb-1">Di·ªán t√≠ch (ha)</label><input type="number" step="0.1" class="form-input" placeholder="VD: 1.2" value="1.2"></div>
                                    <div><label class="block text-sm font-medium text-gray-700 mb-1">S·ªë c√¢y</label><input type="number" class="form-input" placeholder="VD: 150" value="150"></div>
                                    <div><label class="block text-sm font-medium text-gray-700 mb-1">S·ªë h√†ng <span class="text-gray-500">(t√πy ch·ªçn)</span></label><input type="number" class="form-input" placeholder="VD: 10" onchange="toggleRowManagement(this)"></div>
                                    <div class="flex items-end"><button type="button" class="w-full bg-blue-600 text-white py-2 px-3 rounded-lg text-sm hover:bg-blue-700 transition" onclick="manageRows(this)"><i class="fas fa-list mr-1"></i>Qu·∫£n l√Ω h√†ng</button></div>
                                </div>
                            </div>
                        </div>
                        <button type="button" id="add-plot-btn" class="mt-4 w-full border-2 border-dashed border-gray-300 text-gray-500 rounded-lg py-3 hover:border-blue-500 hover:text-blue-600 transition"><i class="fas fa-plus mr-2"></i>Th√™m L√¥ m·ªõi</button>
                    </div>
                    <div class="border-t pt-12">
                        <h3 class="font-semibold text-gray-700 mb-4 flex items-center"><i class="fas fa-crosshairs text-green-600 mr-2"></i>2. ƒê·ªãnh v·ªã & Nh·∫≠p li·ªáu chi ti·∫øt t·ª´ng c√¢y</h3>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="space-y-4 p-4 border-2 border-green-200 bg-green-50 rounded-xl">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Ch·ªçn L√¥/H√†ng ƒë·ªÉ ƒë·ªãnh v·ªã</label>
                                    <select id="select-location" class="form-select" onchange="updateTreeForm()"><option value="">-- Ch·ªçn v·ªã tr√≠ --</option><option value="plot-1">L√¥ A1 (To√†n b·ªô)</option></select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Ph∆∞∆°ng √°n ƒë·ªãnh v·ªã</label>
                                    <select id="positioning-method" class="form-select"><option value="manual">Ghim ƒë·ªãnh v·ªã th·ªß c√¥ng</option><option value="qr">Qu√©t m√£ QR</option><option value="rfid">Qu√©t tem RFID</option><option value="drone">Nh·∫≠p t·ª´ file Drone</option></select>
                                </div>
                                <button type="button" class="w-full bg-green-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-green-700 transition flex items-center justify-center"><i class="fas fa-crosshairs mr-2"></i>B·∫Øt ƒë·∫ßu ƒë·ªãnh v·ªã</button>
                                <div class="text-sm text-gray-600 p-3 bg-white rounded-lg border"><i class="fas fa-info-circle text-blue-500 mr-1"></i><strong>H∆∞·ªõng d·∫´n:</strong> Ch·ªçn L√¥ ho·∫∑c H√†ng c·ª• th·ªÉ, sau ƒë√≥ b·∫Øt ƒë·∫ßu ƒë·ªãnh v·ªã.</div>
                            </div>

                            <div class="bg-white p-4 rounded-lg border-2 border-gray-200">
                                <h4 class="font-semibold text-center mb-4 text-gray-800"><i class="fas fa-tree text-green-600 mr-2"></i>Th√¥ng tin c√¢y ƒëang ch·ªçn</h4>
                                <div class="space-y-3">
                                    <div><label for="tree-id" class="block text-sm font-medium text-gray-700 mb-1">M√£ c√¢y</label><input type="text" id="tree-id" class="form-input" placeholder="VD: A1-001"></div>
                                    <div><label for="tree-location-info" class="block text-sm font-medium text-gray-700 mb-1">V·ªã tr√≠</label><input type="text" id="tree-location-info" class="form-input bg-gray-100" placeholder="S·∫Ω t·ª± ƒë·ªông ƒëi·ªÅn" readonly></div>
                                    <div>
                                        <label for="tree-stage" class="block text-sm font-medium text-gray-700 mb-1">Giai ƒëo·∫°n</label>
                                        <select id="tree-stage" class="form-select" onchange="toggleTreeFields()"><option value="mature" selected>Tr∆∞·ªüng th√†nh</option><option value="non">C√¢y non</option><option value="recovery">Ph·ª•c h·ªìi</option></select>
                                    </div>
                                    <div id="tree-mature-wrapper" class="space-y-3">
                                        <div><label for="fruit-count" class="block text-sm font-medium text-gray-700 mb-1">S·ªë tr√°i (d·ª± ki·∫øn)</label><input type="number" id="fruit-count" class="form-input" placeholder="VD: 50"></div>
                                        <div><label for="fruit-age" class="block text-sm font-medium text-gray-700 mb-1">Ng√†y tu·ªïi tr√°i</label><input type="number" id="fruit-age" class="form-input" placeholder="VD: 65"></div>
                                        <div><label for="fruit-weight" class="block text-sm font-medium text-gray-700 mb-1">Tr·ªçng l∆∞·ª£ng TB (Kg/Tr√°i)</label><input type="number" step="0.1" id="fruit-weight" class="form-input" placeholder="VD: 2.5"></div>
                                    </div>
                                    <div id="tree-non-wrapper" class="hidden space-y-3">
                                        <div><label for="tree-variety" class="block text-sm font-medium text-gray-700 mb-1">Gi·ªëng c√¢y</label><select id="tree-variety" class="form-select"><option>Ri6</option><option>Monthong</option></select></div>
                                        <div><label for="tree-age" class="block text-sm font-medium text-gray-700 mb-1">Tu·ªïi c√¢y (nƒÉm)</label><input type="number" id="tree-age" class="form-input" placeholder="VD: 2"></div>
                                    </div>
                                    <div id="tree-recovery-wrapper" class="hidden space-y-3">
                                        <div><label for="tree-condition" class="block text-sm font-medium text-gray-700 mb-1">T√¨nh tr·∫°ng</label><textarea id="tree-condition" rows="2" class="form-textarea" placeholder="M√¥ t·∫£ t√¨nh tr·∫°ng c√¢y..."></textarea></div>
                                        <div><label class="block text-sm font-medium text-gray-700 mb-1">Ch·ª•p ·∫£nh</label><button type="button" class="w-full text-sm py-2 border rounded-lg hover:bg-gray-100"><i class="fas fa-camera mr-2"></i>Ch·ª•p ·∫£nh c√¢y</button></div>
                                        <div><label for="tree-diagnosis" class="block text-sm font-medium text-gray-700 mb-1">Ch·∫©n ƒëo√°n</label><input type="text" id="tree-diagnosis" class="form-input" placeholder="VD: N·∫•m, thi·∫øu dinh d∆∞·ª°ng..."></div>
                                        <div><label for="tree-treatment" class="block text-sm font-medium text-gray-700 mb-1">Ph∆∞∆°ng √°n x·ª≠ l√Ω</label><input type="text" id="tree-treatment" class="form-input" placeholder="VD: B√≥n NPK, phun thu·ªëc X..."></div>
                                    </div>
                                    <div class="flex space-x-2 pt-3">
                                        <button type="button" class="flex-1 bg-blue-600 text-white py-2 px-3 rounded text-sm hover:bg-blue-700 transition"><i class="fas fa-save mr-1"></i>L∆∞u & Ti·∫øp</button>
                                        <button type="button" class="flex-1 bg-gray-500 text-white py-2 px-3 rounded text-sm hover:bg-gray-600 transition"><i class="fas fa-undo mr-1"></i>B·ªè qua</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-step space-y-12">
                     <div>
                        <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center"><div class="w-8 h-8 flex items-center justify-center bg-purple-100 text-purple-600 rounded-lg mr-3"><i class="fas fa-warehouse"></i></div>V. C∆° s·ªü v·∫≠t ch·∫•t & Trang thi·∫øt b·ªã</h2>
                        <div class="space-y-6">
                            <div class="p-4 border rounded-lg bg-slate-50">
                                <h3 class="font-semibold text-gray-700 mb-4">Khu v·ª±c kho ch·ª©a v·∫≠t t∆∞</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                                    <div><label class="block text-sm font-medium text-gray-700 mb-1">T√¨nh tr·∫°ng kho</label><select class="form-select"><option>C√≥ kho ri√™ng, x√¢y ki√™n c·ªë</option><option>C√≥ khu v·ª±c ri√™ng trong nh√†</option><option>Kh√¥ng c√≥ kho</option></select></div>
                                    <div><label class="block text-sm font-medium text-gray-700 mb-1">V·ªã tr√≠ kho</label><input type="text" class="form-input" placeholder="M√¥ t·∫£ v·ªã tr√≠..."></div>
                                    <div class="md:col-span-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">ƒêi·ªÅu ki·ªán b·∫£o qu·∫£n:</label>
                                        <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                            <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">C√≥ bi·ªÉn b√°o</span></label>
                                            <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">C√≥ kh√≥a an to√†n</span></label>
                                            <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">Ph√¢n khu ri√™ng</span></label>
                                            <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">K·ªá/gi√° ƒë·ª°</span></label>
                                            <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">Th√¥ng tho√°ng</span></label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label for="equipment-list" class="block text-sm font-medium text-gray-700 mb-1">Danh m·ª•c trang thi·∫øt b·ªã s·∫£n xu·∫•t ch√≠nh</label>
                                <textarea id="equipment-list" rows="3" class="form-textarea" placeholder="Li·ªát k√™: m√°y c√†y, b√¨nh phun..."></textarea>
                                <button type="button" class="mt-2 text-sm font-medium text-green-600 hover:text-green-800"><i class="fas fa-plus-circle mr-1"></i>Th√™m trang thi·∫øt b·ªã t·ª´ th∆∞ vi·ªán</button>
                            </div>
                            <div><label for="waste-management" class="block text-sm font-medium text-gray-700 mb-1">Ph∆∞∆°ng √°n x·ª≠ l√Ω bao b√¨ v·∫≠t t∆∞</label><select id="waste-management" class="form-select"><option>Thu gom t·∫°i n∆°i quy ƒë·ªãnh</option><option>Ch√¥n l·∫•p trong h·ªë ri√™ng</option><option>Tr·∫£ l·∫°i ƒë·∫°i l√Ω</option><option>Ch∆∞a c√≥</option></select></div>
                        </div>
                    </div>
                    <div class="border-t pt-12">
                        <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center"><div class="w-8 h-8 flex items-center justify-center bg-indigo-100 text-indigo-600 rounded-lg mr-3"><i class="fas fa-users"></i></div>VI. Nh√¢n s·ª± & An to√†n lao ƒë·ªông</h2>
                        <div class="space-y-6">
                             <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div><label for="labor-count" class="block text-sm font-medium text-gray-700 mb-1">T·ªïng s·ªë lao ƒë·ªông th∆∞·ªùng xuy√™n</label><input type="number" id="labor-count" class="form-input" placeholder="VD: 5"></div>
                                <div><label for="training-status" class="block text-sm font-medium text-gray-700 mb-1">T√¨nh tr·∫°ng t·∫≠p hu·∫•n VietGAP/ATVSLƒê</label><select id="training-status" class="form-select"><option>ƒê√£ t·∫≠p hu·∫•n</option><option>M·ªôt ph·∫ßn ƒë√£ t·∫≠p hu·∫•n</option><option>Ch∆∞a t·∫≠p hu·∫•n</option></select></div>
                            </div>
                             <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Trang b·ªã b·∫£o h·ªô lao ƒë·ªông (PPE) c√≥ s·∫µn:</label>
                                 <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                    <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">Qu·∫ßn √°o b·∫£o h·ªô</span></label>
                                    <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">GƒÉng tay</span></label>
                                    <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">·ª¶ng</span></label>
                                    <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">K√≠nh m·∫Øt</span></label>
                                    <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">M≈©/n√≥n</span></label>
                                    <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">M·∫∑t n·∫°</span></label>
                                </div>
                            </div>
                            <div><label class="block text-sm font-medium text-gray-700 mb-1">Trang b·ªã y t·∫ø & s∆° c·ª©u</label><select class="form-select"><option>C√≥ t·ªß thu·ªëc ƒë·∫ßy ƒë·ªß</option><option>Ch·ªâ c√≥ t·ªß thu·ªëc c∆° b·∫£n</option><option>Kh√¥ng c√≥</option></select></div>
                        </div>
                    </div>
                 </div>

                <div class="form-step space-y-12">
                     <div>
                        <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center"><div class="w-8 h-8 flex items-center justify-center bg-red-100 text-red-600 rounded-lg mr-3"><i class="fas fa-bug"></i></div>VII. Qu·∫£n l√Ω V·∫≠t t∆∞ n√¥ng nghi·ªáp & S√¢u b·ªánh h·∫°i</h2>
                        <div class="space-y-6">
                            <div class="space-y-4 p-4 border rounded-lg bg-slate-50">
                                <h3 class="font-semibold text-gray-700">A. Qu·∫£n l√Ω Ph√¢n b√≥n</h3>
                                 <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Danh m·ª•c ph√¢n b√≥n s·ª≠ d·ª•ng:</label>
                                    <div class="p-2 border rounded-md min-h-[4rem] bg-white"></div>
                                    <button type="button" class="mt-2 text-sm font-medium text-green-600 hover:text-green-800"><i class="fas fa-plus-circle mr-1"></i>Th√™m ph√¢n b√≥n t·ª´ th∆∞ vi·ªán</button>
                                </div>
                            </div>
                            <div class="space-y-4 p-4 border rounded-lg bg-slate-50">
                                <h3 class="font-semibold text-gray-700">B. Qu·∫£n l√Ω Thu·ªëc BVTV & S√¢u b·ªánh h·∫°i</h3>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">1. Danh m·ª•c thu·ªëc BVTV cho ph√©p:</label>
                                    <div class="p-2 border rounded-md min-h-[4rem] bg-white"></div>
                                    <button type="button" class="mt-2 text-sm font-medium text-green-600 hover:text-green-800"><i class="fas fa-plus-circle mr-1"></i>Th√™m t·ª´ th∆∞ vi·ªán</button>
                                </div>
                                <div class="mt-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">2. Th√†nh ph·∫ßn sinh v·∫≠t g√¢y h·∫°i ƒë√£ ph√°t hi·ªán:</label>
                                    <div class="p-2 border rounded-md min-h-[4rem] bg-white"></div>
                                    <button type="button" class="mt-2 text-sm font-medium text-green-600 hover:text-green-800"><i class="fas fa-plus-circle mr-1"></i>Th√™m SVGH t·ª´ th∆∞ vi·ªán</button>
                                </div>
                                 <div class="mt-4">
                                    <label for="treatment-plan" class="block text-sm font-medium text-gray-700 mb-2">3. C√°c ph∆∞∆°ng √°n x·ª≠ l√Ω t∆∞∆°ng ·ª©ng:</label>
                                    <textarea id="treatment-plan" rows="3" class="form-textarea" placeholder="VD: Phun thu·ªëc X cho r·∫ßy..."></textarea>
                                    <button type="button" class="mt-2 text-sm font-medium text-green-600 hover:text-green-800"><i class="fas fa-plus-circle mr-1"></i>Th√™m ph∆∞∆°ng √°n x·ª≠ l√Ω</button>
                                </div>
                            </div>
                        </div>
                     </div>
                     <div class="border-t pt-12">
                        <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center"><div class="w-8 h-8 flex items-center justify-center bg-yellow-100 text-yellow-600 rounded-lg mr-3"><i class="fas fa-certificate"></i></div>VIII. Th·ª±c h√†nh s·∫£n xu·∫•t & Ch·ª©ng nh·∫≠n</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Ti√™u chu·∫©n √°p d·ª•ng (GAP)</label>
                                <div class="space-y-2">
                                    <label class="flex items-center"><input type="checkbox" class="form-checkbox" checked><span class="ml-2 text-sm text-gray-600">VietGap</span></label>
                                    <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">GlobalG.A.P</span></label>
                                    <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">H·ªØu c∆° (Organic)</span></label>
                                    <label class="flex items-center"><input type="checkbox" class="form-checkbox"><span class="ml-2 text-sm text-gray-600">Th√¥ng th∆∞·ªùng</span></label>
                                </div>
                            </div>
                            <div>
                                <label for="certificate-serial" class="block text-sm font-medium text-gray-700 mb-1">S·ªë seri ch·ª©ng nh·∫≠n</label>
                                <input type="text" name="certificate-serial" id="certificate-serial" class="form-input" placeholder="Nh·∫≠p s·ªë seri n·∫øu c√≥">
                                <label class="block text-sm font-medium text-gray-700 mt-4 mb-1">T·∫£i l√™n ·∫£nh ch·ª•p ch·ª©ng nh·∫≠n</label>
                                <div class="file-input-wrapper h-auto py-4"><input type="file" class="sr-only" id="certificate-upload"><label for="certificate-upload" class="cursor-pointer"><i class="fas fa-cloud-upload-alt text-gray-400 text-2xl"></i><p class="text-sm text-gray-500 mt-1">B·∫•m ƒë·ªÉ ch·ªçn file</p></label></div>
                            </div>
                        </div>
                     </div>
                </div>

                <div class="form-step space-y-12">
                     <div>
                        <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center"><div class="w-8 h-8 flex items-center justify-center bg-orange-100 text-orange-600 rounded-lg mr-3"><i class="fas fa-handshake"></i></div>IX. Th√¥ng tin b√™n thu mua</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label for="buyer-name" class="block text-sm font-medium text-gray-700 mb-1">T√™n ƒë∆°n v·ªã</label><input type="text" name="buyer-name" id="buyer-name" class="form-input" placeholder="VD: C√¥ng ty ABC"></div>
                            <div><label for="buyer-rep" class="block text-sm font-medium text-gray-700 mb-1">Ng∆∞·ªùi ƒë·∫°i di·ªán</label><input type="text" name="buyer-rep" id="buyer-rep" class="form-input" placeholder="VD: Nguy·ªÖn VƒÉn B"></div>
                            <div><label for="packing-code" class="block text-sm font-medium text-gray-700 mb-1">M√£ c∆° s·ªü ƒë√≥ng g√≥i (n·∫øu c√≥)</label><input type="text" name="packing-code" id="packing-code" class="form-input" placeholder="VD: VN-PACK-001"></div>
                            <div><label for="buyer-phone" class="block text-sm font-medium text-gray-700 mb-1">S·ªë ƒëi·ªán tho·∫°i</label><input type="tel" name="buyer-phone" id="buyer-phone" class="form-input" placeholder="0912345678"></div>
                            <div class="md:col-span-2"><label for="buyer-street" class="block text-sm font-medium text-gray-700 mb-1">ƒê·ªãa ch·ªâ</label><input type="text" name="buyer-street" id="buyer-street" class="form-input" placeholder="VD: 123 ƒê∆∞·ªùng ABC, Ph∆∞·ªùng X, Qu·∫≠n Y..."></div>
                        </div>
                     </div>
                      <div class="border-t pt-12">
                        <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center"><div class="w-8 h-8 flex items-center justify-center bg-gray-100 text-gray-600 rounded-lg mr-3"><i class="fas fa-file-alt"></i></div>X. Ghi ch√∫ kh√°c</h2>
                        <div><label for="other-notes" class="block text-sm font-medium text-gray-700 mb-1">C√°c n·ªôi dung kh√°c</label><textarea id="other-notes" name="other-notes" rows="4" class="form-textarea" placeholder="Ghi ch√∫ th√™m c√°c th√¥ng tin quan tr·ªçng kh√°c..."></textarea></div>
                    </div>
                    <div class="border-t pt-12">
                         <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center"><div class="w-8 h-8 flex items-center justify-center bg-blue-100 text-blue-600 rounded-lg mr-3"><i class="fas fa-rocket"></i></div>XI. K√≠ch ho·∫°t Quy tr√¨nh & Qu·∫£n l√Ω Nh·∫≠t k√Ω S·∫£n xu·∫•t</h2>
                        <div class="text-center bg-slate-50 p-8 rounded-xl border-2 border-dashed">
                             <p class="text-gray-600 mb-6 max-w-2xl mx-auto">
                                Sau khi l∆∞u c√°c th√¥ng tin thi·∫øt l·∫≠p c∆° b·∫£n c·ªßa v∆∞·ªùn, b·∫°n c√≥ th·ªÉ b·∫Øt ƒë·∫ßu quy tr√¨nh canh t√°c ti√™u chu·∫©n. M·ªçi ho·∫°t ƒë·ªông h√†ng ng√†y s·∫Ω ƒë∆∞·ª£c ghi ch√©p v√† qu·∫£n l√Ω trong m·ªôt giao di·ªán Dashboard chuy√™n bi·ªát v·ªÅ Nh·∫≠t k√Ω s·∫£n xu·∫•t.
                             </p>
                             <button type="button" class="w-full sm:w-auto text-white bg-blue-600 hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 font-bold rounded-lg text-base px-8 py-4 text-center uppercase tracking-wider shadow-lg hover:shadow-xl transition-all">
                                <i class="fas fa-cogs mr-3"></i>T·ªõi trang Qu·∫£n l√Ω Nh·∫≠t k√Ω S·∫£n xu·∫•t
                            </button>
                        </div>
                    </div>
                </div>

                <div class="pt-8 flex justify-between gap-4 border-t mt-12">
                    <button type="button" id="backBtn" class="bg-white py-2 px-6 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">
                        <i class="fas fa-arrow-left mr-2"></i>Quay l·∫°i
                    </button>
                    <div id="nav-actions" class="flex items-center gap-4">
                        <button type="button" id="nextBtn" class="inline-flex justify-center py-3 px-8 border border-transparent shadow-sm text-base font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700">
                            Ti·∫øp theo<i class="fas fa-arrow-right ml-2"></i>
                        </button>
                        <div id="final-actions" class="hidden flex items-center gap-4">
                             <button type="submit" id="submitBtn" class="inline-flex justify-center py-3 px-8 border border-transparent shadow-sm text-base font-medium rounded-lg text-white bg-green-600 hover:bg-green-700">
                                <i class="fas fa-save mr-2"></i>L∆∞u H·ªì S∆°
                            </button>
                            <button type="button" id="addFarmBtn" class="inline-flex justify-center py-3 px-8 border border-transparent shadow-sm text-base font-medium rounded-lg text-white bg-sky-600 hover:bg-sky-700">
                                <i class="fas fa-plus mr-2"></i>Th√™m V∆∞·ªùn M·ªõi
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </main>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('multiStepForm');
            const steps = Array.from(form.querySelectorAll('.form-step'));
            const stepperItems = Array.from(document.getElementById('stepper').querySelectorAll('.step'));
            const stepperLabel = document.getElementById('stepper-label');
            const nextBtn = document.getElementById('nextBtn');
            const backBtn = document.getElementById('backBtn');
            const finalActions = document.getElementById('final-actions');
            
            let currentStep = 0;

            function updateStepDisplay() {
                steps.forEach(step => step.classList.add('hidden'));
                steps[currentStep].classList.remove('hidden');

                stepperItems.forEach((step, index) => {
                    const circle = step.querySelector('.step-circle');
                    step.classList.remove('active', 'completed', 'inactive');

                    if (index === currentStep) {
                        step.classList.add('active');
                        stepperLabel.textContent = step.dataset.stepLabel;
                    } else if (index < currentStep) {
                        step.classList.add('completed');
                        circle.innerHTML = '<i class="fas fa-check"></i>';
                    } else {
                        step.classList.add('inactive');
                        circle.textContent = index + 1;
                    }
                });

                backBtn.classList.toggle('hidden', currentStep === 0);
                nextBtn.classList.toggle('hidden', currentStep === steps.length - 1);
                finalActions.classList.toggle('hidden', currentStep !== steps.length - 1);
            }
            
            function toggleTreeFields() {
                const stageSelect = document.getElementById('tree-stage');
                if (!stageSelect) return; 
                
                const stage = stageSelect.value;
                const matureWrapper = document.getElementById('tree-mature-wrapper');
                const nonWrapper = document.getElementById('tree-non-wrapper');
                const recoveryWrapper = document.getElementById('tree-recovery-wrapper');

                matureWrapper.classList.add('hidden');
                nonWrapper.classList.add('hidden');
                recoveryWrapper.classList.add('hidden');

                if (stage === 'mature') matureWrapper.classList.remove('hidden');
                else if (stage === 'non') nonWrapper.classList.remove('hidden');
                else if (stage === 'recovery') recoveryWrapper.classList.remove('hidden');
            }

            nextBtn.addEventListener('click', () => {
                if (currentStep < steps.length - 1) {
                    currentStep++;
                    updateStepDisplay();
                }
            });

            backBtn.addEventListener('click', () => {
                if (currentStep > 0) {
                    currentStep--;
                    updateStepDisplay();
                }
            });
            
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                alert('ƒê√£ g·ª≠i h·ªì s∆° th√†nh c√¥ng!');
            });
            
            const treeStageSelect = document.getElementById('tree-stage');
            if(treeStageSelect) {
                treeStageSelect.addEventListener('change', toggleTreeFields);
            }

            updateStepDisplay();
            toggleTreeFields();
        });

    </script>
</body>
</html>