<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FarmKeeper - X√¢y d·ª±ng Quy tr√¨nh Canh t√°c To√†n di·ªán</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        .main-container {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
        }
        
        .card-modern {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(226, 232, 240, 0.6);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        
        .card-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        .phase-card {
            border: 2px solid #e5e7eb;
            border-radius: 16px;
            margin-bottom: 24px;
            transition: all 0.3s ease;
            background: white;
            position: relative;
        }
        
        .phase-card.setup-phase {
            border-left: 8px solid #6366f1;
        }
        
        .phase-card.recurring-phase {
            border-left: 8px solid #22c55e;
        }
        
        .phase-card.active {
            border-color: #22c55e;
            box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.1);
        }
        
        .phase-header {
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 14px 14px 0 0;
            display: flex;
            align-items: center;
            justify-content: between;
            position: relative;
        }
        
        .phase-header.phase-1 { background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%); }
        .phase-header.phase-2 { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); }
        .phase-header.phase-3 { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); }
        .phase-header.phase-4 { background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); }
        .phase-header.phase-5 { background: linear-gradient(135deg, #a855f7 0%, #7c3aed 100%); }
        .phase-header.phase-6 { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .phase-header.phase-7 { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        
        .cycle-indicator {
            position: absolute;
            top: -8px;
            right: 16px;
            background: white;
            color: #22c55e;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            border: 2px solid #22c55e;
        }
        
        .setup-indicator {
            background: white;
            color: #6366f1;
            border-color: #6366f1;
        }
        
        .phase-content {
            padding: 1.5rem;
        }
        
        .task-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .task-card:hover {
            background: #f1f5f9;
            border-color: #22c55e;
            transform: translateX(4px);
        }
        
        .task-card.selected {
            background: #f0fdf4;
            border-color: #22c55e;
            border-width: 2px;
        }
        
        .add-task-btn {
            border: 2px dashed #cbd5e1;
            background: #f8fafc;
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            color: #64748b;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .add-task-btn:hover {
            border-color: #22c55e;
            background: #f0fdf4;
            color: #22c55e;
        }
        
        .cycle-divider {
            border: 3px dashed #22c55e;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
            margin: 32px 0;
            padding: 16px;
            text-align: center;
            position: relative;
        }
        
        .cycle-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background: white;
            border: 3px solid #22c55e;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #22c55e;
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
        }
        
        .btn-secondary {
            background: #f1f5f9;
            color: #475569;
            padding: 8px 16px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: #e2e8f0;
            transform: translateY(-1px);
        }
        
        .resource-tag {
            background: #e0f2fe;
            color: #0277bd;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            margin: 2px 4px 2px 0;
            display: inline-flex;
            align-items: center;
        }
        
        .skill-tag {
            background: #fef3c7;
            color: #92400e;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            max-width: 1000px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .form-section {
            border-bottom: 1px solid #e5e7eb;
            padding: 1.5rem;
        }
        
        .form-section:last-child {
            border-bottom: none;
        }
        
        .sidebar-info {
            position: sticky;
            top: 20px;
        }
        
        .cycle-config {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
            border: 2px solid rgba(34, 197, 94, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .growth-parameters {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(37, 99, 235, 0.05) 100%);
            border: 2px solid rgba(59, 130, 246, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .phase-growth-params {
            background: rgba(59, 130, 246, 0.05);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .param-input-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .param-label {
            min-width: 120px;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
        }
        
        .param-value {
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 0.5rem;
            font-size: 0.875rem;
            min-width: 80px;
        }
        
        .param-unit {
            font-size: 0.75rem;
            color: #6b7280;
            min-width: 40px;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #22c55e;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .criteria-item {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .criteria-item.completed {
            background: #f0fdf4;
            border-color: #22c55e;
        }
        
        .criteria-item.failed {
            background: #fef2f2;
            border-color: #ef4444;
        }
        
        .checklist-item {
            display: flex;
            align-items: center;
            space-x: 2px;
            margin-bottom: 0.5rem;
        }
        
        .file-upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            background: #f9fafb;
            transition: all 0.3s ease;
        }
        
        .file-upload-area:hover {
            border-color: #22c55e;
            background: #f0fdf4;
        }
        
        .file-upload-area.dragover {
            border-color: #22c55e;
            background: #f0fdf4;
        }
    </style>
</head>
<body class="main-container">
    <div class="container mx-auto px-6 py-8 max-w-7xl">
        <!-- Header -->
        <div class="card-modern mb-8">
            <div class="p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">X√¢y d·ª±ng Quy tr√¨nh Canh t√°c To√†n di·ªán</h1>
                        <p class="text-gray-600">T·∫°o quy tr√¨nh ƒë·∫ßy ƒë·ªß t·ª´ tr·ªìng m·ªõi ƒë·∫øn s·∫£n xu·∫•t l·∫∑p l·∫°i</p>
                    </div>
                    <div class="flex space-x-3">
                        <button class="btn-secondary" onclick="saveTemplate()">
                            <i class="fas fa-save mr-2"></i>L∆∞u Template
                        </button>
                        <button class="btn-primary" onclick="publishProcess()">
                            <i class="fas fa-rocket mr-2"></i>Xu·∫•t b·∫£n
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- Main Content -->
            <div class="lg:col-span-3">
                <!-- Process Info -->
                <div class="card-modern mb-8">
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-6">Th√¥ng tin Quy tr√¨nh</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ƒê∆°n v·ªã x√¢y d·ª±ng</label>
                                <input type="text" class="form-input" id="building-unit" placeholder="VD: C√¥ng ty TNHH N√¥ng nghi·ªáp ABC" value="C√îNG TY CP TMDV & ƒê·∫¶U T∆Ø SVIFARM">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">D·ª± √°n</label>
                                <input type="text" class="form-input" id="project-name" placeholder="VD: D·ª± √°n s·∫ßu ri√™ng xu·∫•t kh·∫©u 2024" value="D·ª± √°n x√¢y d·ª±ng v√πng tr·ªìng s·∫ßu ri√™ng quy chu·∫©n xu·∫•t kh·∫©u">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ƒê·ªëi t∆∞·ª£ng s·∫£n xu·∫•t</label>
                                <select class="form-input" id="production-type" onchange="updateProductionObjects()">
                                    <option value="crops" selected>Tr·ªìng tr·ªçt</option>
                                    <option value="livestock">ChƒÉn nu√¥i</option>
                                    <option value="aquaculture">Th·ªßy s·∫£n</option>
                                    <option value="integrated">N√¥ng tr·∫°i k·∫øt h·ª£p</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ƒê·ªëi t∆∞·ª£ng c·ª• th·ªÉ</label>
                                <select class="form-input" id="specific-object" onchange="updateVarieties()">
                                    <option value="durian" selected>S·∫ßu ri√™ng</option>
                                    <option value="mango">Xo√†i</option>
                                    <option value="avocado">B∆°</option>
                                    <option value="rambutan">Ch√¥m ch√¥m</option>
                                    <option value="longan">Nh√£n</option>
                                    <option value="coconut">D·ª´a</option>
                                    <option value="coffee">C√† ph√™</option>
                                    <option value="pepper">Ti√™u</option>
                                    <option value="other">Kh√°c</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Gi·ªëng</label>
                                <select class="form-input" id="variety" onchange="updateGrowthParameters()">
                                    <option value="dona-thai" selected>Dona - Th√°i</option>
                                    <option value="ri6">Ri 6</option>
                                    <option value="monthong">Monthong</option>
                                    <option value="chanee">Chanee</option>
                                    <option value="kanyao">Kan Yao</option>
                                    <option value="custom">Gi·ªëng kh√°c</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Khu v·ª±c √°p d·ª•ng</label>
                            <div class="flex flex-wrap gap-2">
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="w-4 h-4 text-green-600" checked onchange="updateGrowthParameters()">
                                    <span class="text-sm">T√¢y Nguy√™n</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="w-4 h-4 text-green-600" checked onchange="updateGrowthParameters()">
                                    <span class="text-sm">ƒê√¥ng Nam B·ªô</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="w-4 h-4 text-green-600" onchange="updateGrowthParameters()">
                                    <span class="text-sm">T√¢y Nam B·ªô</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="w-4 h-4 text-green-600" onchange="updateGrowthParameters()">
                                    <span class="text-sm">Mi·ªÅn Trung</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" class="w-4 h-4 text-green-600" onchange="updateGrowthParameters()">
                                    <span class="text-sm">Mi·ªÅn B·∫Øc</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">M√¥ t·∫£ quy tr√¨nh</label>
                            <textarea class="form-input" rows="3" placeholder="M√¥ t·∫£ t·ªïng quan v·ªÅ quy tr√¨nh canh t√°c n√†y, ƒëi·ªÅu ki·ªán √°p d·ª•ng v√† m·ª•c ti√™u...">Quy tr√¨nh canh t√°c s·∫ßu ri√™ng Dona - Th√°i to√†n di·ªán t·ª´ giai ƒëo·∫°n tr·ªìng m·ªõi ƒë·∫øn s·∫£n xu·∫•t ·ªïn ƒë·ªãnh. Bao g·ªìm giai ƒëo·∫°n thi·∫øt l·∫≠p ban ƒë·∫ßu (m·ªôt l·∫ßn) v√† chu k·ª≥ s·∫£n xu·∫•t h√†ng nƒÉm (l·∫∑p l·∫°i).</textarea>
                        </div>
                    </div>
                </div>

                <!-- Growth Parameters -->
                <div class="growth-parameters">
                    <h3 class="text-xl font-bold text-blue-800 mb-4 flex items-center">
                        <i class="fas fa-chart-line mr-3"></i>
                        Tham s·ªë Sinh tr∆∞·ªüng C√¢y/Con
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="param-input-group">
                            <div class="param-label">Gi·ªëng:</div>
                            <input type="text" class="param-value" id="growth-variety" value="Dona - Th√°i" readonly>
                        </div>
                        
                        <div class="param-input-group">
                            <div class="param-label">Tu·ªïi thu ho·∫°ch:</div>
                            <input type="number" class="param-value" id="harvest-age-start" value="3" min="1" max="10">
                            <span class="param-unit">nƒÉm (b·∫Øt ƒë·∫ßu)</span>
                        </div>
                        
                        <div class="param-input-group">
                            <div class="param-label">Tu·ªïi ·ªïn ƒë·ªãnh:</div>
                            <input type="number" class="param-value" id="stable-age" value="5" min="3" max="15">
                            <span class="param-unit">nƒÉm</span>
                        </div>
                        
                        <div class="param-input-group">
                            <div class="param-label">Khu v·ª±c ch√≠nh:</div>
                            <select class="param-value" id="main-region" onchange="updateRegionParameters()">
                                <option value="tay-nguyen" selected>T√¢y Nguy√™n</option>
                                <option value="dong-nam-bo">ƒê√¥ng Nam B·ªô</option>
                                <option value="tay-nam-bo">T√¢y Nam B·ªô</option>
                                <option value="mien-trung">Mi·ªÅn Trung</option>
                                <option value="mien-bac">Mi·ªÅn B·∫Øc</option>
                            </select>
                        </div>
                        
                        <div class="param-input-group">
                            <div class="param-label">S·ªë v·ª•/nƒÉm:</div>
                            <input type="number" class="param-value" id="crops-per-year" value="1" min="1" max="4">
                            <span class="param-unit">v·ª•</span>
                        </div>
                        
                        <div class="param-input-group">
                            <div class="param-label">Ng√†y sinh tr∆∞·ªüng tr√°i:</div>
                            <input type="number" class="param-value" id="fruit-growth-days-min" value="120" min="90" max="200">
                            <span class="param-unit">-</span>
                            <input type="number" class="param-value" id="fruit-growth-days-max" value="140" min="90" max="200">
                            <span class="param-unit">ng√†y</span>
                        </div>
                    </div>
                    
                    <div class="mt-4 p-4 bg-blue-50 rounded-lg">
                        <h4 class="font-semibold text-blue-800 mb-2">Tham s·ªë Khu v·ª±c c·ª• th·ªÉ (B·ªï sung th√™m c√°c tr∆∞·ªùng khuy·∫øn ngh·ªã ch·ªâ s·ªë t·ªëi ∆∞u v·ªÅ PH ƒê·∫•t; ƒê·ªô ·∫©m; ƒê·ªô cao; Dinh d∆∞·ª°ng...v√† ph∆∞∆°ng th·ª©c thu th·∫≠p t∆∞∆°ng ·ª©ng) </h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div class="param-input-group">
                                <div class="param-label">Nhi·ªát ƒë·ªô TB:</div>
                                <input type="number" class="param-value" id="avg-temp" value="26" min="20" max="35">
                                <span class="param-unit">¬∞C</span>
                            </div>
                            
                            <div class="param-input-group">
                                <div class="param-label">ƒê·ªô ·∫©m TB:</div>
                                <input type="number" class="param-value" id="avg-humidity" value="75" min="60" max="90">
                                <span class="param-unit">%</span>
                            </div>
                            
                            <div class="param-input-group">
                                <div class="param-label">M∆∞a TB:</div>
                                <input type="number" class="param-value" id="avg-rainfall" value="1800" min="1200" max="3000">
                                <span class="param-unit">mm/nƒÉm</span>
                            </div>
                            
                            <div class="param-input-group">
                                <div class="param-label">ƒê·ªô cao:</div>
                                <input type="number" class="param-value" id="altitude" value="500" min="0" max="1500">
                                <span class="param-unit">m</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cycle Configuration -->
                <div class="cycle-config">
                    <h3 class="text-xl font-bold text-green-800 mb-4 flex items-center">
                        <i class="fas fa-sync-alt mr-3"></i>
                        C·∫•u h√¨nh Chu k·ª≥ L·∫∑p l·∫°i
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Lo·∫°i chu k·ª≥</label>
                            <select class="form-input" id="cycle-type" onchange="updateCycleType()">
                                <option value="annual" selected>H√†ng nƒÉm (Annual)</option>
                                <option value="seasonal">Theo m√πa v·ª• (Seasonal)</option>
                                <option value="quarterly">Theo qu√Ω (Quarterly)</option>
                                <option value="monthly">H√†ng th√°ng (Monthly)</option>
                                <option value="breeding">Theo l·ª©a sinh s·∫£n</option>
                                <option value="custom">T√πy ch·ªânh</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Th·ªùi gian chu k·ª≥</label>
                            <div class="flex items-center space-x-2">
                                <input type="number" class="form-input w-20" value="12" min="1">
                                <select class="form-input flex-1">
                                    <option value="months" selected>Th√°ng</option>
                                    <option value="weeks">Tu·∫ßn</option>
                                    <option value="days">Ng√†y</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Giai ƒëo·∫°n b·∫Øt ƒë·∫ßu l·∫∑p l·∫°i</label>
                            <select class="form-input" id="start-recurring">
                                <option value="3" selected>T·ª´ giai ƒëo·∫°n 3</option>
                                <option value="4">T·ª´ giai ƒëo·∫°n 4</option>
                                <option value="5">T·ª´ giai ƒëo·∫°n 5</option>
                                <option value="6">T·ª´ giai ƒëo·∫°n 6</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mt-4 p-4 bg-white/70 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <h4 class="font-semibold text-gray-800">K√≠ch ho·∫°t chu k·ª≥ l·∫∑p l·∫°i</h4>
                                <p class="text-sm text-gray-600">C√°c giai ƒëo·∫°n t·ª´ "Chu·∫©n b·ªã ra hoa" s·∫Ω l·∫∑p l·∫°i h√†ng nƒÉm</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked onchange="toggleRecurringCycle()">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Setup Phases (One-time) -->
                <div class="mb-8">
                    <h2 class="text-2xl font-bold text-indigo-700 mb-4 flex items-center">
                        <i class="fas fa-rocket mr-3"></i>
                        Giai ƒëo·∫°n Thi·∫øt l·∫≠p Ban ƒë·∫ßu (M·ªôt l·∫ßn)
                    </h2>
                    
                    <!-- Phase 1: Plantation Setup -->
                    <div class="phase-card setup-phase" data-phase="1">
                        <div class="cycle-indicator setup-indicator">M·ªôt l·∫ßn</div>
                        <div class="phase-header phase-1">
                            <div class="flex items-center flex-1">
                                <i class="fas fa-shovel mr-3 text-xl"></i>
                                <div>
                                    <h3 class="text-lg font-bold">Giai ƒëo·∫°n 1: Tr·ªìng c√¢y m·ªõi</h3>
                                    <p class="text-sm opacity-90">Chu·∫©n b·ªã ƒë·∫•t v√† tr·ªìng c√¢y gi·ªëng (4-6 th√°ng)</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-white hover:text-indigo-200 p-2" onclick="editPhase(1)" title="Ch·ªânh s·ª≠a giai ƒëo·∫°n">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="text-white hover:text-red-200 p-2" onclick="deletePhase(1)" title="X√≥a giai ƒëo·∫°n">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="phase-content">
                            <!-- Growth Parameters for Phase 1 -->
                            <div class="phase-growth-params">
                                <h4 class="font-semibold text-blue-700 mb-3 flex items-center">
                                    <i class="fas fa-seedling mr-2"></i>
                                    Tham s·ªë Sinh tr∆∞·ªüng - Giai ƒëo·∫°n Tr·ªìng m·ªõi
                                </h4>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                                    <div class="param-input-group">
                                        <div class="param-label">Th·ªùi gian b·∫Øt ƒë·∫ßu:</div>
                                        <input type="number" class="param-value" value="4" min="3" max="8">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="6" min="3" max="8">
                                        <span class="param-unit">th√°ng</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">Tu·ªïi c√¢y:</div>
                                        <input type="text" class="param-value" value="C√¢y gi·ªëng 1-2 nƒÉm" readonly>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">T·ª∑ l·ªá s·ªëng m·ª•c ti√™u:</div>
                                        <input type="number" class="param-value" value="95" min="80" max="100">
                                        <span class="param-unit">%</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">Chi·ªÅu cao c√¢y:</div>
                                        <input type="number" class="param-value" value="1.5" min="1" max="3" step="0.1">
                                        <span class="param-unit">m</span>
                                    </div>
                                </div>
                                
                                <!-- Planting Density Parameters -->
                                <div class="mt-4 p-3 bg-green-50 rounded-lg border border-green-200">
                                    <h5 class="font-semibold text-green-800 mb-3 flex items-center">
                                        <i class="fas fa-th mr-2"></i>
                                        Quy c√°ch/M·∫≠t ƒë·ªô Tr·ªìng/Nu√¥i
                                    </h5>
                                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3 text-sm">
                                        <div class="param-input-group">
                                            <div class="param-label">Kho·∫£ng c√°ch tr·ªìng:</div>
                                            <select class="param-value" id="planting-distance" onchange="calculateDensity()">
                                                <option value="8x8">8m x 8m (Ti√™u chu·∫©n)</option>
                                                <option value="9x9">9m x 9m (R·ªông r√£i)</option>
                                                <option value="10x10" selected>10m x 10m (Tho√°ng)</option>
                                                <option value="8x10">8m x 10m (Ch·ªØ nh·∫≠t)</option>
                                                <option value="intercrop">Xen canh (6x8m)</option>
                                                <option value="intensive">Th√¢m canh (7x7m)</option>
                                                <option value="custom">T√πy ch·ªânh</option>
                                            </select>
                                        </div>
                                        
                                        <div class="param-input-group" id="custom-distance-group" style="display: none;">
                                            <div class="param-label">Kho·∫£ng c√°ch t√πy ch·ªânh:</div>
                                            <div class="flex items-center space-x-1">
                                                <input type="number" class="param-value w-16" id="custom-distance-x" value="10" min="5" max="15" step="0.5" onchange="calculateDensity()">
                                                <span class="param-unit">x</span>
                                                <input type="number" class="param-value w-16" id="custom-distance-y" value="10" min="5" max="15" step="0.5" onchange="calculateDensity()">
                                                <span class="param-unit">m</span>
                                            </div>
                                        </div>
                                        
                                        <div class="param-input-group">
                                            <div class="param-label">M·∫≠t ƒë·ªô:</div>
                                            <div class="flex items-center space-x-1">
                                                <input type="number" class="param-value w-20" id="planting-density" value="100" readonly>
                                                <span class="param-unit">c√¢y/ha</span>
                                            </div>
                                        </div>
                                        
                                        <div class="param-input-group">
                                            <div class="param-label">Di·ªán t√≠ch/c√¢y:</div>
                                            <div class="flex items-center space-x-1">
                                                <input type="number" class="param-value w-20" id="area-per-tree" value="100" readonly>
                                                <span class="param-unit">m¬≤/c√¢y</span>
                                            </div>
                                        </div>
                                        
                                        <div class="param-input-group">
                                            <div class="param-label">S·ªë c√¢y/1000m¬≤:</div>
                                            <div class="flex items-center space-x-1">
                                                <input type="number" class="param-value w-20" id="trees-per-1000m2" value="10" readonly>
                                                <span class="param-unit">c√¢y</span>
                                            </div>
                                        </div>
                                        
                                        <div class="param-input-group">
                                            <div class="param-label">Lo·∫°i tr·ªìng:</div>
                                            <select class="param-value" id="planting-type" onchange="updatePlantingRecommendations()">
                                                <option value="monoculture" selected>ƒê∆°n canh</option>
                                                <option value="intercrop">Xen canh</option>
                                                <option value="agroforestry">N√¥ng l√¢m k·∫øt h·ª£p</option>
                                                <option value="organic">H·ªØu c∆°</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <!-- Planting Recommendations -->
                                    <div class="mt-3 p-2 bg-white rounded border border-green-300">
                                        <div class="text-xs text-green-700">
                                            <strong>üí° Khuy·∫øn ngh·ªã:</strong>
                                            <span id="planting-recommendations">
                                                Kho·∫£ng c√°ch 10x10m ph√π h·ª£p cho s·∫ßu ri√™ng tr∆∞·ªüng th√†nh, ƒë·∫£m b·∫£o ƒë·ªß √°nh s√°ng v√† kh√¥ng gian ph√°t tri·ªÉn. M·∫≠t ƒë·ªô 100 c√¢y/ha cho nƒÉng su·∫•t t·ªëi ∆∞u.
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <!-- Quick Calculate for Area -->
                                    <div class="mt-3 p-2 bg-blue-50 rounded border border-blue-200">
                                        <div class="text-xs">
                                            <strong>üßÆ T√≠nh nhanh:</strong>
                                            <div class="grid grid-cols-3 gap-2 mt-1">
                                                <div>
                                                    <label class="block text-xs">Di·ªán t√≠ch (ha):</label>
                                                    <input type="number" class="param-value text-xs h-6" id="area-input" value="1" min="0.1" step="0.1" onchange="calculateTotalTrees()">
                                                </div>
                                                <div>
                                                    <label class="block text-xs">T·ªïng s·ªë c√¢y:</label>
                                                    <input type="number" class="param-value text-xs h-6" id="total-trees" value="100" readonly>
                                                </div>
                                                <div>
                                                    <label class="block text-xs">C√¢y d·ª± ph√≤ng (+5%):</label>
                                                    <input type="number" class="param-value text-xs h-6" id="spare-trees" value="105" readonly>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 1 -->
                            <div class="task-card" onclick="editTask(1, 1)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">Kh·∫£o s√°t v√† ph√¢n t√≠ch ƒë·∫•t</h4>
                                        <p class="text-sm text-gray-600 mt-1">L·∫•y m·∫´u ƒë·∫•t ph√¢n t√≠ch pH, NPK, ch·∫•t h·ªØu c∆° v√† ƒë·ªô ·∫©m</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-vial mr-1"></i>Kit ph√¢n t√≠ch ƒë·∫•t
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-map-marked-alt mr-1"></i>GPS mapping
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 k·ªπ thu·∫≠t + 2 h·ªó tr·ª£
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Chuy√™n gia</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 2 -->
                            <div class="task-card" onclick="editTask(1, 2)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">L√†m ƒë·∫•t v√† c·∫£i t·∫°o</h4>
                                        <p class="text-sm text-gray-600 mt-1">L√†m ƒë·∫•t s√¢u 60-80cm, ƒëi·ªÅu ch·ªânh pH 6.0-7.0, b√≥n ph√¢n h·ªØu c∆°</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-tractor mr-1"></i>M√°y x·ªõi ƒë·∫•t
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-seedling mr-1"></i>5-7 t·∫•n ph√¢n h·ªØu c∆°/ha
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>3-4 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Trung b√¨nh</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 3 -->
                            <div class="task-card" onclick="editTask(1, 3)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">T·∫°o h·ªë tr·ªìng ti√™u chu·∫©n</h4>
                                        <p class="text-sm text-gray-600 mt-1">ƒê√†o h·ªë 80x80x80cm, kho·∫£ng c√°ch 10x12m, b√≥n ph√¢n l√≥t</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-tools mr-1"></i>Cu·ªëc, x·∫ªng
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-weight-hanging mr-1"></i>20kg ph√¢n NPK/h·ªë
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2-3 ng∆∞·ªùi/ng√†y
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">C∆° b·∫£n</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 4 -->
                            <div class="task-card" onclick="editTask(1, 4)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">Ch·ªçn v√† tr·ªìng c√¢y gi·ªëng</h4>
                                        <p class="text-sm text-gray-600 mt-1">Ch·ªçn c√¢y gi·ªëng Dona-Th√°i kh·ªèe m·∫°nh, tr·ªìng ƒë√∫ng k·ªπ thu·∫≠t</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-seedling mr-1"></i>C√¢y gi·ªëng ch·∫•t l∆∞·ª£ng
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-water mr-1"></i>H·ªá th·ªëng t∆∞·ªõi
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 k·ªπ thu·∫≠t + 2 h·ªó tr·ª£
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">N√¢ng cao</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 5 -->
                            <div class="task-card" onclick="editTask(1, 5)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">Thi·∫øt l·∫≠p h·ªá th·ªëng t∆∞·ªõi</h4>
                                        <p class="text-sm text-gray-600 mt-1">L·∫Øp ƒë·∫∑t h·ªá th·ªëng t∆∞·ªõi nh·ªè gi·ªçt ho·∫∑c phun m∆∞a</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-faucet mr-1"></i>·ªêng t∆∞·ªõi nh·ªè gi·ªçt
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-pump-soap mr-1"></i>M√°y b∆°m
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2 th·ª£ k·ªπ thu·∫≠t
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Chuy√™n gia</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="add-task-btn" onclick="addTask(1)">
                                <i class="fas fa-plus mr-2"></i>
                                Th√™m c√¥ng vi·ªác v√†o giai ƒëo·∫°n n√†y
                            </div>
                        </div>
                    </div>

                    <!-- Phase 2: Young Tree Care -->
                    <div class="phase-card setup-phase" data-phase="2">
                        <div class="cycle-indicator setup-indicator">M·ªôt l·∫ßn</div>
                        <div class="phase-header phase-2">
                            <div class="flex items-center flex-1">
                                <i class="fas fa-seedling mr-3 text-xl"></i>
                                <div>
                                    <h3 class="text-lg font-bold">Giai ƒëo·∫°n 2: ChƒÉm s√≥c c√¢y non</h3>
                                    <p class="text-sm opacity-90">Nu√¥i d∆∞·ª°ng c√¢y 2-3 nƒÉm ƒë·∫ßu ƒë·∫øn khi ra hoa (24-36 th√°ng)</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-white hover:text-purple-200 p-2" onclick="editPhase(2)" title="Ch·ªânh s·ª≠a giai ƒëo·∫°n">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="text-white hover:text-red-200 p-2" onclick="deletePhase(2)" title="X√≥a giai ƒëo·∫°n">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="phase-content">
                            <!-- Growth Parameters for Phase 2 -->
                            <div class="phase-growth-params">
                                <h4 class="font-semibold text-blue-700 mb-3 flex items-center">
                                    <i class="fas fa-tree mr-2"></i>
                                    Tham s·ªë Sinh tr∆∞·ªüng - Giai ƒëo·∫°n C√¢y non
                                </h4>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                                    <div class="param-input-group">
                                        <div class="param-label">Th·ªùi gian tr·ªìng m·ªõi:</div>
                                        <input type="number" class="param-value" value="24" min="18" max="48">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="36" min="18" max="48">
                                        <span class="param-unit">th√°ng</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">Tu·ªïi c√¢y:</div>
                                        <input type="text" class="param-value" value="3-4 nƒÉm" readonly>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">Chi·ªÅu cao ƒë·∫°t:</div>
                                        <input type="number" class="param-value" value="3" min="2" max="5" step="0.1">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="4" min="2" max="5" step="0.1">
                                        <span class="param-unit">m</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">ƒê∆∞·ªùng k√≠nh th√¢n:</div>
                                        <input type="number" class="param-value" value="15" min="10" max="25">
                                        <span class="param-unit">cm</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 1 -->
                            <div class="task-card" onclick="editTask(2, 1)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">T∆∞·ªõi n∆∞·ªõc ƒë·ªãnh k·ª≥</h4>
                                        <p class="text-sm text-gray-600 mt-1">T∆∞·ªõi 2-3 l·∫ßn/tu·∫ßn, ƒë·∫£m b·∫£o ƒë·ªô ·∫©m 70-80%, tƒÉng c∆∞·ªùng m√πa kh√¥</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-water mr-1"></i>50-80L n∆∞·ªõc/c√¢y/l·∫ßn
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-thermometer-half mr-1"></i>ƒêo ƒë·ªô ·∫©m ƒë·∫•t
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1-2 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">C∆° b·∫£n</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 2 -->
                            <div class="task-card" onclick="editTask(2, 2)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">B√≥n ph√¢n ƒë·ªãnh k·ª≥</h4>
                                        <p class="text-sm text-gray-600 mt-1">B√≥n ph√¢n NPK v√† h·ªØu c∆° 4-6 l·∫ßn/nƒÉm theo ƒë·ªô tu·ªïi c√¢y</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-leaf mr-1"></i>NPK 16-16-8
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-seedling mr-1"></i>Ph√¢n h·ªØu c∆°
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2-3 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Trung b√¨nh</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 3 -->
                            <div class="task-card" onclick="editTask(2, 3)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">T·∫°o t√°n v√† t·ªâa c√†nh</h4>
                                        <p class="text-sm text-gray-600 mt-1">ƒê·ªãnh h√¨nh t√°n c√¢y, lo·∫°i b·ªè c√†nh y·∫øu, r·∫≠m r·∫°p</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-cut mr-1"></i>K√©o t·ªâa c√†nh
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-spray-can mr-1"></i>Thu·ªëc s√°t tr√πng v·∫øt c·∫Øt
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 k·ªπ thu·∫≠t
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">N√¢ng cao</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 4 -->
                            <div class="task-card" onclick="editTask(2, 4)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">Ph√≤ng tr·ª´ s√¢u b·ªánh</h4>
                                        <p class="text-sm text-gray-600 mt-1">Theo d√µi v√† x·ª≠ l√Ω s√¢u ƒë·ª•c th√¢n, b·ªánh th·ªëi r·ªÖ, n·∫•m l√°</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-bug mr-1"></i>Thu·ªëc tr·ª´ s√¢u sinh h·ªçc
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-shield-alt mr-1"></i>Thu·ªëc ph√≤ng b·ªánh
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 k·ªπ thu·∫≠t
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Chuy√™n gia</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 5 -->
                            <div class="task-card" onclick="editTask(2, 5)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">L√†m c·ªè v√† che ph·ªß g·ªëc</h4>
                                        <p class="text-sm text-gray-600 mt-1">L√†m s·∫°ch c·ªè d·∫°i, che ph·ªß g·ªëc b·∫±ng r∆°m ho·∫∑c l√° kh√¥</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-tools mr-1"></i>Cu·ªëc, dao c·∫Øt c·ªè
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-layer-group mr-1"></i>R∆°m, l√° kh√¥
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2-3 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">C∆° b·∫£n</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="add-task-btn" onclick="addTask(2)">
                                <i class="fas fa-plus mr-2"></i>
                                Th√™m c√¥ng vi·ªác v√†o giai ƒëo·∫°n n√†y
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recurring Cycle Divider -->
                <div class="cycle-divider">
                    <div class="flex items-center justify-center space-x-4">
                        <i class="fas fa-sync-alt text-3xl text-green-600"></i>
                        <div class="text-center">
                            <h3 class="text-xl font-bold text-green-800">Chu k·ª≥ S·∫£n xu·∫•t L·∫∑p l·∫°i</h3>
                            <p class="text-green-700">C√°c giai ƒëo·∫°n b√™n d∆∞·ªõi s·∫Ω l·∫∑p l·∫°i h√†ng nƒÉm</p>
                        </div>
                        <i class="fas fa-sync-alt text-3xl text-green-600"></i>
                    </div>
                </div>

                <!-- Production Phases (Recurring) -->
                <div class="mb-8">
                    <h2 class="text-2xl font-bold text-green-700 mb-4 flex items-center">
                        <i class="fas fa-sync-alt mr-3"></i>
                        Chu k·ª≥ S·∫£n xu·∫•t (L·∫∑p l·∫°i h√†ng nƒÉm)
                    </h2>
                    
                    <!-- Phase 3: Flowering Preparation -->
                    <div class="phase-card recurring-phase" data-phase="3">
                        <div class="cycle-indicator">L·∫∑p l·∫°i</div>
                        <div class="phase-header phase-3">
                            <div class="flex items-center flex-1">
                                <i class="fas fa-seedling mr-3 text-xl"></i>
                                <div>
                                    <h3 class="text-lg font-bold">Giai ƒëo·∫°n 3: Chu·∫©n b·ªã ra hoa</h3>
                                    <p class="text-sm opacity-90">Stress n∆∞·ªõc v√† k√≠ch th√≠ch ra hoa (2-3 th√°ng)</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-white hover:text-green-200 p-2" onclick="editPhase(3)" title="Ch·ªânh s·ª≠a giai ƒëo·∫°n">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="text-white hover:text-red-200 p-2" onclick="deletePhase(3)" title="X√≥a giai ƒëo·∫°n">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="phase-content">
                            <!-- Growth Parameters for Phase 3 -->
                            <div class="phase-growth-params">
                                <h4 class="font-semibold text-blue-700 mb-3 flex items-center">
                                    <i class="fas fa-tint mr-2"></i>
                                    Tham s·ªë Sinh tr∆∞·ªüng - Si·∫øt n∆∞·ªõc ph√¢n h√≥a m·∫ßm hoa
                                </h4>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                                    <div class="param-input-group">
                                        <div class="param-label">Th·ªùi gian b·∫Øt ƒë·∫ßu si·∫øt n∆∞·ªõc:</div>
                                        <input type="number" class="param-value" value="14" min="10" max="30">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="21" min="10" max="30">
                                        <span class="param-unit">ng√†y</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">Gi·∫£m n∆∞·ªõc:</div>
                                        <input type="number" class="param-value" value="50" min="30" max="80">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="70" min="30" max="80">
                                        <span class="param-unit">%</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">ƒê·ªô ·∫©m ƒë·∫•t:</div>
                                        <input type="number" class="param-value" value="40" min="30" max="60">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="50" min="30" max="60">
                                        <span class="param-unit">%</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">Th·ªùi gian chu·∫©n b·ªã:</div>
                                        <input type="number" class="param-value" value="2" min="1" max="4">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="3" min="1" max="4">
                                        <span class="param-unit">th√°ng</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 1 -->
                            <div class="task-card" onclick="editTask(3, 1)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">Stress n∆∞·ªõc k√≠ch th√≠ch ra hoa</h4>
                                        <p class="text-sm text-gray-600 mt-1">Gi·∫£m t∆∞·ªõi n∆∞·ªõc 50-70% trong 6-8 tu·∫ßn ƒë·ªÉ k√≠ch th√≠ch ra hoa</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-tint mr-1"></i>Gi·∫£m l∆∞·ª£ng n∆∞·ªõc t∆∞·ªõi
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-chart-line mr-1"></i>Theo d√µi ƒë·ªô ·∫©m ƒë·∫•t
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 k·ªπ thu·∫≠t
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Chuy√™n gia</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 2 -->
                            <div class="task-card" onclick="editTask(3, 2)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">B√≥n ph√¢n th√∫c ƒë·∫©y ra hoa</h4>
                                        <p class="text-sm text-gray-600 mt-1">B√≥n ph√¢n chuy√™n d·ª•ng cho giai ƒëo·∫°n ra hoa, tƒÉng P v√† K</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-leaf mr-1"></i>NPK 10-30-20
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-flask mr-1"></i>2-3kg/c√¢y tr∆∞·ªüng th√†nh
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Trung b√¨nh</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 3 -->
                            <div class="task-card" onclick="editTask(3, 3)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">T·ªâa c√†nh chu·∫©n b·ªã cho m√πa hoa</h4>
                                        <p class="text-sm text-gray-600 mt-1">T·ªâa b·ªè c√†nh y·∫øu, c√†nh ch·ªìng ch√©o, t·∫°o th√¥ng tho√°ng</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-cut mr-1"></i>K√©o t·ªâa chuy√™n d·ª•ng
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-spray-can mr-1"></i>Thu·ªëc b·∫£o v·ªá v·∫øt c·∫Øt
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 k·ªπ thu·∫≠t + 1 h·ªó tr·ª£
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">N√¢ng cao</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="add-task-btn" onclick="addTask(3)">
                                <i class="fas fa-plus mr-2"></i>
                                Th√™m c√¥ng vi·ªác v√†o giai ƒëo·∫°n n√†y
                            </div>
                        </div>
                    </div>

                    <!-- Phase 4: Flowering and Fruit Set -->
                    <div class="phase-card recurring-phase" data-phase="4">
                        <div class="cycle-indicator">L·∫∑p l·∫°i</div>
                        <div class="phase-header phase-4">
                            <div class="flex items-center flex-1">
                                <i class="fas fa-flower mr-3 text-xl"></i>
                                <div>
                                    <h3 class="text-lg font-bold">Giai ƒëo·∫°n 4: ChƒÉm s√≥c hoa v√† ƒë·∫≠u tr√°i</h3>
                                    <p class="text-sm opacity-90">T·ª´ n·ª• hoa ƒë·∫øn tr√°i non (2-3 th√°ng)</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-white hover:text-blue-200 p-2" onclick="editPhase(4)" title="Ch·ªânh s·ª≠a giai ƒëo·∫°n">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="text-white hover:text-red-200 p-2" onclick="deletePhase(4)" title="X√≥a giai ƒëo·∫°n">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="phase-content">
                            <!-- Growth Parameters for Phase 4 -->
                            <div class="phase-growth-params">
                                <h4 class="font-semibold text-blue-700 mb-3 flex items-center">
                                    <i class="fas fa-flower mr-2"></i>
                                    Tham s·ªë Sinh tr∆∞·ªüng - Ra hoa v√† th·ª• ph·∫•n
                                </h4>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                                    <div class="param-input-group">
                                        <div class="param-label">Th·ªùi gian ra hoa:</div>
                                        <input type="number" class="param-value" value="16" min="14" max="25">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="21" min="14" max="25">
                                        <span class="param-unit">ng√†y</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">T·ª∑ l·ªá ƒë·∫≠u tr√°i:</div>
                                        <input type="number" class="param-value" value="15" min="10" max="30">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="25" min="10" max="30">
                                        <span class="param-unit">%</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">S·ªë tr√°i/c√¢y:</div>
                                        <input type="number" class="param-value" value="15" min="10" max="30">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="20" min="10" max="30">
                                        <span class="param-unit">tr√°i</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">Th·ªùi gian giai ƒëo·∫°n:</div>
                                        <input type="number" class="param-value" value="2" min="1" max="4">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="3" min="1" max="4">
                                        <span class="param-unit">th√°ng</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 1 -->
                            <div class="task-card" onclick="editTask(4, 1)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">T∆∞·ªõi n∆∞·ªõc cho giai ƒëo·∫°n ra hoa</h4>
                                        <p class="text-sm text-gray-600 mt-1">Kh√¥i ph·ª•c t∆∞·ªõi n∆∞·ªõc ƒë·ªÅu ƒë·∫∑n sau khi c√≥ hoa, tr√°nh √∫ng ng·∫≠p</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-water mr-1"></i>100-150L/c√¢y/l·∫ßn
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-clock mr-1"></i>2-3 l·∫ßn/tu·∫ßn
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Trung b√¨nh</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 2 -->
                            <div class="task-card" onclick="editTask(4, 2)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">B√≥n ph√¢n cho giai ƒëo·∫°n ƒë·∫≠u tr√°i</h4>
                                        <p class="text-sm text-gray-600 mt-1">B√≥n ph√¢n gi√†u ƒë·∫°m v√† kali ƒë·ªÉ h·ªó tr·ª£ ƒë·∫≠u tr√°i</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-leaf mr-1"></i>NPK 20-10-20
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-seedling mr-1"></i>Ph√¢n b√≥n l√°
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Trung b√¨nh</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 3 -->
                            <div class="task-card" onclick="editTask(4, 3)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">Th·ª• ph·∫ßn nh√¢n t·∫°o (n·∫øu c·∫ßn)</h4>
                                        <p class="text-sm text-gray-600 mt-1">H·ªó tr·ª£ th·ª• ph·∫•n ƒë·ªÉ tƒÉng t·ª∑ l·ªá ƒë·∫≠u tr√°i</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-brush mr-1"></i>C·ªç th·ª• ph·∫•n
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-clock mr-1"></i>S√°ng s·ªõm 5-7h
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 k·ªπ thu·∫≠t
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Chuy√™n gia</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 4 -->
                            <div class="task-card" onclick="editTask(4, 4)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">Ph√≤ng tr·ª´ s√¢u b·ªánh giai ƒëo·∫°n hoa tr√°i</h4>
                                        <p class="text-sm text-gray-600 mt-1">Ph√≤ng ng·ª´a s√¢u ƒë·ª•c qu·∫£, b·ªánh th·ªëi tr√°i</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-shield-alt mr-1"></i>Thu·ªëc tr·ª´ s√¢u sinh h·ªçc
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-spray-can mr-1"></i>M√°y phun thu·ªëc
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 k·ªπ thu·∫≠t
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">N√¢ng cao</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="add-task-btn" onclick="addTask(4)">
                                <i class="fas fa-plus mr-2"></i>
                                Th√™m c√¥ng vi·ªác v√†o giai ƒëo·∫°n n√†y
                            </div>
                        </div>
                    </div>

                    <!-- Phase 5: Fruit Development -->
                    <div class="phase-card recurring-phase" data-phase="5">
                        <div class="cycle-indicator">L·∫∑p l·∫°i</div>
                        <div class="phase-header phase-5">
                            <div class="flex items-center flex-1">
                                <i class="fas fa-apple-alt mr-3 text-xl"></i>
                                <div>
                                    <h3 class="text-lg font-bold">Giai ƒëo·∫°n 5: ChƒÉm s√≥c tr√°i ph√°t tri·ªÉn</h3>
                                    <p class="text-sm opacity-90">T·ª´ tr√°i non ƒë·∫øn tr√°i g·∫ßn ch√≠n (3-4 th√°ng)</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-white hover:text-purple-200 p-2" onclick="editPhase(5)" title="Ch·ªânh s·ª≠a giai ƒëo·∫°n">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="text-white hover:text-red-200 p-2" onclick="deletePhase(5)" title="X√≥a giai ƒëo·∫°n">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="phase-content">
                            <!-- Growth Parameters for Phase 5 -->
                            <div class="phase-growth-params">
                                <h4 class="font-semibold text-blue-700 mb-3 flex items-center">
                                    <i class="fas fa-apple-alt mr-2"></i>
                                    Tham s·ªë Sinh tr∆∞·ªüng - Ph√°t tri·ªÉn tr√°i ƒë·∫øn Thu ho·∫°ch
                                </h4>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                                    <div class="param-input-group">
                                        <div class="param-label">Th·ªùi gian ph√°t tri·ªÉn:</div>
                                        <input type="number" class="param-value" value="120" min="90" max="160">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="140" min="90" max="160">
                                        <span class="param-unit">ng√†y</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">Tr·ªçng l∆∞·ª£ng tr√°i:</div>
                                        <input type="number" class="param-value" value="2" min="1" max="5" step="0.1">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="4" min="1" max="5" step="0.1">
                                        <span class="param-unit">kg</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">ƒê∆∞·ªùng k√≠nh tr√°i:</div>
                                        <input type="number" class="param-value" value="15" min="10" max="25">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="20" min="10" max="25">
                                        <span class="param-unit">cm</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">ƒê·ªô Brix:</div>
                                        <input type="number" class="param-value" value="28" min="25" max="35">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="32" min="25" max="35">
                                        <span class="param-unit">¬∞Bx</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 1 -->
                            <div class="task-card" onclick="editTask(5, 1)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">T∆∞·ªõi n∆∞·ªõc cho tr√°i ph√°t tri·ªÉn</h4>
                                        <p class="text-sm text-gray-600 mt-1">T∆∞·ªõi ƒë·ªÅu ƒë·∫∑n, tƒÉng l∆∞·ª£ng n∆∞·ªõc khi tr√°i l·ªõn</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-water mr-1"></i>150-200L/c√¢y/l·∫ßn
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-clock mr-1"></i>3-4 l·∫ßn/tu·∫ßn
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2-3 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">C∆° b·∫£n</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 2 -->
                            <div class="task-card" onclick="editTask(5, 2)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">B√≥n ph√¢n nu√¥i tr√°i</h4>
                                        <p class="text-sm text-gray-600 mt-1">B√≥n ph√¢n gi√†u kali ƒë·ªÉ tr√°i ph√°t tri·ªÉn t·ªët</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-leaf mr-1"></i>NPK 15-10-25
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-flask mr-1"></i>3-4kg/c√¢y/l·∫ßn
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Trung b√¨nh</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 3 -->
                            <div class="task-card" onclick="editTask(5, 3)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">T·ªâa tr√°i v√† ƒë√†o th·∫£i</h4>
                                        <p class="text-sm text-gray-600 mt-1">Lo·∫°i b·ªè tr√°i d·ªã h√¨nh, s√¢u b·ªánh, gi·ªØ l·∫°i 15-20 tr√°i/c√¢y</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-cut mr-1"></i>K√©o t·ªâa tr√°i
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-eye mr-1"></i>Quan s√°t k·ªπ l∆∞·ª°ng
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 k·ªπ thu·∫≠t + 1 h·ªó tr·ª£
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">N√¢ng cao</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 4 -->
                            <div class="task-card" onclick="editTask(5, 4)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">ƒê·∫∑t l∆∞·ªõi b·∫£o v·ªá tr√°i</h4>
                                        <p class="text-sm text-gray-600 mt-1">ƒê·∫∑t l∆∞·ªõi ho·∫∑c t√∫i b·∫£o v·ªá tr√°i kh·ªèi s√¢u b·ªánh v√† ƒë·ªông v·∫≠t</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-shield-alt mr-1"></i>L∆∞·ªõi/t√∫i b·∫£o v·ªá
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-tools mr-1"></i>D√¢y bu·ªôc
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2-3 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Trung b√¨nh</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 5 -->
                            <div class="task-card" onclick="editTask(5, 5)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">Gi√°m s√°t v√† ghi nh·∫≠n ph√°t tri·ªÉn</h4>
                                        <p class="text-sm text-gray-600 mt-1">Theo d√µi k√≠ch th∆∞·ªõc, m√†u s·∫Øc, t√¨nh tr·∫°ng s·ª©c kh·ªèe c·ªßa tr√°i</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-ruler mr-1"></i>Th∆∞·ªõc ƒëo
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-clipboard mr-1"></i>S·ªï ghi ch√©p
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 k·ªπ thu·∫≠t
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Trung b√¨nh</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="add-task-btn" onclick="addTask(5)">
                                <i class="fas fa-plus mr-2"></i>
                                Th√™m c√¥ng vi·ªác v√†o giai ƒëo·∫°n n√†y
                            </div>
                        </div>
                    </div>

                    <!-- Phase 6: Harvest -->
                    <div class="phase-card recurring-phase" data-phase="6">
                        <div class="cycle-indicator">L·∫∑p l·∫°i</div>
                        <div class="phase-header phase-6">
                            <div class="flex items-center flex-1">
                                <i class="fas fa-hand-holding-heart mr-3 text-xl"></i>
                                <div>
                                    <h3 class="text-lg font-bold">Giai ƒëo·∫°n 6: Thu ho·∫°ch v√† b·∫£o qu·∫£n</h3>
                                    <p class="text-sm opacity-90">Thu ho·∫°ch khi tr√°i ch√≠n (1-2 th√°ng)</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-white hover:text-yellow-200 p-2" onclick="editPhase(6)" title="Ch·ªânh s·ª≠a giai ƒëo·∫°n">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="text-white hover:text-red-200 p-2" onclick="deletePhase(6)" title="X√≥a giai ƒëo·∫°n">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="phase-content">
                            <!-- Growth Parameters for Phase 6 -->
                            <div class="phase-growth-params">
                                <h4 class="font-semibold text-blue-700 mb-3 flex items-center">
                                    <i class="fas fa-hand-holding-heart mr-2"></i>
                                    Tham s·ªë Thu ho·∫°ch
                                </h4>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                                    <div class="param-input-group">
                                        <div class="param-label">Th·ªùi gian thu ho·∫°ch:</div>
                                        <input type="number" class="param-value" value="1" min="1" max="3">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="2" min="1" max="3">
                                        <span class="param-unit">th√°ng</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">NƒÉng su·∫•t m·ª•c ti√™u:</div>
                                        <input type="number" class="param-value" value="25" min="15" max="50">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="40" min="15" max="50">
                                        <span class="param-unit">kg/c√¢y</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">Ch·∫•t l∆∞·ª£ng xu·∫•t kh·∫©u:</div>
                                        <input type="number" class="param-value" value="80" min="70" max="95">
                                        <span class="param-unit">%</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">ƒê·ªô ch√≠n thu ho·∫°ch:</div>
                                        <input type="number" class="param-value" value="75" min="70" max="85">
                                        <span class="param-unit">%</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 1 -->
                            <div class="task-card" onclick="editTask(6, 1)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">ƒê√°nh gi√° ƒë·ªô ch√≠n v√† l√™n k·∫ø ho·∫°ch thu ho·∫°ch</h4>
                                        <p class="text-sm text-gray-600 mt-1">Ki·ªÉm tra ƒë·ªô ch√≠n qua m√†u s·∫Øc, m√πi th∆°m, √¢m thanh khi g√µ</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-eye mr-1"></i>Kinh nghi·ªám ƒë√°nh gi√°
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-clipboard-list mr-1"></i>K·∫ø ho·∫°ch thu ho·∫°ch
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 chuy√™n gia
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Chuy√™n gia</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 2 -->
                            <div class="task-card" onclick="editTask(6, 2)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">Thu h√°i tr√°i c·∫©n th·∫≠n</h4>
                                        <p class="text-sm text-gray-600 mt-1">S·ª≠ d·ª•ng thang, d·ª•ng c·ª• chuy√™n d·ª•ng, tr√°nh l√†m r∆°i</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-tools mr-1"></i>Thang, m√≥c h√°i
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-box mr-1"></i>R·ªï/th√πng ƒë·ª±ng
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>3-4 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">N√¢ng cao</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 3 -->
                            <div class="task-card" onclick="editTask(6, 3)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">S∆° ch·∫ø v√† ph√¢n lo·∫°i</h4>
                                        <p class="text-sm text-gray-600 mt-1">L√†m s·∫°ch, ph√¢n lo·∫°i theo k√≠ch th∆∞·ªõc v√† ch·∫•t l∆∞·ª£ng</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-water mr-1"></i>N∆∞·ªõc r·ª≠a s·∫°ch
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-sort-amount-up mr-1"></i>Th√πng ph√¢n lo·∫°i
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2-3 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Trung b√¨nh</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 4 -->
                            <div class="task-card" onclick="editTask(6, 4)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">ƒê√≥ng g√≥i v√† b·∫£o qu·∫£n</h4>
                                        <p class="text-sm text-gray-600 mt-1">ƒê√≥ng g√≥i theo ti√™u chu·∫©n xu·∫•t kh·∫©u, b·∫£o qu·∫£n nhi·ªát ƒë·ªô th√≠ch h·ª£p</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-box mr-1"></i>H·ªôp/khay xu·∫•t kh·∫©u
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-snowflake mr-1"></i>Kho l·∫°nh 13-15¬∞C
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2-3 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">N√¢ng cao</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="add-task-btn" onclick="addTask(6)">
                                <i class="fas fa-plus mr-2"></i>
                                Th√™m c√¥ng vi·ªác v√†o giai ƒëo·∫°n n√†y
                            </div>
                        </div>
                    </div>

                    <!-- Phase 7: Post-Harvest Care -->
                    <div class="phase-card recurring-phase" data-phase="7">
                        <div class="cycle-indicator">L·∫∑p l·∫°i</div>
                        <div class="phase-header phase-7">
                            <div class="flex items-center flex-1">
                                <i class="fas fa-spa mr-3 text-xl"></i>
                                <div>
                                    <h3 class="text-lg font-bold">Giai ƒëo·∫°n 7: ChƒÉm s√≥c sau thu ho·∫°ch</h3>
                                    <p class="text-sm opacity-90">Ph·ª•c h·ªìi c√¢y sau thu ho·∫°ch (2-3 th√°ng)</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="text-white hover:text-red-200 p-2" onclick="editPhase(7)" title="Ch·ªânh s·ª≠a giai ƒëo·∫°n">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="text-white hover:text-red-200 p-2" onclick="deletePhase(7)" title="X√≥a giai ƒëo·∫°n">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="phase-content">
                            <!-- Growth Parameters for Phase 7 -->
                            <div class="phase-growth-params">
                                <h4 class="font-semibold text-blue-700 mb-3 flex items-center">
                                    <i class="fas fa-spa mr-2"></i>
                                    Tham s·ªë Ph·ª•c h·ªìi sau Thu ho·∫°ch
                                </h4>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                                    <div class="param-input-group">
                                        <div class="param-label">Th·ªùi gian ph·ª•c h·ªìi:</div>
                                        <input type="number" class="param-value" value="2" min="1" max="4">
                                        <span class="param-unit">-</span>
                                        <input type="number" class="param-value" value="3" min="1" max="4">
                                        <span class="param-unit">th√°ng</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">T·ª∑ l·ªá l·ªôc m·ªõi:</div>
                                        <input type="number" class="param-value" value="70" min="60" max="90">
                                        <span class="param-unit">%</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">T·ª∑ l·ªá c√†nh t·ªâa:</div>
                                        <input type="number" class="param-value" value="20" min="15" max="35">
                                        <span class="param-unit">%</span>
                                    </div>
                                    <div class="param-input-group">
                                        <div class="param-label">ƒê·ªô ph·ª•c h·ªìi s·ª©c kh·ªèe:</div>
                                        <input type="number" class="param-value" value="85" min="75" max="95">
                                        <span class="param-unit">%</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 1 -->
                            <div class="task-card" onclick="editTask(7, 1)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">B√≥n ph√¢n ph·ª•c h·ªìi</h4>
                                        <p class="text-sm text-gray-600 mt-1">B√≥n ph√¢n h·ªØu c∆° v√† NPK ƒë·ªÉ c√¢y ph·ª•c h·ªìi sau thu ho·∫°ch</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-seedling mr-1"></i>Ph√¢n h·ªØu c∆°
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-leaf mr-1"></i>NPK 16-16-8
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>2-3 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Trung b√¨nh</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 2 -->
                            <div class="task-card" onclick="editTask(7, 2)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">T·ªâa c√†nh t·∫°o t√°n</h4>
                                        <p class="text-sm text-gray-600 mt-1">T·ªâa b·ªè c√†nh gi√†, t·∫°o t√°n cho m√πa hoa ti·∫øp theo</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-cut mr-1"></i>K√©o t·ªâa c√†nh
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-spray-can mr-1"></i>Thu·ªëc s√°t tr√πng
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 k·ªπ thu·∫≠t + 1 h·ªó tr·ª£
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">N√¢ng cao</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 3 -->
                            <div class="task-card" onclick="editTask(7, 3)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">V·ªá sinh v∆∞·ªùn v√† ph√≤ng b·ªánh</h4>
                                        <p class="text-sm text-gray-600 mt-1">D·ªçn d·∫πp l√° r·ª•ng, c√†nh kh√¥, phun thu·ªëc ph√≤ng b·ªánh</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-broom mr-1"></i>D·ª•ng c·ª• d·ªçn d·∫πp
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-shield-alt mr-1"></i>Thu·ªëc ph√≤ng b·ªánh
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>3-4 ng∆∞·ªùi
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">C∆° b·∫£n</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Task 4 -->
                            <div class="task-card" onclick="editTask(7, 4)">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">ƒê√°nh gi√° v√† l√™n k·∫ø ho·∫°ch m√πa ti·∫øp theo</h4>
                                        <p class="text-sm text-gray-600 mt-1">ƒê√°nh gi√° k·∫øt qu·∫£ m√πa v·ª•, l√™n k·∫ø ho·∫°ch c·∫£i ti·∫øn</p>
                                        
                                        <div class="flex flex-wrap mt-3">
                                            <span class="resource-tag">
                                                <i class="fas fa-chart-line mr-1"></i>B√°o c√°o nƒÉng su·∫•t
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-clipboard-list mr-1"></i>K·∫ø ho·∫°ch c·∫£i ti·∫øn
                                            </span>
                                            <span class="resource-tag">
                                                <i class="fas fa-users mr-1"></i>1 chuy√™n gia
                                            </span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="skill-tag">Chuy√™n gia</span>
                                        <i class="fas fa-chevron-right text-gray-400"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="add-task-btn" onclick="addTask(7)">
                                <i class="fas fa-plus mr-2"></i>
                                Th√™m c√¥ng vi·ªác v√†o giai ƒëo·∫°n n√†y
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add New Phase -->
                <div class="card-modern">
                    <div class="p-6 text-center">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <button class="btn-primary" onclick="addNewPhase('setup')">
                                <i class="fas fa-plus mr-2"></i>Th√™m Giai ƒëo·∫°n Thi·∫øt l·∫≠p
                            </button>
                            <button class="btn-primary" onclick="addNewPhase('recurring')">
                                <i class="fas fa-sync-alt mr-2"></i>Th√™m Giai ƒëo·∫°n L·∫∑p l·∫°i
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="lg:col-span-1">
                <div class="sidebar-info">
                    <!-- Process Stats -->
                    <div class="card-modern mb-6">
                        <div class="p-6">
                            <h3 class="font-bold text-gray-800 mb-4">Th·ªëng k√™ Quy tr√¨nh</h3>
                            <div class="space-y-4">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600">T·ªïng giai ƒëo·∫°n:</span>
                                    <span class="font-bold text-lg text-gray-800" id="total-phases">7</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600">Thi·∫øt l·∫≠p:</span>
                                    <span class="font-bold text-lg text-indigo-600" id="setup-phases">2</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600">L·∫∑p l·∫°i:</span>
                                    <span class="font-bold text-lg text-green-600" id="recurring-phases">5</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600">T·ªïng c√¥ng vi·ªác:</span>
                                    <span class="font-bold text-lg text-blue-600" id="task-count">25</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600">Chu k·ª≥:</span>
                                    <span class="font-bold text-lg text-green-600" id="cycle-info">12 th√°ng</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Growth Parameters Summary -->
                    <div class="card-modern mb-6">
                        <div class="p-6">
                            <h3 class="font-bold text-blue-800 mb-4 flex items-center">
                                <i class="fas fa-chart-line mr-2"></i>
                                Tham s·ªë T·ªïng quan
                            </h3>
                            <div class="space-y-3">
                                <div class="text-sm">
                                    <div class="font-medium text-gray-700 mb-1">Tu·ªïi thu ho·∫°ch:</div>
                                    <div class="text-blue-600 font-semibold" id="summary-harvest-age">3-5 nƒÉm</div>
                                </div>
                                <div class="text-sm">
                                    <div class="font-medium text-gray-700 mb-1">Th·ªùi gian tr√°i:</div>
                                    <div class="text-blue-600 font-semibold" id="summary-fruit-days">120-140 ng√†y</div>
                                </div>
                                <div class="text-sm">
                                    <div class="font-medium text-gray-700 mb-1">NƒÉng su·∫•t m·ª•c ti√™u:</div>
                                    <div class="text-blue-600 font-semibold" id="summary-yield">25-40 kg/c√¢y</div>
                                </div>
                                <div class="text-sm">
                                    <div class="font-medium text-gray-700 mb-1">Kho·∫£ng c√°ch tr·ªìng:</div>
                                    <div class="text-blue-600 font-semibold" id="summary-distance">10m x 10m</div>
                                </div>
                                <div class="text-sm">
                                    <div class="font-medium text-gray-700 mb-1">M·∫≠t ƒë·ªô:</div>
                                    <div class="text-blue-600 font-semibold" id="summary-density">100 c√¢y/ha</div>
                                </div>
                                <div class="text-sm">
                                    <div class="font-medium text-gray-700 mb-1">S·ªë v·ª•/nƒÉm:</div>
                                    <div class="text-blue-600 font-semibold" id="summary-crops">1 v·ª•</div>
                                </div>
                                <div class="text-sm">
                                    <div class="font-medium text-gray-700 mb-1">Khu v·ª±c ch√≠nh:</div>
                                    <div class="text-blue-600 font-semibold" id="summary-region">T√¢y Nguy√™n</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Template Library -->
                    <div class="card-modern">
                        <div class="p-6">
                            <h3 class="font-bold text-gray-800 mb-4">Th∆∞ vi·ªán Template</h3>
                            <div class="space-y-3">
                                <div class="text-sm">
                                    <div class="font-medium text-gray-700 mb-2">Giai ƒëo·∫°n m·∫´u:</div>
                                    <div class="space-y-1">
                                        <div class="flex items-center justify-between p-2 bg-gray-50 rounded text-xs">
                                            <span>X·ª≠ l√Ω s√¢u b·ªánh</span>
                                            <button class="text-green-600 hover:text-green-800" onclick="quickAddPhase('pest-control')">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                        <div class="flex items-center justify-between p-2 bg-gray-50 rounded text-xs">
                                            <span>C·∫£i t·∫°o ƒë·∫•t</span>
                                            <button class="text-green-600 hover:text-green-800" onclick="quickAddPhase('soil-improve')">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                        <div class="flex items-center justify-between p-2 bg-gray-50 rounded text-xs">
                                            <span>V·∫≠n chuy·ªÉn</span>
                                            <button class="text-green-600 hover:text-green-800" onclick="quickAddPhase('transport')">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="text-sm border-t pt-3">
                                    <div class="font-medium text-gray-700 mb-2">Tham s·ªë theo gi·ªëng:</div>
                                    <div class="space-y-1">
                                        <div class="flex items-center justify-between p-2 bg-blue-50 rounded text-xs">
                                            <span>Ri 6 (110-130 ng√†y)</span>
                                            <button class="text-blue-600 hover:text-blue-800" onclick="loadVarietyParams('ri6')">
                                                <i class="fas fa-sync"></i>
                                            </button>
                                        </div>
                                        <div class="flex items-center justify-between p-2 bg-blue-50 rounded text-xs">
                                            <span>Monthong (140-160 ng√†y)</span>
                                            <button class="text-blue-600 hover:text-blue-800" onclick="loadVarietyParams('monthong')">
                                                <i class="fas fa-sync"></i>
                                            </button>
                                        </div>
                                        <div class="flex items-center justify-between p-2 bg-blue-50 rounded text-xs">
                                            <span>Chanee (100-120 ng√†y)</span>
                                            <button class="text-blue-600 hover:text-blue-800" onclick="loadVarietyParams('chanee')">
                                                <i class="fas fa-sync"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Task Detail Modal (Same as original) -->
    <div class="modal-overlay" id="task-modal" style="display: none;">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="form-section">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-bold text-gray-800">Chi ti·∫øt C√¥ng vi·ªác</h3>
                    <button class="text-gray-400 hover:text-gray-600" onclick="closeTaskModal()">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>

            <!-- Basic Information -->
            <div class="form-section">
                <h4 class="font-semibold text-gray-700 mb-4">Th√¥ng tin c∆° b·∫£n</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">T√™n c√¥ng vi·ªác</label>
                        <input type="text" class="form-input" id="task-name" placeholder="VD: B√≥n ph√¢n NPK">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Lo·∫°i c√¥ng vi·ªác</label>
                        <select class="form-input" id="task-type">
                            <option value="">Ch·ªçn lo·∫°i</option>
                            <option value="watering">T∆∞·ªõi n∆∞·ªõc</option>
                            <option value="fertilizing">B√≥n ph√¢n</option>
                            <option value="pruning">T·ªâa c√†nh/tr√°i</option>
                            <option value="pest-control">Ph√≤ng tr·ª´ s√¢u b·ªánh</option>
                            <option value="monitoring">Gi√°m s√°t</option>
                            <option value="harvesting">Thu ho·∫°ch</option>
                            <option value="soil-prep">Chu·∫©n b·ªã ƒë·∫•t</option>
                            <option value="planting">Tr·ªìng c√¢y</option>
                            <option value="other">Kh√°c</option>
                        </select>
                    </div>
                </div>
                
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">M√¥ t·∫£ c√¥ng vi·ªác</label>
                    <textarea class="form-input" id="task-description" rows="3" 
                            placeholder="M√¥ t·∫£ chi ti·∫øt c√°ch th·ª±c hi·ªán c√¥ng vi·ªác..."></textarea>
                </div>
                
                <!-- Phase Assignment -->
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ph√¢n lo·∫°i giai ƒëo·∫°n</label>
                    <div class="flex space-x-4">
                        <label class="flex items-center space-x-2">
                            <input type="radio" name="phase-type" value="setup" class="w-4 h-4 text-indigo-600">
                            <span class="text-sm">Thi·∫øt l·∫≠p (m·ªôt l·∫ßn)</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="radio" name="phase-type" value="recurring" class="w-4 h-4 text-green-600" checked>
                            <span class="text-sm">L·∫∑p l·∫°i (theo chu k·ª≥)</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Timing -->
            <div class="form-section">
                <h4 class="font-semibold text-gray-700 mb-4">Th·ªùi gian th·ª±c hi·ªán</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Th·ªùi ƒëi·ªÉm b·∫Øt ƒë·∫ßu</label>
                        <select class="form-input" id="task-start-timing">
                            <option value="">Ch·ªçn th·ªùi ƒëi·ªÉm</option>
                            <option value="absolute">Ng√†y c·ªë ƒë·ªãnh</option>
                            <option value="relative">Sau c√¥ng vi·ªác kh√°c</option>
                            <option value="condition">Khi c√≥ ƒëi·ªÅu ki·ªán</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Th·ªùi l∆∞·ª£ng</label>
                        <input type="number" class="form-input" id="task-duration" placeholder="2" min="1">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ƒê∆°n v·ªã th·ªùi gian</label>
                        <select class="form-input" id="task-duration-unit">
                            <option value="days">Ng√†y</option>
                            <option value="weeks" selected>Tu·∫ßn</option>
                            <option value="months">Th√°ng</option>
                        </select>
                    </div>
                </div>
                
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">T·∫ßn su·∫•t th·ª±c hi·ªán</label>
                    <div class="grid grid-cols-2 gap-4">
                        <select class="form-input" id="task-frequency">
                            <option value="once">M·ªôt l·∫ßn</option>
                            <option value="daily">H√†ng ng√†y</option>
                            <option value="weekly">H√†ng tu·∫ßn</option>
                            <option value="monthly">H√†ng th√°ng</option>
                            <option value="custom">T√πy ch·ªânh</option>
                        </select>
                        <input type="text" class="form-input" id="task-frequency-detail" placeholder="VD: M·ªói 3 ng√†y">
                    </div>
                </div>
            </div>

            <!-- Resources -->
            <div class="form-section">
                <h4 class="font-semibold text-gray-700 mb-4">V·∫≠t t∆∞ & Nh√¢n s·ª±</h4>
                
                <!-- Materials -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">V·∫≠t t∆∞ ƒë·∫ßu v√†o</label>
                    <div id="materials-list" class="space-y-2">
                        <div class="flex items-center space-x-2">
                            <input type="text" class="form-input flex-1" placeholder="T√™n v·∫≠t t∆∞" id="material-name-1">
                            <input type="text" class="form-input flex-1" placeholder="Ho·∫°t ch·∫•t khuy·∫øn c√°o" id="material-ingredient-1">
                            <input type="number" class="form-input w-24" placeholder="ƒê·ªãnh l∆∞·ª£ng" id="material-quantity-1">
                            <select class="form-input w-20" id="material-unit-1">
                                <option value="g">g</option>
                                <option value="kg">kg</option>
                                <option value="ml">ml</option>
                                <option value="lit">l√≠t</option>
                            </select>
                            <select class="form-input w-24" id="material-per-1">
                                <option value="tree">c√¢y</option>
                                <option value="animal">con</option>
                                <option value="m2">m¬≤</option>
                                <option value="ha">ha</option>
                            </select>
                            <button class="btn-secondary" onclick="removeMaterial(this)">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <button class="btn-secondary mt-2" onclick="addMaterial()">
                        <i class="fas fa-plus mr-2"></i>Th√™m v·∫≠t t∆∞
                    </button>
                </div>
                
                <!-- Tools -->
                <div class="mb-4">
                    <div class="flex items-center justify-between mb-2">
                        <label class="block text-sm font-medium text-gray-700">C√¥ng c·ª• c·∫ßn thi·∫øt</label>
                        <button class="btn-secondary text-xs" onclick="addCustomTool()">
                            <i class="fas fa-plus mr-1"></i>Th√™m c√¥ng c·ª•
                        </button>
                    </div>
                    <div class="flex flex-wrap gap-2" id="tools-list">
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="w-4 h-4 text-green-600" value="hose">
                            <span class="text-sm">·ªêng n∆∞·ªõc</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="w-4 h-4 text-green-600" value="sprayer">
                            <span class="text-sm">M√°y phun</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="w-4 h-4 text-green-600" value="ladder">
                            <span class="text-sm">Thang</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="w-4 h-4 text-green-600" value="scissors">
                            <span class="text-sm">K√©o t·ªâa</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="w-4 h-4 text-green-600" value="gloves">
                            <span class="text-sm">GƒÉng tay</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="w-4 h-4 text-green-600" value="protective">
                            <span class="text-sm">ƒê·ªì b·∫£o h·ªô</span>
                        </label>
                    </div>
                </div>
                
                <!-- Labor -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">S·ªë ng∆∞·ªùi c·∫ßn</label>
                        <input type="number" class="form-input" id="task-workers" placeholder="2" min="1">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">K·ªπ nƒÉng y√™u c·∫ßu</label>
                        <select class="form-input" id="task-skill">
                            <option value="basic">C∆° b·∫£n</option>
                            <option value="intermediate">Trung b√¨nh</option>
                            <option value="advanced">N√¢ng cao</option>
                            <option value="expert">Chuy√™n gia</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Growth Parameters in Task -->
            <div class="form-section">
                <h4 class="font-semibold text-gray-700 mb-4">Tham s·ªë Sinh tr∆∞·ªüng li√™n quan</h4>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">·∫¢nh h∆∞·ªüng ƒë·∫øn tham s·ªë</label>
                        <select class="form-input" id="affected-parameters" multiple>
                            <option value="growth-rate">T·ªëc ƒë·ªô sinh tr∆∞·ªüng</option>
                            <option value="fruit-size">K√≠ch th∆∞·ªõc tr√°i</option>
                            <option value="fruit-quality">Ch·∫•t l∆∞·ª£ng tr√°i</option>
                            <option value="yield">NƒÉng su·∫•t</option>
                            <option value="disease-resistance">Kh√°ng b·ªánh</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Timing theo tham s·ªë</label>
                        <div class="flex items-center space-x-2">
                            <input type="number" class="form-input w-20" placeholder="Ng√†y" id="timing-days">
                            <span class="text-sm text-gray-600">t·ª´ b·∫Øt ƒë·∫ßu giai ƒëo·∫°n</span>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">ƒêi·ªÅu ki·ªán k√≠ch ho·∫°t t·ª± ƒë·ªông</label>
                    <textarea class="form-input" rows="2" placeholder="VD: Khi tr√°i ƒë·∫°t 80% k√≠ch th∆∞·ªõc, ho·∫∑c sau 120 ng√†y t·ª´ ƒë·∫≠u tr√°i..."></textarea>
                </div>
            </div>

            <!-- Conditions & Alerts -->
            <div class="form-section">
                <h4 class="font-semibold text-gray-700 mb-4">ƒêi·ªÅu ki·ªán & C·∫£nh b√°o</h4>
                
                <!-- Dependencies -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">C√¥ng vi·ªác ho√†n th√†nh tr∆∞·ªõc ƒë√≥</label>
                    <select class="form-input" id="prerequisite-task">
                        <option value="">Kh√¥ng c√≥</option>
                        <option value="task-1">Kh·∫£o s√°t v√† ph√¢n t√≠ch ƒë·∫•t</option>
                        <option value="task-2">L√†m ƒë·∫•t v√† c·∫£i t·∫°o</option>
                        <option value="task-3">T·∫°o h·ªë tr·ªìng ti√™u chu·∫©n</option>
                    </select>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">C√¥ng vi·ªác ti·∫øp theo</label>
                    <select class="form-input" id="next-task">
                        <option value="">Kh√¥ng c√≥</option>
                        <option value="task-4">Ch·ªçn v√† tr·ªìng c√¢y gi·ªëng</option>
                        <option value="task-5">Thi·∫øt l·∫≠p h·ªá th·ªëng t∆∞·ªõi</option>
                        <option value="task-6">D·ª±ng c·ªçc ch·ªëng ƒë·ª°</option>
                    </select>
                </div>
                
                <!-- Trigger Conditions -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">ƒêi·ªÅu ki·ªán k√≠ch ho·∫°t</label>
                    <div id="conditions-list" class="space-y-2">
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-2 flex-1">
                                    <select class="form-input w-32">
                                        <option value="weather">Th·ªùi ti·∫øt</option>
                                        <option value="soil">ƒê·∫•t</option>
                                        <option value="plant">C√¢y tr·ªìng</option>
                                        <option value="time">Th·ªùi gian</option>
                                        <option value="growth">Tham s·ªë sinh tr∆∞·ªüng</option>
                                    </select>
                                    <select class="form-input w-24">
                                        <option value="=">=</option>
                                        <option value=">">&gt;</option>
                                        <option value="<">&lt;</option>
                                    </select>
                                    <input type="text" class="form-input flex-1" placeholder="Gi√° tr·ªã">
                                </div>
                                <button class="btn-secondary ml-2" onclick="removeCondition(this)">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <button class="btn-secondary mt-2" onclick="addCondition()">
                        <i class="fas fa-plus mr-2"></i>Th√™m ƒëi·ªÅu ki·ªán
                    </button>
                </div>
                
                <!-- Alerts -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">C·∫£nh b√°o & Nh·∫Øc nh·ªü</label>
                    <div id="alerts-list" class="space-y-2">
                        <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-2 flex-1">
                                    <select class="form-input w-32">
                                        <option value="before">Tr∆∞·ªõc khi</option>
                                        <option value="during">Trong khi</option>
                                        <option value="after">Sau khi</option>
                                    </select>
                                    <input type="number" class="form-input w-20" placeholder="1">
                                    <select class="form-input w-24">
                                        <option value="days">ng√†y</option>
                                        <option value="hours">gi·ªù</option>
                                    </select>
                                    <input type="text" class="form-input flex-1" placeholder="N·ªôi dung c·∫£nh b√°o">
                                </div>
                                <button class="btn-secondary ml-2" onclick="removeAlert(this)">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <button class="btn-secondary mt-2" onclick="addAlert()">
                        <i class="fas fa-plus mr-2"></i>Th√™m c·∫£nh b√°o
                    </button>
                </div>
            </div>

            <!-- Instructions -->
            <div class="form-section">
                <h4 class="font-semibold text-gray-700 mb-4">H∆∞·ªõng d·∫´n th·ª±c hi·ªán</h4>
                
                <!-- Instructions Library -->
                <div class="mb-4">
                    <div class="flex items-center justify-between mb-2">
                        <label class="block text-sm font-medium text-gray-700">Th∆∞ vi·ªán m√¥ t·∫£, h∆∞·ªõng d·∫´n</label>
                        <button class="btn-secondary text-xs" onclick="openInstructionLibrary()">
                            <i class="fas fa-book-open mr-1"></i>Th∆∞ vi·ªán
                        </button>
                    </div>
                    
                    <div class="file-upload-area" onclick="triggerFileUpload()" ondragover="handleDragOver(event)" ondrop="handleFileDrop(event)">
                        <i class="fas fa-cloud-upload-alt text-2xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-600 mb-2">ƒê√≠nh k√®m t√†i li·ªáu, h√¨nh ·∫£nh, link video h∆∞·ªõng d·∫´n</p>
                        <p class="text-xs text-gray-500">K√©o th·∫£ file v√†o ƒë√¢y ho·∫∑c nh·∫•p ƒë·ªÉ ch·ªçn</p>
                        <input type="file" multiple accept=".pdf,.doc,.docx,.png,.jpg,.jpeg,.mp4,.avi" style="display: none;" id="file-upload">
                    </div>
                    
                    <div id="uploaded-files" class="mt-2 space-y-1">
                        <!-- Uploaded files will appear here -->
                    </div>
                    
                    <div class="mt-2">
                        <input type="url" class="form-input" placeholder="Ho·∫∑c nh·∫≠p link video h∆∞·ªõng d·∫´n (YouTube, Vimeo...)" id="video-link">
                    </div>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">C√°c b∆∞·ªõc th·ª±c hi·ªán</label>
                    <textarea class="form-input" id="task-instructions" rows="4" 
                            placeholder="1. Chu·∫©n b·ªã d·ª•ng c·ª•&#10;2. Ki·ªÉm tra th·ªùi ti·∫øt&#10;3. Th·ª±c hi·ªán c√¥ng vi·ªác&#10;4. Ghi nh·∫≠n k·∫øt qu·∫£"></textarea>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">L∆∞u √Ω an to√†n</label>
                        <textarea class="form-input" id="task-safety" rows="2" 
                                placeholder="ƒêeo gƒÉng tay, m·∫∑c qu·∫ßn √°o b·∫£o h·ªô..."></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ph∆∞∆°ng ph√°p ki·ªÉm tra</label>
                        <textarea class="form-input" id="task-inspection" rows="2" 
                                placeholder="Quan s√°t tr·ª±c ti·∫øp, ƒëo l∆∞·ªùng, test..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Completion Criteria & Evaluation -->
            <div class="form-section">
                <h4 class="font-semibold text-gray-700 mb-4">Ti√™u chu·∫©n ho√†n th√†nh, ƒê√°nh gi√° v√† B√°o c√°o</h4>
                
                <!-- Evaluation Criteria -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ti√™u ch√≠ ƒë√°nh gi√°</label>
                    <div id="evaluation-criteria" class="space-y-2">
                        <div class="criteria-item">
                            <div class="checklist-item">
                                <input type="checkbox" class="w-4 h-4 text-green-600 mr-2">
                                <input type="text" class="form-input flex-1 mr-2" placeholder="T√™n ti√™u ch√≠ ƒë√°nh gi√°" value="T·ª∑ l·ªá c√¢y s·ªëng">
                                <input type="number" class="form-input w-20 mr-2" placeholder="ƒê·ªãnh l∆∞·ª£ng" value="95">
                                <select class="form-input w-16">
                                    <option value="%">%</option>
                                    <option value="c√¢y">c√¢y</option>
                                    <option value="kg">kg</option>
                                    <option value="m¬≤">m¬≤</option>
                                </select>
                                <button class="btn-secondary ml-2" onclick="removeCriteria(this)">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-2 mt-2">
                                <div>
                                    <label class="text-xs text-gray-600">Ti√™u ch√≠ ƒê·∫°t:</label>
                                    <input type="text" class="form-input text-xs" placeholder="‚â• 95%" value="‚â• 95%">
                                </div>
                                <div>
                                    <label class="text-xs text-gray-600">Ti√™u ch√≠ Kh√¥ng ƒë·∫°t:</label>
                                    <input type="text" class="form-input text-xs" placeholder="< 95%" value="< 95%">
                                </div>
                            </div>
                        </div>
                        
                        <div class="criteria-item">
                            <div class="checklist-item">
                                <input type="checkbox" class="w-4 h-4 text-green-600 mr-2">
                                <input type="text" class="form-input flex-1 mr-2" placeholder="T√™n ti√™u ch√≠ ƒë√°nh gi√°" value="ƒê·ªô ·∫©m ƒë·∫•t">
                                <input type="number" class="form-input w-20 mr-2" placeholder="ƒê·ªãnh l∆∞·ª£ng" value="75">
                                <select class="form-input w-16">
                                    <option value="%">%</option>
                                    <option value="c√¢y">c√¢y</option>
                                    <option value="kg">kg</option>
                                    <option value="m¬≤">m¬≤</option>
                                </select>
                                <button class="btn-secondary ml-2" onclick="removeCriteria(this)">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-2 mt-2">
                                <div>
                                    <label class="text-xs text-gray-600">Ti√™u ch√≠ ƒê·∫°t:</label>
                                    <input type="text" class="form-input text-xs" placeholder="70-80%" value="70-80%">
                                </div>
                                <div>
                                    <label class="text-xs text-gray-600">Ti√™u ch√≠ Kh√¥ng ƒë·∫°t:</label>
                                    <input type="text" class="form-input text-xs" placeholder="< 70% ho·∫∑c > 80%" value="< 70% ho·∫∑c > 80%">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn-secondary mt-2" onclick="addEvaluationCriteria()">
                        <i class="fas fa-plus mr-2"></i>Th√™m ti√™u ch√≠ ƒë√°nh gi√°
                    </button>
                </div>
                
                <!-- Completion Actions -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">H√†nh ƒë·ªông khi ƒê·∫°t</label>
                        <select class="form-input mb-2">
                            <option value="continue">Ti·∫øp t·ª•c c√¥ng vi·ªác ti·∫øp theo</option>
                            <option value="notify">Th√¥ng b√°o ho√†n th√†nh</option>
                            <option value="record">Ghi nh·∫≠n d·ªØ li·ªáu</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">H√†nh ƒë·ªông khi Kh√¥ng ƒë·∫°t</label>
                        <select class="form-input mb-2">
                            <option value="repeat">Th·ª±c hi·ªán l·∫°i</option>
                            <option value="adjust">ƒêi·ªÅu ch·ªânh quy tr√¨nh</option>
                            <option value="expert">T∆∞ v·∫•n chuy√™n gia</option>
                        </select>
                    </div>
                </div>
                
                <!-- Report Template -->
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">M·∫´u b√°o c√°o</label>
                    <textarea class="form-input" rows="3" 
                            placeholder="Template b√°o c√°o k·∫øt qu·∫£ th·ª±c hi·ªán c√¥ng vi·ªác...">B√°o c√°o th·ª±c hi·ªán: [T√™n c√¥ng vi·ªác]
Th·ªùi gian: [Ng√†y th·ª±c hi·ªán]
K·∫øt qu·∫£ ƒë·∫°t ƒë∆∞·ª£c: [C√°c ti√™u ch√≠ ƒë√£ ho√†n th√†nh]
V·∫•n ƒë·ªÅ ph√°t sinh: [N·∫øu c√≥]
Khuy·∫øn ngh·ªã: [ƒêi·ªÅu ch·ªânh cho l·∫ßn sau]</textarea>
                </div>
            </div>

            <!-- Actions -->
            <div class="form-section">
                <div class="flex justify-between">
                    <button class="btn-secondary" onclick="closeTaskModal()">
                        <i class="fas fa-times mr-2"></i>H·ªßy
                    </button>
                    <div class="space-x-2">
                        <button class="btn-secondary" onclick="duplicateTask()">
                            <i class="fas fa-copy mr-2"></i>Sao ch√©p
                        </button>
                        <button class="btn-primary" onclick="saveTask()">
                            <i class="fas fa-save mr-2"></i>L∆∞u c√¥ng vi·ªác
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentPhase = null;
        let currentTask = null;

        // Planting density data
        const plantingDistanceData = {
            '8x8': { x: 8, y: 8, description: 'Ti√™u chu·∫©n cho v√πng ƒë·∫•t h·∫°n ch·∫ø' },
            '9x9': { x: 9, y: 9, description: 'C√¢n b·∫±ng gi·ªØa m·∫≠t ƒë·ªô v√† kh√¥ng gian' },
            '10x10': { x: 10, y: 10, description: 'Tho√°ng ƒë√£ng, ph√π h·ª£p ƒë·∫•t t·ªët' },
            '8x10': { x: 8, y: 10, description: 'T·ªëi ∆∞u h√≥a s·ª≠ d·ª•ng ƒë·∫•t' },
            'intercrop': { x: 6, y: 8, description: 'K·∫øt h·ª£p v·ªõi c√¢y ng·∫Øn ng√†y' },
            'intensive': { x: 7, y: 7, description: 'Th√¢m canh, c·∫ßn chƒÉm s√≥c t·ªët' }
        };

        const plantingRecommendations = {
            'monoculture': {
                '8x8': 'M·∫≠t ƒë·ªô cao, ph√π h·ª£p ƒë·∫•t t·ªët, c·∫ßn qu·∫£n l√Ω t√°n l√° t·ªët',
                '9x9': 'C√¢n b·∫±ng t·ªët, ph√π h·ª£p h·∫ßu h·∫øt ƒëi·ªÅu ki·ªán',
                '10x10': 'Tho√°ng ƒë√£ng, ch·∫•t l∆∞·ª£ng tr√°i t·ªët, d·ªÖ chƒÉm s√≥c',
                'intercrop': 'Kh√¥ng khuy·∫øn kh√≠ch cho ƒë∆°n canh',
                'intensive': 'C·∫ßn k·ªπ thu·∫≠t cao, ƒë·∫ßu t∆∞ nhi·ªÅu'
            },
            'intercrop': {
                '8x8': 'C√≥ th·ªÉ xen l√∫a, ƒë·∫≠u trong 3-4 nƒÉm ƒë·∫ßu',
                '10x10': 'L√Ω t∆∞·ªüng cho xen c√† ph√™ ho·∫∑c ti√™u',
                'intercrop': 'T·ªëi ∆∞u cho xen canh, c√¢y ch√≠nh + c√¢y ph·ª•',
                'intensive': 'Kh√≥ xen canh do m·∫≠t ƒë·ªô cao'
            },
            'agroforestry': {
                '10x10': 'Ph√π h·ª£p k·∫øt h·ª£p v·ªõi c√¢y g·ªó',
                'intercrop': 'T·ªët cho h·ªá th·ªëng n√¥ng l√¢m',
                'intensive': 'Kh√¥ng ph√π h·ª£p cho n√¥ng l√¢m k·∫øt h·ª£p'
            },
            'organic': {
                '9x9': 'C√¢n b·∫±ng cho canh t√°c h·ªØu c∆°',
                '10x10': 'L√Ω t∆∞·ªüng cho h·ªØu c∆°, d·ªÖ ki·ªÉm so√°t s√¢u b·ªánh',
                'intensive': 'Kh√≥ qu·∫£n l√Ω h·ªØu c∆° v·ªõi m·∫≠t ƒë·ªô cao'
            }
        };

        // Growth parameters data
        const growthParametersData = {
            varieties: {
                'dona-thai': {
                    name: 'Dona - Th√°i',
                    harvestAge: { start: 3, stable: 5 },
                    fruitDays: { min: 120, max: 140 },
                    yield: { min: 25, max: 40 },
                    brix: { min: 28, max: 32 }
                },
                'ri6': {
                    name: 'Ri 6',
                    harvestAge: { start: 3, stable: 4 },
                    fruitDays: { min: 110, max: 130 },
                    yield: { min: 20, max: 35 },
                    brix: { min: 26, max: 30 }
                },
                'monthong': {
                    name: 'Monthong',
                    harvestAge: { start: 4, stable: 6 },
                    fruitDays: { min: 140, max: 160 },
                    yield: { min: 30, max: 50 },
                    brix: { min: 30, max: 35 }
                },
                'chanee': {
                    name: 'Chanee',
                    harvestAge: { start: 3, stable: 5 },
                    fruitDays: { min: 100, max: 120 },
                    yield: { min: 22, max: 38 },
                    brix: { min: 27, max: 31 }
                }
            },
            regions: {
                'tay-nguyen': {
                    name: 'T√¢y Nguy√™n',
                    avgTemp: 26,
                    avgHumidity: 75,
                    avgRainfall: 1800,
                    altitude: 500
                },
                'dong-nam-bo': {
                    name: 'ƒê√¥ng Nam B·ªô',
                    avgTemp: 28,
                    avgHumidity: 80,
                    avgRainfall: 2200,
                    altitude: 50
                },
                'tay-nam-bo': {
                    name: 'T√¢y Nam B·ªô',
                    avgTemp: 29,
                    avgHumidity: 85,
                    avgRainfall: 1600,
                    altitude: 10
                },
                'mien-trung': {
                    name: 'Mi·ªÅn Trung',
                    avgTemp: 25,
                    avgHumidity: 70,
                    avgRainfall: 2000,
                    altitude: 200
                },
                'mien-bac': {
                    name: 'Mi·ªÅn B·∫Øc',
                    avgTemp: 23,
                    avgHumidity: 78,
                    avgRainfall: 1500,
                    altitude: 100
                }
            }
        };

        // Calculate planting density
        function calculateDensity() {
            const distanceSelect = document.getElementById('planting-distance');
            const customDistanceGroup = document.getElementById('custom-distance-group');
            const densityInput = document.getElementById('planting-density');
            const areaPerTreeInput = document.getElementById('area-per-tree');
            const treesPer1000Input = document.getElementById('trees-per-1000m2');
            
            let distanceX, distanceY;
            
            if (distanceSelect.value === 'custom') {
                customDistanceGroup.style.display = 'block';
                distanceX = parseFloat(document.getElementById('custom-distance-x').value) || 10;
                distanceY = parseFloat(document.getElementById('custom-distance-y').value) || 10;
            } else {
                customDistanceGroup.style.display = 'none';
                const distanceData = plantingDistanceData[distanceSelect.value];
                if (distanceData) {
                    distanceX = distanceData.x;
                    distanceY = distanceData.y;
                } else {
                    distanceX = distanceY = 10; // default
                }
            }
            
            // Calculate area per tree (m¬≤)
            const areaPerTree = distanceX * distanceY;
            
            // Calculate density (trees per hectare)
            const density = Math.round(10000 / areaPerTree);
            
            // Calculate trees per 1000m¬≤
            const treesPer1000 = Math.round(1000 / areaPerTree);
            
            // Update inputs
            densityInput.value = density;
            areaPerTreeInput.value = areaPerTree;
            treesPer1000Input.value = treesPer1000;
            
            // Update total trees calculation
            calculateTotalTrees();
            
            // Update recommendations
            updatePlantingRecommendations();
            
            // Update summary
            updateGrowthSummary();
        }

        // Calculate total trees for given area
        function calculateTotalTrees() {
            const areaInput = document.getElementById('area-input');
            const totalTreesInput = document.getElementById('total-trees');
            const spareTreesInput = document.getElementById('spare-trees');
            const densityInput = document.getElementById('planting-density');
            
            const area = parseFloat(areaInput.value) || 1;
            const density = parseInt(densityInput.value) || 100;
            
            const totalTrees = Math.round(area * density);
            const spareTrees = Math.round(totalTrees * 1.05); // 5% spare
            
            totalTreesInput.value = totalTrees;
            spareTreesInput.value = spareTrees;
        }

        // Update planting recommendations
        function updatePlantingRecommendations() {
            const distanceSelect = document.getElementById('planting-distance');
            const plantingTypeSelect = document.getElementById('planting-type');
            const recommendationsSpan = document.getElementById('planting-recommendations');
            
            const distance = distanceSelect.value;
            const plantingType = plantingTypeSelect.value;
            
            let recommendation = '';
            
            if (plantingRecommendations[plantingType] && plantingRecommendations[plantingType][distance]) {
                recommendation = plantingRecommendations[plantingType][distance];
            } else {
                // Default recommendations
                const distanceData = plantingDistanceData[distance];
                if (distanceData) {
                    recommendation = distanceData.description;
                } else {
                    recommendation = 'Kho·∫£ng c√°ch t√πy ch·ªânh - vui l√≤ng tham kh·∫£o chuy√™n gia k·ªπ thu·∫≠t.';
                }
            }
            
            // Add density-based recommendations
            const density = parseInt(document.getElementById('planting-density').value) || 100;
            if (density > 150) {
                recommendation += ' ‚ö†Ô∏è M·∫≠t ƒë·ªô cao - c·∫ßn qu·∫£n l√Ω t√°n l√° v√† dinh d∆∞·ª°ng t·ªët.';
            } else if (density < 80) {
                recommendation += ' üí° M·∫≠t ƒë·ªô th·∫•p - c√≥ th·ªÉ xen canh hi·ªáu qu·∫£.';
            }
            
            recommendationsSpan.textContent = recommendation;
        }

        // Update production objects based on type
        function updateProductionObjects() {
            const productionType = document.getElementById('production-type').value;
            const specificObjectSelect = document.getElementById('specific-object');
            
            const objects = {
                'crops': [
                    { value: 'durian', text: 'S·∫ßu ri√™ng' },
                    { value: 'mango', text: 'Xo√†i' },
                    { value: 'avocado', text: 'B∆°' },
                    { value: 'coffee', text: 'C√† ph√™' },
                    { value: 'pepper', text: 'Ti√™u' }
                ],
                'livestock': [
                    { value: 'cattle', text: 'B√≤' },
                    { value: 'pig', text: 'Heo' },
                    { value: 'chicken', text: 'G√†' },
                    { value: 'goat', text: 'D√™' }
                ],
                'aquaculture': [
                    { value: 'catfish', text: 'C√° tra' },
                    { value: 'tilapia', text: 'C√° r√¥ phi' },
                    { value: 'shrimp', text: 'T√¥m' },
                    { value: 'crab', text: 'Cua' }
                ],
                'integrated': [
                    { value: 'vac', text: 'VAC (V∆∞·ªùn-Ao-Chu·ªìng)' },
                    { value: 'eco-farm', text: 'N√¥ng tr·∫°i sinh th√°i' }
                ]
            };
            
            specificObjectSelect.innerHTML = '';
            const typeObjects = objects[productionType] || objects.crops;
            typeObjects.forEach(obj => {
                const option = new Option(obj.text, obj.value);
                specificObjectSelect.add(option);
            });
            
            updateVarieties();
        }

        // Update varieties based on specific object
        function updateVarieties() {
            const specificObject = document.getElementById('specific-object').value;
            const varietySelect = document.getElementById('variety');
            
            const varieties = {
                'durian': [
                    { value: 'dona-thai', text: 'Dona - Th√°i' },
                    { value: 'ri6', text: 'Ri 6' },
                    { value: 'monthong', text: 'Monthong' },
                    { value: 'chanee', text: 'Chanee' }
                ],
                'mango': [
                    { value: 'catchu', text: 'C√°t Chu' },
                    { value: 'catngu', text: 'C√°t Ng·ª±' },
                    { value: 'kensington', text: 'Kensington' }
                ],
                'coffee': [
                    { value: 'arabica', text: 'Arabica' },
                    { value: 'robusta', text: 'Robusta' }
                ]
            };
            
            varietySelect.innerHTML = '';
            const objectVarieties = varieties[specificObject] || [{ value: 'default', text: 'Gi·ªëng ph·ªï bi·∫øn' }];
            objectVarieties.forEach(variety => {
                const option = new Option(variety.text, variety.value);
                varietySelect.add(option);
            });
            
            updateGrowthParameters();
        }

        // Update growth parameters
        function updateGrowthParameters() {
            const variety = document.getElementById('variety').value;
            const region = document.getElementById('main-region').value;
            
            // Update variety name
            const growthVariety = document.getElementById('growth-variety');
            if (growthVariety && growthParametersData.varieties[variety]) {
                growthVariety.value = growthParametersData.varieties[variety].name;
            }
            
            // Update harvest ages
            if (growthParametersData.varieties[variety]) {
                const varietyData = growthParametersData.varieties[variety];
                document.getElementById('harvest-age-start').value = varietyData.harvestAge.start;
                document.getElementById('stable-age').value = varietyData.harvestAge.stable;
                document.getElementById('fruit-growth-days-min').value = varietyData.fruitDays.min;
                document.getElementById('fruit-growth-days-max').value = varietyData.fruitDays.max;
            }
            
            // Update region parameters
            updateRegionParameters();
            
            // Update summary
            updateGrowthSummary();
        }

        // Update region parameters
        function updateRegionParameters() {
            const region = document.getElementById('main-region').value;
            
            if (growthParametersData.regions[region]) {
                const regionData = growthParametersData.regions[region];
                document.getElementById('avg-temp').value = regionData.avgTemp;
                document.getElementById('avg-humidity').value = regionData.avgHumidity;
                document.getElementById('avg-rainfall').value = regionData.avgRainfall;
                document.getElementById('altitude').value = regionData.altitude;
            }
        }

        // Update growth summary
        function updateGrowthSummary() {
            const harvestAgeStart = document.getElementById('harvest-age-start').value;
            const stableAge = document.getElementById('stable-age').value;
            const fruitDaysMin = document.getElementById('fruit-growth-days-min').value;
            const fruitDaysMax = document.getElementById('fruit-growth-days-max').value;
            const cropsPerYear = document.getElementById('crops-per-year').value;
            const region = document.getElementById('main-region').value;
            
            document.getElementById('summary-harvest-age').textContent = `${harvestAgeStart}-${stableAge} nƒÉm`;
            document.getElementById('summary-fruit-days').textContent = `${fruitDaysMin}-${fruitDaysMax} ng√†y`;
            document.getElementById('summary-crops').textContent = `${cropsPerYear} v·ª•`;
            
            if (growthParametersData.regions[region]) {
                document.getElementById('summary-region').textContent = growthParametersData.regions[region].name;
            }
            
            // Update yield from variety data
            const variety = document.getElementById('variety').value;
            if (growthParametersData.varieties[variety]) {
                const varietyData = growthParametersData.varieties[variety];
                document.getElementById('summary-yield').textContent = `${varietyData.yield.min}-${varietyData.yield.max} kg/c√¢y`;
            }
            
            // Update planting density info
            const plantingDistance = document.getElementById('planting-distance');
            const plantingDensity = document.getElementById('planting-density');
            
            if (plantingDistance && plantingDensity) {
                const distanceText = plantingDistance.options[plantingDistance.selectedIndex].text;
                const densityValue = plantingDensity.value;
                
                document.getElementById('summary-distance').textContent = distanceText.split(' ')[0]; // Get just the distance part
                document.getElementById('summary-density').textContent = `${densityValue} c√¢y/ha`;
            }
        }

        // Load variety parameters
        function loadVarietyParams(varietyKey) {
            document.getElementById('variety').value = varietyKey;
            updateGrowthParameters();
            alert(`ƒê√£ t·∫£i tham s·ªë cho gi·ªëng ${growthParametersData.varieties[varietyKey].name}\n\nC√°c th√¥ng s·ªë ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t t·ª± ƒë·ªông.`);
        }

        // Update cycle type
        function updateCycleType() {
            const cycleType = document.getElementById('cycle-type').value;
            const cycleInfo = document.getElementById('cycle-info');
            
            const cycleTexts = {
                'annual': '12 th√°ng',
                'seasonal': '6 th√°ng',
                'quarterly': '3 th√°ng', 
                'monthly': '1 th√°ng',
                'breeding': 'Theo l·ª©a',
                'custom': 'T√πy ch·ªânh'
            };
            
            cycleInfo.textContent = cycleTexts[cycleType] || '12 th√°ng';
        }

        // Toggle recurring cycle
        function toggleRecurringCycle() {
            const recurringPhases = document.querySelectorAll('.recurring-phase');
            const isEnabled = event.target.checked;
            
            recurringPhases.forEach(phase => {
                phase.style.opacity = isEnabled ? '1' : '0.5';
            });
            
            if (isEnabled) {
                alert('ƒê√£ k√≠ch ho·∫°t chu k·ª≥ l·∫∑p l·∫°i\n\nC√°c giai ƒëo·∫°n t·ª´ "Chu·∫©n b·ªã ra hoa" s·∫Ω l·∫∑p l·∫°i theo chu k·ª≥ ƒë√£ thi·∫øt l·∫≠p.');
            } else {
                alert('ƒê√£ t·∫Øt chu k·ª≥ l·∫∑p l·∫°i\n\nQuy tr√¨nh s·∫Ω ch·ªâ th·ª±c hi·ªán m·ªôt l·∫ßn.');
            }
        }

        // Material management
        function addMaterial() {
            const materialsList = document.getElementById('materials-list');
            const newMaterial = document.createElement('div');
            newMaterial.className = 'flex items-center space-x-2';
            newMaterial.innerHTML = `
                <input type="text" class="form-input flex-1" placeholder="T√™n v·∫≠t t∆∞">
                <input type="text" class="form-input flex-1" placeholder="Ho·∫°t ch·∫•t khuy·∫øn c√°o">
                <input type="number" class="form-input w-24" placeholder="ƒê·ªãnh l∆∞·ª£ng">
                <select class="form-input w-20">
                    <option value="g">g</option>
                    <option value="kg">kg</option>
                    <option value="ml">ml</option>
                    <option value="lit">l√≠t</option>
                </select>
                <select class="form-input w-24">
                    <option value="tree">c√¢y</option>
                    <option value="animal">con</option>
                    <option value="m2">m¬≤</option>
                    <option value="ha">ha</option>
                </select>
                <button class="btn-secondary" onclick="removeMaterial(this)">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            materialsList.appendChild(newMaterial);
        }

        function removeMaterial(button) {
            button.parentElement.remove();
        }

        // Custom tool management
        function addCustomTool() {
            const toolName = prompt('Nh·∫≠p t√™n c√¥ng c·ª•:');
            if (toolName) {
                const toolsList = document.getElementById('tools-list');
                const newTool = document.createElement('label');
                newTool.className = 'flex items-center space-x-2';
                newTool.innerHTML = `
                    <input type="checkbox" class="w-4 h-4 text-green-600" value="${toolName.toLowerCase()}">
                    <span class="text-sm">${toolName}</span>
                `;
                toolsList.appendChild(newTool);
            }
        }

        // Condition management
        function addCondition() {
            const conditionsList = document.getElementById('conditions-list');
            const newCondition = document.createElement('div');
            newCondition.className = 'bg-yellow-50 border border-yellow-200 rounded-lg p-3';
            newCondition.innerHTML = `
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2 flex-1">
                        <select class="form-input w-32">
                            <option value="weather">Th·ªùi ti·∫øt</option>
                            <option value="soil">ƒê·∫•t</option>
                            <option value="plant">C√¢y tr·ªìng</option>
                            <option value="time">Th·ªùi gian</option>
                            <option value="growth">Tham s·ªë sinh tr∆∞·ªüng</option>
                        </select>
                        <select class="form-input w-24">
                            <option value="=">=</option>
                            <option value=">">&gt;</option>
                            <option value="<">&lt;</option>
                        </select>
                        <input type="text" class="form-input flex-1" placeholder="Gi√° tr·ªã">
                    </div>
                    <button class="btn-secondary ml-2" onclick="removeCondition(this)">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            conditionsList.appendChild(newCondition);
        }

        function removeCondition(button) {
            button.closest('.bg-yellow-50').remove();
        }

        // Alert management
        function addAlert() {
            const alertsList = document.getElementById('alerts-list');
            const newAlert = document.createElement('div');
            newAlert.className = 'bg-red-50 border border-red-200 rounded-lg p-3';
            newAlert.innerHTML = `
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2 flex-1">
                        <select class="form-input w-32">
                            <option value="before">Tr∆∞·ªõc khi</option>
                            <option value="during">Trong khi</option>
                            <option value="after">Sau khi</option>
                        </select>
                        <input type="number" class="form-input w-20" placeholder="1">
                        <select class="form-input w-24">
                            <option value="days">ng√†y</option>
                            <option value="hours">gi·ªù</option>
                        </select>
                        <input type="text" class="form-input flex-1" placeholder="N·ªôi dung c·∫£nh b√°o">
                    </div>
                    <button class="btn-secondary ml-2" onclick="removeAlert(this)">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            alertsList.appendChild(newAlert);
        }

        function removeAlert(button) {
            button.closest('.bg-red-50').remove();
        }

        // Evaluation criteria management
        function addEvaluationCriteria() {
            const criteriaContainer = document.getElementById('evaluation-criteria');
            const newCriteria = document.createElement('div');
            newCriteria.className = 'criteria-item';
            newCriteria.innerHTML = `
                <div class="checklist-item">
                    <input type="checkbox" class="w-4 h-4 text-green-600 mr-2">
                    <input type="text" class="form-input flex-1 mr-2" placeholder="T√™n ti√™u ch√≠ ƒë√°nh gi√°">
                    <input type="number" class="form-input w-20 mr-2" placeholder="ƒê·ªãnh l∆∞·ª£ng">
                    <select class="form-input w-16">
                        <option value="%">%</option>
                        <option value="c√¢y">c√¢y</option>
                        <option value="kg">kg</option>
                        <option value="m¬≤">m¬≤</option>
                    </select>
                    <button class="btn-secondary ml-2" onclick="removeCriteria(this)">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-2 gap-2 mt-2">
                    <div>
                        <label class="text-xs text-gray-600">Ti√™u ch√≠ ƒê·∫°t:</label>
                        <input type="text" class="form-input text-xs" placeholder="ƒêi·ªÅu ki·ªán ƒë·∫°t">
                    </div>
                    <div>
                        <label class="text-xs text-gray-600">Ti√™u ch√≠ Kh√¥ng ƒë·∫°t:</label>
                        <input type="text" class="form-input text-xs" placeholder="ƒêi·ªÅu ki·ªán kh√¥ng ƒë·∫°t">
                    </div>
                </div>
            `;
            criteriaContainer.appendChild(newCriteria);
        }

        function removeCriteria(button) {
            button.closest('.criteria-item').remove();
        }

        // File upload functions
        function triggerFileUpload() {
            document.getElementById('file-upload').click();
        }

        function handleDragOver(event) {
            event.preventDefault();
            event.currentTarget.classList.add('dragover');
        }

        function handleFileDrop(event) {
            event.preventDefault();
            event.currentTarget.classList.remove('dragover');
            const files = event.dataTransfer.files;
            handleFiles(files);
        }

        function handleFiles(files) {
            const uploadedFiles = document.getElementById('uploaded-files');
            Array.from(files).forEach(file => {
                const fileDiv = document.createElement('div');
                fileDiv.className = 'flex items-center justify-between p-2 bg-gray-50 rounded text-sm';
                fileDiv.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-file text-gray-500"></i>
                        <span>${file.name}</span>
                        <span class="text-xs text-gray-500">(${(file.size / 1024 / 1024).toFixed(2)} MB)</span>
                    </div>
                    <button class="text-red-500 hover:text-red-700" onclick="removeUploadedFile(this)">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                uploadedFiles.appendChild(fileDiv);
            });
        }

        function removeUploadedFile(button) {
            button.parentElement.remove();
        }

        function openInstructionLibrary() {
            alert('M·ªü th∆∞ vi·ªán h∆∞·ªõng d·∫´n\n\nT√≠nh nƒÉng n√†y s·∫Ω hi·ªÉn th·ªã th∆∞ vi·ªán c√°c template h∆∞·ªõng d·∫´n c√≥ s·∫µn.');
        }

        // Phase Management
        function editPhase(phaseId) {
            alert(`Ch·ªânh s·ª≠a giai ƒëo·∫°n ${phaseId}\n\nT√≠nh nƒÉng n√†y s·∫Ω m·ªü form ch·ªânh s·ª≠a th√¥ng tin giai ƒëo·∫°n v√† tham s·ªë sinh tr∆∞·ªüng.`);
        }

        function deletePhase(phaseId) {
            if (confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a giai ƒëo·∫°n ${phaseId}?\n\nT·∫•t c·∫£ c√¥ng vi·ªác trong giai ƒëo·∫°n n√†y c≈©ng s·∫Ω b·ªã x√≥a.`)) {
                const phaseCard = document.querySelector(`[data-phase="${phaseId}"]`);
                if (phaseCard) {
                    phaseCard.remove();
                    updateStats();
                }
            }
        }

        function addNewPhase(type = 'recurring') {
            alert(`Th√™m giai ƒëo·∫°n ${type}\n\nT√≠nh nƒÉng n√†y s·∫Ω t·∫°o giai ƒëo·∫°n m·ªõi v·ªõi lo·∫°i ƒë√£ ch·ªçn v√† tham s·ªë sinh tr∆∞·ªüng m·∫∑c ƒë·ªãnh.`);
        }

        // Task Management
        function editTask(phaseId, taskId) {
            currentPhase = phaseId;
            currentTask = taskId;
            
            const phaseCard = document.querySelector(`[data-phase="${phaseId}"]`);
            const isSetupPhase = phaseCard.classList.contains('setup-phase');
            
            document.querySelector(`input[name="phase-type"][value="${isSetupPhase ? 'setup' : 'recurring'}"]`).checked = true;
            
            document.getElementById('task-modal').style.display = 'flex';
        }

        function addTask(phaseId) {
            currentPhase = phaseId;
            currentTask = 'new';
            
            document.getElementById('task-name').value = '';
            document.getElementById('task-description').value = '';
            
            const phaseCard = document.querySelector(`[data-phase="${phaseId}"]`);
            const isSetupPhase = phaseCard.classList.contains('setup-phase');
            
            document.querySelector(`input[name="phase-type"][value="${isSetupPhase ? 'setup' : 'recurring'}"]`).checked = true;
            
            document.getElementById('task-modal').style.display = 'flex';
        }

        function closeTaskModal() {
            document.getElementById('task-modal').style.display = 'none';
            currentPhase = null;
            currentTask = null;
        }

        function saveTask() {
            const taskName = document.getElementById('task-name').value;
            if (!taskName) {
                alert('Vui l√≤ng nh·∫≠p t√™n c√¥ng vi·ªác!');
                return;
            }
            
            alert(`ƒê√£ l∆∞u c√¥ng vi·ªác: ${taskName}\n\nT·∫•t c·∫£ th√¥ng tin chi ti·∫øt v√† tham s·ªë sinh tr∆∞·ªüng ƒë√£ ƒë∆∞·ª£c l∆∞u.`);
            closeTaskModal();
            updateStats();
        }

        function duplicateTask() {
            alert('Sao ch√©p c√¥ng vi·ªác\n\nT√≠nh nƒÉng n√†y s·∫Ω t·∫°o m·ªôt c√¥ng vi·ªác m·ªõi v·ªõi th√¥ng tin t∆∞∆°ng t·ª± bao g·ªìm c·∫£ tham s·ªë sinh tr∆∞·ªüng.');
        }

        // Global Functions
        function updateStats() {
            const totalPhases = document.querySelectorAll('.phase-card').length;
            const setupPhases = document.querySelectorAll('.setup-phase').length;
            const recurringPhases = document.querySelectorAll('.recurring-phase').length;
            const totalTasks = document.querySelectorAll('.task-card').length;
            
            document.getElementById('total-phases').textContent = totalPhases;
            document.getElementById('setup-phases').textContent = setupPhases;
            document.getElementById('recurring-phases').textContent = recurringPhases;
            document.getElementById('task-count').textContent = totalTasks;
        }

        function saveTemplate() {
            alert('L∆∞u template th√†nh c√¥ng!\n\nQuy tr√¨nh to√†n di·ªán n√†y v·ªõi ƒë·∫ßy ƒë·ªß tham s·ªë sinh tr∆∞·ªüng ƒë√£ ƒë∆∞·ª£c l∆∞u v√† c√≥ th·ªÉ s·ª≠ d·ª•ng cho c√°c farm kh√°c.');
        }

        function publishProcess() {
            if (confirm('Xu·∫•t b·∫£n quy tr√¨nh n√†y?\n\nSau khi xu·∫•t b·∫£n, n√≥ s·∫Ω c√≥ s·∫µn trong th∆∞ vi·ªán cho t·∫•t c·∫£ ng∆∞·ªùi d√πng v·ªõi ƒë·∫ßy ƒë·ªß tham s·ªë sinh tr∆∞·ªüng.')) {
                alert('‚úÖ ƒê√£ xu·∫•t b·∫£n quy tr√¨nh th√†nh c√¥ng!\n\nQuy tr√¨nh canh t√°c s·∫ßu ri√™ng to√†n di·ªán v·ªõi tham s·ªë sinh tr∆∞·ªüng chi ti·∫øt ƒë√£ ƒë∆∞·ª£c th√™m v√†o th∆∞ vi·ªán.');
            }
        }

        function quickAddPhase(phaseType) {
            alert(`Th√™m nhanh giai ƒëo·∫°n: ${phaseType}\n\nT√≠nh nƒÉng n√†y s·∫Ω t·ª± ƒë·ªông t·∫°o giai ƒëo·∫°n t·ª´ template v·ªõi tham s·ªë sinh tr∆∞·ªüng ph√π h·ª£p.`);
        }

        // File upload event listener
        document.addEventListener('DOMContentLoaded', function() {
            const fileUpload = document.getElementById('file-upload');
            fileUpload.addEventListener('change', function(e) {
                handleFiles(e.target.files);
            });
            
            updateStats();
            updateCycleType();
            updateProductionObjects();
            updateGrowthParameters();
            calculateDensity(); // Initialize planting density calculations
        });
    </script>
</body>
</html>