<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L√†m vi·ªác t·∫°i V∆∞·ªùn - FarmKeeper</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        .mobile-container {
            max-width: 390px;
            margin: 0 auto;
            background: #f8fafc;
            min-height: 100vh;
            position: relative;
            border: 1px solid #e2e8f0;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        .status-bar {
            height: 24px;
            background: #000;
            color: white;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 16px;
        }
        
        .farm-header {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 16px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .content-area {
            flex: 1;
            padding-bottom: 80px;
            overflow-y: auto;
        }
        
        .work-card {
            background: white;
            border-radius: 12px;
            margin: 8px 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid #f1f5f9;
            overflow: hidden;
        }
        
        .card-header {
            padding: 16px 16px 12px 16px;
            border-bottom: 1px solid #f1f5f9;
            background: #fafbfc;
        }
        
        .card-content {
            padding: 16px;
        }
        
        .task-item {
            padding: 12px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .task-item:active {
            transform: scale(0.98);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .task-completed {
            background: #f0fdf4;
            border-color: #10b981;
        }
        
        .task-in-progress {
            background: #fffbeb;
            border-color: #f59e0b;
        }
        
        .task-pending {
            background: #fef2f2;
            border-color: #ef4444;
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-working {
            background: #10b981;
            color: white;
        }
        
        .status-break {
            background: #f59e0b;
            color: white;
        }
        
        .status-offline {
            background: #6b7280;
            color: white;
        }
        
        .action-btn {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .action-btn:active {
            transform: scale(0.95);
        }
        
        .btn-primary {
            background: #3b82f6;
            color: white;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-warning {
            background: #f59e0b;
            color: white;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 12px 0;
        }
        
        .photo-item {
            aspect-ratio: 1;
            background: #f3f4f6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px dashed #d1d5db;
            transition: all 0.2s;
        }
        
        .photo-item:hover {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 6px;
        }
        
        .sensor-data {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin: 12px 0;
        }
        
        .sensor-item {
            background: #f8fafc;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        
        .sensor-value {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .sensor-label {
            font-size: 12px;
            color: #6b7280;
        }
        
        .progress-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            margin: 0 auto 8px;
        }
        
        .floating-actions {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 90;
        }
        
        .fab {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        
        .fab:active {
            transform: scale(0.95);
        }
        
        .fab-camera {
            background: #10b981;
        }
        
        .fab-voice {
            background: #f59e0b;
        }
        
        .fab-report {
            background: #3b82f6;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            padding: 20px;
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            width: 100%;
            max-width: 400px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .checklist-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .checklist-item:last-child {
            border-bottom: none;
        }
        
        .checklist-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #d1d5db;
            border-radius: 4px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .checklist-checkbox.checked {
            background: #10b981;
            border-color: #10b981;
            color: white;
        }
        
        .time-tracker {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            padding: 16px;
            border-radius: 12px;
            margin: 8px 16px;
            text-align: center;
        }
        
        .timer-display {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .work-status {
            font-size: 14px;
            opacity: 0.9;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .recording {
            animation: pulse 1s infinite;
        }
        
        .slide-in {
            animation: slideInUp 0.3s ease-out;
        }
        
        @keyframes slideInUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="mobile-container">
        <!-- Status Bar -->
        <div class="status-bar">
            <span>09:41</span>
            <span>üì∂ üì∂ üì∂ üíæ üîã</span>
        </div>
        
        <!-- Farm Header -->
        <div class="farm-header">
            <div class="flex items-center justify-between mb-2">
                <button onclick="goBack()" class="text-white">
                    <i class="fas fa-arrow-left text-xl"></i>
                </button>
                <div class="text-center flex-1">
                    <h1 class="text-lg font-bold">V∆∞·ªùn Anh Hi·ªÅn</h1>
                    <p class="text-sm opacity-90">C√∫ M'Gar, ƒê·ªìng Nai ‚Ä¢ 12.5ha</p>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="status-indicator status-working">
                        <i class="fas fa-tools mr-1"></i>
                        ƒêang l√†m vi·ªác
                    </div>
                </div>
            </div>
            
            <!-- Farm Quick Info -->
            <div class="bg-white bg-opacity-20 rounded-lg p-3">
                <div class="grid grid-cols-4 gap-3 text-center">
                    <div>
                        <div class="text-lg font-bold">156</div>
                        <div class="text-xs opacity-80">C√¢y</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold">34¬∞C</div>
                        <div class="text-xs opacity-80">Nhi·ªát ƒë·ªô</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold">72%</div>
                        <div class="text-xs opacity-80">ƒê·ªô ·∫©m</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold">6.2</div>
                        <div class="text-xs opacity-80">pH ƒë·∫•t</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Time Tracker -->
        <div class="time-tracker">
            <div class="timer-display" id="workTimer">02:15:43</div>
            <div class="work-status">Th·ªùi gian l√†m vi·ªác h√¥m nay</div>
            <div class="flex justify-center space-x-4 mt-3">
                <button class="action-btn btn-warning" onclick="takeBreak()" id="breakBtn">
                    <i class="fas fa-pause"></i>
                    Ngh·ªâ gi·∫£i lao
                </button>
                <button class="action-btn btn-danger" onclick="endWork()">
                    <i class="fas fa-stop"></i>
                    K·∫øt th√∫c ca
                </button>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Current Tasks -->
            <div class="work-card">
                <div class="card-header">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-clipboard-check text-green-600 mr-2"></i>
                            Nhi·ªám v·ª• h√¥m nay
                        </h3>
                        <div class="progress-circle bg-green-500" style="background: conic-gradient(#10b981 0deg 252deg, #e5e7eb 252deg 360deg);">
                            70%
                        </div>
                    </div>
                </div>
                <div class="card-content">
                    <div class="space-y-3">
                        <!-- Task 1 - Completed -->
                        <div class="task-item task-completed" onclick="viewTaskDetails('task-1')">
                            <div class="flex items-center justify-between mb-2">
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-600 mr-3"></i>
                                    <span class="font-medium text-green-800">Ki·ªÉm tra s√¢u ph·ªß qu·∫£</span>
                                </div>
                                <span class="text-xs text-green-600">Ho√†n th√†nh</span>
                            </div>
                            <p class="text-sm text-gray-600 ml-7">ƒê√£ ki·ªÉm tra 156 c√¢y ‚Ä¢ Ph√°t hi·ªán 12 c√¢y b·ªã ·∫£nh h∆∞·ªüng</p>
                            <div class="flex space-x-2 mt-2 ml-7">
                                <button class="action-btn btn-success text-xs" onclick="viewReport('task-1')">
                                    üìÑ Xem b√°o c√°o
                                </button>
                                <button class="action-btn btn-secondary text-xs" onclick="editReport('task-1')">
                                    ‚úèÔ∏è Ch·ªânh s·ª≠a
                                </button>
                            </div>
                        </div>

                        <!-- Task 2 - In Progress -->
                        <div class="task-item task-in-progress" onclick="continueTask('task-2')">
                            <div class="flex items-center justify-between mb-2">
                                <div class="flex items-center">
                                    <i class="fas fa-clock text-yellow-600 mr-3"></i>
                                    <span class="font-medium text-yellow-800">H∆∞·ªõng d·∫´n phun thu·ªëc</span>
                                </div>
                                <span class="text-xs text-yellow-600">ƒêang th·ª±c hi·ªán</span>
                            </div>
                            <p class="text-sm text-gray-600 ml-7">Ti·∫øn ƒë·ªô: 40% ‚Ä¢ C√≤n l·∫°i 25 c√¢y</p>
                            <div class="bg-yellow-100 rounded-full h-2 ml-7 mt-2">
                                <div class="bg-yellow-500 h-2 rounded-full" style="width: 40%"></div>
                            </div>
                            <div class="flex space-x-2 mt-2 ml-7">
                                <button class="action-btn btn-warning text-xs" onclick="continueTask('task-2')">
                                    ‚ñ∂Ô∏è Ti·∫øp t·ª•c
                                </button>
                                <button class="action-btn btn-secondary text-xs" onclick="pauseTask('task-2')">
                                    ‚è∏Ô∏è T·∫°m d·ª´ng
                                </button>
                            </div>
                        </div>

                        <!-- Task 3 - Pending -->
                        <div class="task-item task-pending" onclick="startTask('task-3')">
                            <div class="flex items-center justify-between mb-2">
                                <div class="flex items-center">
                                    <i class="fas fa-exclamation-circle text-red-600 mr-3"></i>
                                    <span class="font-medium text-red-800">ƒê√°nh gi√° h·ªá th·ªëng t∆∞·ªõi</span>
                                </div>
                                <span class="text-xs text-red-600">Ch∆∞a b·∫Øt ƒë·∫ßu</span>
                            </div>
                            <p class="text-sm text-gray-600 ml-7">Ki·ªÉm tra 8 ƒëi·ªÉm t∆∞·ªõi ‚Ä¢ ∆Ø·ªõc t√≠nh: 45 ph√∫t</p>
                            <div class="flex space-x-2 mt-2 ml-7">
                                <button class="action-btn btn-primary text-xs" onclick="startTask('task-3')">
                                    üöÄ B·∫Øt ƒë·∫ßu
                                </button>
                                <button class="action-btn btn-secondary text-xs" onclick="viewTaskGuide('task-3')">
                                    üìñ H∆∞·ªõng d·∫´n
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="work-card">
                <div class="card-header">
                    <h3 class="font-bold text-gray-800 flex items-center">
                        <i class="fas fa-bolt text-orange-600 mr-2"></i>
                        H√†nh ƒë·ªông nhanh
                    </h3>
                </div>
                <div class="card-content">
                    <div class="grid grid-cols-3 gap-3">
                        <button class="action-btn btn-primary flex-col h-20" onclick="quickNote()">
                            <i class="fas fa-sticky-note text-xl mb-2"></i>
                            <span class="text-xs">Ghi ch√∫ nhanh</span>
                        </button>
                        
                        <button class="action-btn btn-success flex-col h-20" onclick="measurePlant()">
                            <i class="fas fa-ruler text-xl mb-2"></i>
                            <span class="text-xs">ƒêo c√¢y</span>
                        </button>
                        
                        <button class="action-btn btn-warning flex-col h-20" onclick="reportIssue()">
                            <i class="fas fa-exclamation-triangle text-xl mb-2"></i>
                            <span class="text-xs">B√°o c√°o v·∫•n ƒë·ªÅ</span>
                        </button>
                        
                        <button class="action-btn btn-secondary flex-col h-20" onclick="callFarmer()">
                            <i class="fas fa-phone text-xl mb-2"></i>
                            <span class="text-xs">G·ªçi n√¥ng d√¢n</span>
                        </button>
                        
                        <button class="action-btn btn-primary flex-col h-20" onclick="checkWeather()">
                            <i class="fas fa-cloud-sun text-xl mb-2"></i>
                            <span class="text-xs">Th·ªùi ti·∫øt</span>
                        </button>
                        
                        <button class="action-btn btn-success flex-col h-20" onclick="aiScan()">
                            <i class="fas fa-search text-xl mb-2"></i>
                            <span class="text-xs">AI Scan</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Photo Documentation -->
            <div class="work-card">
                <div class="card-header">
                    <div class="flex items-center justify-between">
                        <h3 class="font-bold text-gray-800 flex items-center">
                            <i class="fas fa-camera text-purple-600 mr-2"></i>
                            H√¨nh ·∫£nh t√†i li·ªáu
                        </h3>
                        <span class="text-sm text-gray-600">12 ·∫£nh</span>
                    </div>
                </div>
                <div class="card-content">
                    <div class="photo-grid">
                        <div class="photo-item" onclick="takePhoto()">
                            <i class="fas fa-plus text-2xl text-gray-400"></i>
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/100x100/059669/FFFFFF?text=S√¢u" alt="S√¢u ph·ªß qu·∫£">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/100x100/10b981/FFFFFF?text=L√°" alt="T√¨nh tr·∫°ng l√°">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/100x100/059669/FFFFFF?text=Qu·∫£" alt="Qu·∫£ non">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/100x100/10b981/FFFFFF?text=Th√¢n" alt="Th√¢n c√¢y">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/100x100/059669/FFFFFF?text=ƒê·∫•t" alt="ƒê·∫•t">
                        </div>
                    </div>
                    <button class="action-btn btn-primary w-full mt-3" onclick="viewAllPhotos()">
                        <i class="fas fa-images mr-2"></i>
                        Xem t·∫•t c·∫£ h√¨nh ·∫£nh
                    </button>
                </div>
            </div>

            <!-- Work Report Summary -->
            <div class="work-card">
                <div class="card-header">
                    <h3 class="font-bold text-gray-800 flex items-center">
                        <i class="fas fa-file-alt text-blue-600 mr-2"></i>
                        T√≥m t·∫Øt b√°o c√°o
                    </h3>
                </div>
                <div class="card-content">
                    <div class="space-y-3">
                        <div class="bg-green-50 p-3 rounded-lg border border-green-200">
                            <h4 class="font-medium text-green-800 mb-2">‚úÖ Ho√†n th√†nh</h4>
                            <ul class="text-sm text-green-700 space-y-1">
                                <li>‚Ä¢ Ki·ªÉm tra s√¢u ph·ªß qu·∫£: 12/156 c√¢y b·ªã ·∫£nh h∆∞·ªüng nh·∫π</li>
                                <li>‚Ä¢ ƒêo pH ƒë·∫•t: 6.2 (trong m·ª©c b√¨nh th∆∞·ªùng)</li>
                                <li>‚Ä¢ Ki·ªÉm tra h·ªá th·ªëng t∆∞·ªõi: 7/8 ƒëi·ªÉm ho·∫°t ƒë·ªông t·ªët</li>
                            </ul>
                        </div>
                        
                        <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200">
                            <h4 class="font-medium text-yellow-800 mb-2">‚ö†Ô∏è Khuy·∫øn ngh·ªã</h4>
                            <ul class="text-sm text-yellow-700 space-y-1">
                                <li>‚Ä¢ Phun thu·ªëc Imidacloprid cho 12 c√¢y b·ªã s√¢u</li>
                                <li>‚Ä¢ S·ª≠a ch·ªØa 1 ƒëi·ªÉm t∆∞·ªõi b·ªã t·∫Øc ngh·∫Ωn</li>
                                <li>‚Ä¢ TƒÉng c∆∞·ªùng b√≥n ph√¢n kali cho giai ƒëo·∫°n ra hoa</li>
                            </ul>
                        </div>
                        
                        <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                            <h4 class="font-medium text-red-800 mb-2">üö® C·∫ßn ch√∫ √Ω</h4>
                            <ul class="text-sm text-red-700 space-y-1">
                                <li>‚Ä¢ Theo d√µi s√°t sao t√¨nh h√¨nh s√¢u ph·ªß qu·∫£</li>
                                <li>‚Ä¢ Ki·ªÉm tra l·∫°i sau 3-5 ng√†y</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="flex space-x-2 mt-4">
                        <button class="action-btn btn-primary flex-1" onclick="generateFullReport()">
                            üìÑ T·∫°o b√°o c√°o ƒë·∫ßy ƒë·ªß
                        </button>
                        <button class="action-btn btn-success flex-1" onclick="sendReportToManager()">
                            üì§ G·ª≠i cho qu·∫£n l√Ω
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Floating Action Buttons -->
        <div class="floating-actions">
            <button class="fab fab-camera" onclick="quickCamera()" title="Ch·ª•p ·∫£nh nhanh">
                <i class="fas fa-camera"></i>
            </button>
            <button class="fab fab-voice" onclick="voiceNote()" title="Ghi √¢m ghi ch√∫" id="voiceBtn">
                <i class="fas fa-microphone"></i>
            </button>
            <button class="fab fab-report" onclick="quickReport()" title="B√°o c√°o nhanh">
                <i class="fas fa-edit"></i>
            </button>
        </div>
    </div>

    <!-- Task Details Modal -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <div class="bg-blue-500 text-white p-4 rounded-t-lg">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg font-bold">Chi ti·∫øt nhi·ªám v·ª•</h3>
                    <button onclick="closeModal('taskModal')" class="text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="p-4">
                <div id="taskDetails">
                    <!-- Task details will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Report Modal -->
    <div id="reportModal" class="modal">
        <div class="modal-content">
            <div class="bg-green-500 text-white p-4 rounded-t-lg">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg font-bold">B√°o c√°o nhanh</h3>
                    <button onclick="closeModal('reportModal')" class="text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="p-4 space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Lo·∫°i b√°o c√°o</label>
                    <select class="w-full p-2 border border-gray-300 rounded-lg">
                        <option>Ti·∫øn ƒë·ªô c√¥ng vi·ªác</option>
                        <option>Ph√°t hi·ªán s√¢u b·ªánh</option>
                        <option>T√¨nh tr·∫°ng c√¢y tr·ªìng</option>
                        <option>V·∫•n ƒë·ªÅ k·ªπ thu·∫≠t</option>
                        <option>Khuy·∫øn ngh·ªã</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">M√¥ t·∫£</label>
                    <textarea class="w-full p-2 border border-gray-300 rounded-lg h-24" 
                              placeholder="M√¥ t·∫£ chi ti·∫øt t√¨nh h√¨nh..."></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">M·ª©c ƒë·ªô ∆∞u ti√™n</label>
                    <div class="grid grid-cols-3 gap-2">
                        <button class="action-btn btn-success" onclick="setPriority('low')">Th·∫•p</button>
                        <button class="action-btn btn-warning" onclick="setPriority('medium')">Trung b√¨nh</button>
                        <button class="action-btn btn-danger" onclick="setPriority('high')">Cao</button>
                    </div>
                </div>
                
                <div class="flex space-x-2">
                    <button class="action-btn btn-primary flex-1" onclick="submitQuickReport()">
                        üì§ G·ª≠i b√°o c√°o
                    </button>
                    <button class="action-btn btn-secondary flex-1" onclick="saveDraft()">
                        üíæ L∆∞u nh√°p
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Time tracking
        let workStartTime = new Date();
        let isOnBreak = false;
        let breakStartTime = null;
        let totalBreakTime = 0;

        function updateTimer() {
            const now = new Date();
            let workTime = now - workStartTime - totalBreakTime;
            
            if (isOnBreak && breakStartTime) {
                workTime = breakStartTime - workStartTime - totalBreakTime;
            }
            
            const hours = Math.floor(workTime / (1000 * 60 * 60));
            const minutes = Math.floor((workTime % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((workTime % (1000 * 60)) / 1000);
            
            document.getElementById('workTimer').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Navigation
        function goBack() {
            showNotification('Quay l·∫°i danh s√°ch v∆∞·ªùn...', 'info');
            // Navigate back to farm list
        }

        // Work management
        function takeBreak() {
            const breakBtn = document.getElementById('breakBtn');
            
            if (!isOnBreak) {
                isOnBreak = true;
                breakStartTime = new Date();
                breakBtn.innerHTML = '<i class="fas fa-play"></i> Ti·∫øp t·ª•c l√†m vi·ªác';
                breakBtn.className = 'action-btn btn-success';
                showNotification('B·∫Øt ƒë·∫ßu ngh·ªâ gi·∫£i lao', 'info');
            } else {
                const now = new Date();
                totalBreakTime += now - breakStartTime;
                isOnBreak = false;
                breakStartTime = null;
                breakBtn.innerHTML = '<i class="fas fa-pause"></i> Ngh·ªâ gi·∫£i lao';
                breakBtn.className = 'action-btn btn-warning';
                showNotification('Ti·∫øp t·ª•c l√†m vi·ªác', 'success');
            }
        }

        function endWork() {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën k·∫øt th√∫c ca l√†m vi·ªác?')) {
                showNotification('ƒêang t·∫°o b√°o c√°o t·ªïng k·∫øt...', 'info');
                setTimeout(() => {
                    showNotification('Ca l√†m vi·ªác ƒë√£ k·∫øt th√∫c!', 'success');
                    // Navigate to work summary
                }, 2000);
            }
        }

        // Task management
        function viewTaskDetails(taskId) {
            const taskDetails = {
                'task-1': {
                    title: 'Ki·ªÉm tra s√¢u ph·ªß qu·∫£',
                    status: 'Ho√†n th√†nh',
                    description: 'Ki·ªÉm tra t·∫•t c·∫£ 156 c√¢y s·∫ßu ri√™ng ƒë·ªÉ ph√°t hi·ªán d·∫•u hi·ªáu s√¢u ph·ªß qu·∫£',
                    checklist: [
                        { text: 'Ki·ªÉm tra l√° non', completed: true },
                        { text: 'Ki·ªÉm tra qu·∫£ non', completed: true },
                        { text: 'Ki·ªÉm tra th√¢n c√¢y', completed: true },
                        { text: 'Ghi ch√©p k·∫øt qu·∫£', completed: true },
                        { text: 'Ch·ª•p ·∫£nh minh ch·ª©ng', completed: true }
                    ],
                    notes: '12 c√¢y b·ªã ·∫£nh h∆∞·ªüng nh·∫π, c·∫ßn phun thu·ªëc Imidacloprid'
                },
                'task-2': {
                    title: 'H∆∞·ªõng d·∫´n phun thu·ªëc',
                    status: 'ƒêang th·ª±c hi·ªán',
                    description: 'H∆∞·ªõng d·∫´n n√¥ng d√¢n c√°ch phun thu·ªëc Imidacloprid ƒë√∫ng k·ªπ thu·∫≠t',
                    checklist: [
                        { text: 'Chu·∫©n b·ªã dung d·ªãch thu·ªëc', completed: true },
                        { text: 'Ki·ªÉm tra thi·∫øt b·ªã phun', completed: true },
                        { text: 'H∆∞·ªõng d·∫´n k·ªπ thu·∫≠t phun', completed: false },
                        { text: 'Gi√°m s√°t qu√° tr√¨nh phun', completed: false },
                        { text: 'Ki·ªÉm tra k·∫øt qu·∫£', completed: false }
                    ],
                    notes: 'ƒê√£ phun 60% di·ªán t√≠ch, c√≤n l·∫°i 25 c√¢y'
                }
            };

            const task = taskDetails[taskId];
            if (task) {
                document.getElementById('taskDetails').innerHTML = `
                    <div class="space-y-4">
                        <div>
                            <h4 class="font-bold text-lg">${task.title}</h4>
                            <span class="inline-block px-3 py-1 rounded-full text-sm ${task.status === 'Ho√†n th√†nh' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">${task.status}</span>
                        </div>
                        
                        <div>
                            <h5 class="font-medium mb-2">M√¥ t·∫£:</h5>
                            <p class="text-gray-700">${task.description}</p>
                        </div>
                        
                        <div>
                            <h5 class="font-medium mb-2">Checklist:</h5>
                            <div class="space-y-2">
                                ${task.checklist.map((item, index) => `
                                    <div class="checklist-item">
                                        <div class="checklist-checkbox ${item.completed ? 'checked' : ''}" onclick="toggleChecklistItem(${index})">
                                            ${item.completed ? '<i class="fas fa-check"></i>' : ''}
                                        </div>
                                        <span class="${item.completed ? 'line-through text-gray-500' : ''}">${item.text}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div>
                            <h5 class="font-medium mb-2">Ghi ch√∫:</h5>
                            <p class="text-gray-700 bg-gray-50 p-3 rounded">${task.notes}</p>
                        </div>
                        
                        <div class="flex space-x-2">
                            <button class="action-btn btn-primary flex-1" onclick="editTask('${taskId}')">
                                ‚úèÔ∏è Ch·ªânh s·ª≠a
                            </button>
                            <button class="action-btn btn-success flex-1" onclick="completeTask('${taskId}')">
                                ‚úÖ Ho√†n th√†nh
                            </button>
                        </div>
                    </div>
                `;
                openModal('taskModal');
            }
        }

        function startTask(taskId) {
            showNotification(`B·∫Øt ƒë·∫ßu nhi·ªám v·ª•: ${taskId}`, 'success');
            // Update task status and UI
        }

        function continueTask(taskId) {
            showNotification(`Ti·∫øp t·ª•c nhi·ªám v·ª•: ${taskId}`, 'info');
        }

        function pauseTask(taskId) {
            showNotification(`T·∫°m d·ª´ng nhi·ªám v·ª•: ${taskId}`, 'warning');
        }

        function completeTask(taskId) {
            showNotification(`Ho√†n th√†nh nhi·ªám v·ª•: ${taskId}`, 'success');
            closeModal('taskModal');
        }

        function viewTaskGuide(taskId) {
            showNotification('M·ªü h∆∞·ªõng d·∫´n nhi·ªám v·ª•...', 'info');
        }

        // Quick actions
        function quickNote() {
            const note = prompt('Nh·∫≠p ghi ch√∫ nhanh:');
            if (note) {
                showNotification('ƒê√£ l∆∞u ghi ch√∫', 'success');
            }
        }

        function measurePlant() {
            showNotification('M·ªü c√¥ng c·ª• ƒëo l∆∞·ªùng AR...', 'info');
        }

        function reportIssue() {
            showNotification('M·ªü form b√°o c√°o v·∫•n ƒë·ªÅ...', 'warning');
        }

        function callFarmer() {
            showNotification('ƒêang g·ªçi cho n√¥ng d√¢n...', 'info');
        }

        function checkWeather() {
            showNotification('Ki·ªÉm tra th·ªùi ti·∫øt ƒë·ªãa ph∆∞∆°ng...', 'info');
        }

        function aiScan() {
            showNotification('K√≠ch ho·∫°t AI Scanner...', 'info');
        }

        // Photo management
        function takePhoto() {
            showNotification('M·ªü camera...', 'info');
            // Simulate adding a new photo
            setTimeout(() => {
                showNotification('ƒê√£ ch·ª•p v√† l∆∞u ·∫£nh', 'success');
            }, 1000);
        }

        function quickCamera() {
            showNotification('Ch·ª•p ·∫£nh nhanh...', 'info');
        }

        function viewAllPhotos() {
            showNotification('M·ªü th∆∞ vi·ªán ·∫£nh...', 'info');
        }

        // Voice notes
        let isRecording = false;

        function voiceNote() {
            const voiceBtn = document.getElementById('voiceBtn');
            
            if (!isRecording) {
                isRecording = true;
                voiceBtn.classList.add('recording');
                voiceBtn.innerHTML = '<i class="fas fa-stop"></i>';
                showNotification('ƒêang ghi √¢m...', 'info');
            } else {
                isRecording = false;
                voiceBtn.classList.remove('recording');
                voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                showNotification('ƒê√£ l∆∞u ghi √¢m', 'success');
            }
        }

        // Reports
        function quickReport() {
            openModal('reportModal');
        }

        function generateFullReport() {
            showNotification('ƒêang t·∫°o b√°o c√°o ƒë·∫ßy ƒë·ªß...', 'info');
            setTimeout(() => {
                showNotification('B√°o c√°o ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng!', 'success');
            }, 2000);
        }

        function sendReportToManager() {
            showNotification('ƒêang g·ª≠i b√°o c√°o cho qu·∫£n l√Ω...', 'info');
            setTimeout(() => {
                showNotification('B√°o c√°o ƒë√£ ƒë∆∞·ª£c g·ª≠i!', 'success');
            }, 1500);
        }

        function submitQuickReport() {
            showNotification('ƒêang g·ª≠i b√°o c√°o nhanh...', 'info');
            setTimeout(() => {
                showNotification('B√°o c√°o ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng!', 'success');
                closeModal('reportModal');
            }, 1500);
        }

        function saveDraft() {
            showNotification('ƒê√£ l∆∞u nh√°p b√°o c√°o', 'success');
        }

        function setPriority(level) {
            showNotification(`ƒê√£ ƒë·∫∑t m·ª©c ƒë·ªô ∆∞u ti√™n: ${level}`, 'info');
        }

        // Modal management
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('show');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // Utility functions
        function showNotification(message, type = 'info') {
            const colors = {
                'info': 'bg-blue-500',
                'success': 'bg-green-500',
                'warning': 'bg-yellow-500',
                'error': 'bg-red-500'
            };
            
            const notification = document.createElement('div');
            notification.className = `fixed top-20 left-1/2 transform -translate-x-1/2 ${colors[type]} text-white px-4 py-2 rounded-lg text-sm z-50 shadow-lg slide-in`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Farm Work Interface initialized');
            
            // Start timer
            setInterval(updateTimer, 1000);
            
            // Check GPS location
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    console.log('Current location:', position.coords);
                    showNotification('ƒê√£ x√°c ƒë·ªãnh v·ªã tr√≠ t·∫°i v∆∞·ªùn', 'success');
                });
            }
            
            // Auto-save work progress every 5 minutes
            setInterval(() => {
                showNotification('T·ª± ƒë·ªông l∆∞u ti·∫øn ƒë·ªô...', 'info');
            }, 300000);
        });

        // Handle offline mode
        window.addEventListener('online', function() {
            showNotification('ƒê√£ k·∫øt n·ªëi internet - ƒê·ªìng b·ªô d·ªØ li·ªáu...', 'success');
        });

        window.addEventListener('offline', function() {
            showNotification('M·∫•t k·∫øt n·ªëi internet - Ch·∫ø ƒë·ªô offline', 'warning');
        });
    </script>
</body>
</html>