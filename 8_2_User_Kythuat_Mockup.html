<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FarmKeeper Technician - K·ªπ thu·∫≠t vi√™n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* Mobile-first responsive design */
        .mobile-container {
            max-width: 390px;
            margin: 0 auto;
            background: #f8fafc;
            min-height: 100vh;
            position: relative;
            border: 1px solid #e2e8f0;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        .status-bar {
            height: 24px;
            background: #000;
            color: white;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 16px;
        }
        
        .app-header {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            padding: 12px 16px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .content-area {
            flex: 1;
            padding-bottom: 80px;
            overflow-y: auto;
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 390px;
            background: white;
            border-top: 1px solid #e2e8f0;
            padding: 8px 0;
            display: flex;
            justify-content: around;
            z-index: 100;
        }
        
        .nav-item {
            flex: 1;
            text-align: center;
            padding: 8px 4px;
            color: #6b7280;
            transition: all 0.2s;
            position: relative;
        }
        
        .nav-item.active {
            color: #3b82f6;
        }
        
        .nav-item i {
            display: block;
            font-size: 20px;
            margin-bottom: 4px;
        }
        
        .nav-item span {
            font-size: 11px;
            font-weight: 500;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin: 8px 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid #f1f5f9;
        }
        
        .metric-card {
            background: white;
            border-radius: 12px;
            padding: 12px;
            text-align: center;
            border: 1px solid #f1f5f9;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .alert-badge {
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: -6px;
            right: -6px;
            animation: pulse 2s infinite;
        }
        
        .farm-item {
            background: white;
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 8px;
            border: 1px solid #f1f5f9;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .farm-item:active {
            transform: scale(0.98);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .farm-item.urgent {
            border-left: 4px solid #ef4444;
            background: #fef2f2;
        }
        
        .farm-item.warning {
            border-left: 4px solid #f59e0b;
            background: #fffbeb;
        }
        
        .farm-item.normal {
            border-left: 4px solid #10b981;
            background: #f0fdf4;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 6px;
        }
        
        .status-urgent { background: #ef4444; }
        .status-warning { background: #f59e0b; }
        .status-normal { background: #10b981; }
        .status-offline { background: #6b7280; }
        
        .priority-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .priority-critical { background: #ef4444; animation: pulse 2s infinite; }
        .priority-high { background: #f59e0b; }
        .priority-medium { background: #3b82f6; }
        .priority-low { background: #10b981; }
        
        .communication-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
            border: 1px solid #f1f5f9;
            transition: all 0.2s;
        }
        
        .communication-item:active {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .communication-item.unread {
            background: #eff6ff;
            border-color: #3b82f6;
        }
        
        /* Enhanced FAB with expanded menu */
        .fab {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: #3b82f6;
            color: white;
            border: none;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
            z-index: 90;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .fab:active {
            transform: scale(0.95);
        }
        
        .fab.expanded {
            transform: rotate(45deg);
            background: #ef4444;
        }
        
        .fab-menu {
            position: fixed;
            bottom: 160px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: all 0.3s ease;
            z-index: 85;
        }
        
        .fab-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .fab-item {
            display: flex;
            align-items: center;
            background: white;
            border-radius: 28px;
            padding: 12px 16px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .fab-item:hover {
            transform: translateX(-4px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }
        
        .fab-item i {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
            font-size: 14px;
            color: white;
        }
        
        .fab-item span {
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            white-space: nowrap;
        }
        
        .fab-ai { background: #8b5cf6; }
        .fab-camera { background: #10b981; }
        .fab-voice { background: #f59e0b; }
        .fab-emergency { background: #ef4444; }
        .fab-nav { background: #3b82f6; }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .schedule-item {
            background: white;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            border-left: 4px solid #3b82f6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .schedule-item.today {
            border-left-color: #10b981;
            background: #f0fdf4;
        }
        
        .schedule-item.overdue {
            border-left-color: #ef4444;
            background: #fef2f2;
        }
        
        .knowledge-item {
            background: white;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            border: 1px solid #f1f5f9;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .knowledge-item:active {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .farm-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin: 12px 0;
        }
        
        .filter-btn {
            flex-shrink: 0;
            background: white;
            border: 1px solid #e2e8f0;
            color: #6b7280;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
            white-space: nowrap;
        }
        
        .filter-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            transition: stroke-dashoffset 0.35s;
            transform-origin: 50% 50%;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="mobile-container">
        <!-- Status Bar -->
        <div class="status-bar">
            <span>09:41</span>
            <span>üì∂ üì∂ üì∂ üíæ üîã</span>
        </div>
        
        <!-- App Header -->
        <div class="app-header">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-white bg-opacity-20 rounded-lg flex items-center justify-center">
                        <i class="fas fa-user-tie text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold">KS. Ph·∫°m VƒÉn Minh</h1>
                        <p class="text-sm opacity-90">ID: KTV001 ‚Ä¢ Rank: #1 ‚Ä¢ 98% hi·ªáu su·∫•t</p>
                    </div>
                </div>
                <div class="flex items-center space-x-3">
                    <!-- Connection Status -->
                    <div class="flex items-center space-x-1">
                        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                        <span class="text-xs opacity-80">Sync</span>
                    </div>
                    <!-- Quick Actions -->
                    <div class="flex items-center space-x-2">
                        <button class="bg-white bg-opacity-20 p-2 rounded-lg" onclick="startEmergencyCall()">
                            <i class="fas fa-phone text-white"></i>
                        </button>
                        <button class="bg-white bg-opacity-20 p-2 rounded-lg" onclick="openCamera()">
                            <i class="fas fa-camera text-white"></i>
                        </button>
                        <div class="relative">
                            <button class="bg-white bg-opacity-20 p-2 rounded-lg" onclick="toggleNotifications()">
                                <i class="fas fa-bell text-white"></i>
                            </button>
                            <div class="alert-badge">7</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-content active">
                <!-- Critical Alerts Summary -->
                <div class="card">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-lg font-bold text-red-800 flex items-center">
                            <i class="fas fa-exclamation-triangle text-red-600 mr-2"></i>
                            C·∫£nh b√°o kh·∫©n c·∫•p
                        </h3>
                        <span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs">7 v∆∞·ªùn</span>
                    </div>
                    
                    <div class="space-y-2">
                        <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                            <div class="flex items-center justify-between mb-2">
                                <div class="flex items-center space-x-2">
                                    <div class="priority-indicator priority-critical"></div>
                                    <span class="font-bold text-red-800 text-sm">S√¢u ph·ªß qu·∫£</span>
                                </div>
                                <span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs">4 v∆∞·ªùn</span>
                            </div>
                            <p class="text-xs text-red-700 mb-2">V∆∞·ªùn Anh Hi·ªÅn, Ch√∫ D≈©ng, B√°c T√¢m, C√¥ Lan</p>
                            <div class="flex space-x-2">
                                <button class="bg-red-500 text-white px-3 py-1 rounded text-xs" onclick="handleMassEmergency('pest')">
                                    üö® X·ª≠ l√Ω h√†ng lo·∫°t
                                </button>
                                <button class="bg-blue-500 text-white px-3 py-1 rounded text-xs" onclick="createGroupChat('pest')">
                                    üí¨ Chat nh√≥m
                                </button>
                            </div>
                        </div>
                        
                        <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-2">
                                    <div class="priority-indicator priority-high"></div>
                                    <span class="font-bold text-yellow-800 text-sm">Thi·∫øu ph√¢n NPK</span>
                                </div>
                                <span class="bg-yellow-500 text-white px-2 py-1 rounded-full text-xs">3 v∆∞·ªùn</span>
                            </div>
                            <p class="text-xs text-yellow-700">C·∫ßn ƒë·∫∑t h√†ng kh·∫©n c·∫•p</p>
                        </div>
                    </div>
                </div>

                <!-- Overview Metrics -->
                <div class="card">
                    <h3 class="text-lg font-bold text-gray-800 mb-3 flex items-center">
                        <i class="fas fa-chart-pie text-blue-600 mr-2"></i>
                        Dashboard K·ªπ thu·∫≠t vi√™n
                    </h3>
                    
                    <div class="grid grid-cols-2 gap-3 mb-4">
                        <div class="metric-card">
                            <div class="text-2xl font-bold text-blue-700">23</div>
                            <div class="text-sm text-gray-600">V∆∞·ªùn ph·ª• tr√°ch</div>
                        </div>
                        <div class="metric-card">
                            <div class="text-2xl font-bold text-green-700">18</div>
                            <div class="text-sm text-gray-600">Ho√†n th√†nh h√¥m nay</div>
                        </div>
                        <div class="metric-card">
                            <div class="text-2xl font-bold text-orange-700">5</div>
                            <div class="text-sm text-gray-600">ƒêang th·ª±c hi·ªán</div>
                        </div>
                        <div class="metric-card">
                            <div class="text-2xl font-bold text-purple-700">2</div>
                            <div class="text-sm text-gray-600">Kh·∫©n c·∫•p</div>
                        </div>
                    </div>
                    
                    <!-- AI Assistant Integration -->
                    <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-3 border border-blue-200 mb-4">
                        <div class="flex items-center space-x-2 mb-2">
                            <i class="fas fa-robot text-blue-600"></i>
                            <span class="font-bold text-blue-800">AI Assistant</span>
                            <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-xs">Beta</span>
                        </div>
                        <p class="text-sm text-blue-700 mb-2">"H√¥m nay n√™n ∆∞u ti√™n x·ª≠ l√Ω s√¢u ph·ªß qu·∫£ ·ªü v∆∞·ªùn Anh Hi·ªÅn tr∆∞·ªõc khi m∆∞a"</p>
                        <div class="flex space-x-2">
                            <button class="bg-blue-500 text-white px-3 py-1 rounded text-xs" onclick="followAIAdvice()">
                                ‚úì √Åp d·ª•ng
                            </button>
                            <button class="bg-gray-200 text-gray-700 px-3 py-1 rounded text-xs" onclick="askAI()">
                                üí¨ H·ªèi th√™m
                            </button>
                        </div>
                    </div>
                    
                    <!-- Smart Route Optimization -->
                    <div class="bg-gradient-to-r from-green-50 to-teal-50 rounded-lg p-3 border border-green-200">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-route text-green-600"></i>
                                <span class="font-bold text-green-800">L·ªô tr√¨nh t·ªëi ∆∞u</span>
                            </div>
                            <span class="text-sm text-green-700">Ti·∫øt ki·ªám 45 ph√∫t</span>
                        </div>
                        <div class="text-sm text-green-700 mb-2">
                            <div class="flex items-center space-x-1">
                                <i class="fas fa-clock text-green-600"></i>
                                <span>4 gi·ªù 15 ph√∫t ‚Ä¢ 67.3 km</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="bg-green-500 text-white px-3 py-1 rounded text-xs" onclick="startOptimizedRoute()">
                                üöó B·∫Øt ƒë·∫ßu
                            </button>
                            <button class="bg-gray-200 text-gray-700 px-3 py-1 rounded text-xs" onclick="customizeRoute()">
                                ‚öôÔ∏è T√πy ch·ªânh
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Today's Schedule -->
                <div class="card">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-calendar-day text-green-600 mr-2"></i>
                            L·ªãch h√¥m nay
                        </h3>
                        <button class="bg-green-500 text-white px-3 py-1 rounded-lg text-xs" onclick="viewFullSchedule()">
                            Xem t·∫•t c·∫£
                        </button>
                    </div>
                    
                    <div class="space-y-2">
                        <div class="schedule-item today">
                            <div class="flex items-center justify-between mb-1">
                                <span class="font-medium text-green-800 text-sm">8:00 - V∆∞·ªùn Anh Hi·ªÅn</span>
                                <span class="bg-green-500 text-white px-2 py-1 rounded-full text-xs">H√¥m nay</span>
                            </div>
                            <p class="text-xs text-gray-600">Ki·ªÉm tra s√¢u ph·ªß qu·∫£ ‚Ä¢ C√∫ M'Gar, DL</p>
                            <div class="flex items-center mt-2 space-x-2">
                                <button class="bg-green-500 text-white px-2 py-1 rounded text-xs" onclick="startVisit('farm-1')">
                                    üöó B·∫Øt ƒë·∫ßu
                                </button>
                                <button class="bg-blue-500 text-white px-2 py-1 rounded text-xs" onclick="callFarmer('farm-1')">
                                    üìû G·ªçi
                                </button>
                            </div>
                        </div>
                        
                        <div class="schedule-item">
                            <div class="flex items-center justify-between mb-1">
                                <span class="font-medium text-blue-800 text-sm">14:00 - V∆∞·ªùn B√°c T√¢m</span>
                                <span class="bg-blue-500 text-white px-2 py-1 rounded-full text-xs">S·∫Øp t·ªõi</span>
                            </div>
                            <p class="text-xs text-gray-600">H∆∞·ªõng d·∫´n b√≥n ph√¢n ‚Ä¢ Tr·∫£ng Bom, DN</p>
                        </div>
                        
                        <div class="schedule-item overdue">
                            <div class="flex items-center justify-between mb-1">
                                <span class="font-medium text-red-800 text-sm">Th·ª© 6 - V∆∞·ªùn Ch√∫ D≈©ng</span>
                                <span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs">Tr·ªÖ h·∫πn</span>
                            </div>
                            <p class="text-xs text-gray-600">Ki·ªÉm tra ƒë·ªãnh k·ª≥ ‚Ä¢ C·∫ßn li√™n h·ªá l·∫°i</p>
                            <button class="bg-red-500 text-white px-2 py-1 rounded text-xs mt-1" onclick="rescheduleVisit('farm-3')">
                                üìÖ ƒê·ªïi l·ªãch
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card">
                    <h3 class="text-lg font-bold text-gray-800 mb-3">H√†nh ƒë·ªông nhanh</h3>
                    <div class="grid grid-cols-4 gap-3">
                        <div class="text-center" onclick="startVideoCall()">
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mb-2">
                                <i class="fas fa-video text-blue-600 text-lg"></i>
                            </div>
                            <div class="text-xs font-medium">Video call</div>
                        </div>
                        <div class="text-center" onclick="createReport()">
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mb-2">
                                <i class="fas fa-file-alt text-green-600 text-lg"></i>
                            </div>
                            <div class="text-xs font-medium">B√°o c√°o</div>
                        </div>
                        <div class="text-center" onclick="sendBroadcast()">
                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mb-2">
                                <i class="fas fa-broadcast-tower text-purple-600 text-lg"></i>
                            </div>
                            <div class="text-xs font-medium">Th√¥ng b√°o</div>
                        </div>
                        <div class="text-center" onclick="openKnowledge()">
                            <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center mb-2">
                                <i class="fas fa-book text-orange-600 text-lg"></i>
                            </div>
                            <div class="text-xs font-medium">T√†i li·ªáu</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Farms Tab -->
            <div id="farms-tab" class="tab-content">
                <div class="card">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-map-marked-alt text-green-600 mr-2"></i>
                            V∆∞·ªùn ƒëang qu·∫£n l√Ω
                        </h3>
                        <div class="flex items-center space-x-2">
                            <select class="text-xs border rounded px-2 py-1" onchange="filterByRegion(this.value)">
                                <option value="all">T·∫•t c·∫£ khu v·ª±c</option>
                                <option value="dongnai">ƒê·ªìng Nai</option>
                                <option value="binhduong">B√¨nh D∆∞∆°ng</option>
                                <option value="longan">Long An</option>
                            </select>
                            <button class="bg-green-500 text-white px-3 py-1 rounded-lg text-xs" onclick="addNewFarm()">
                                <i class="fas fa-plus mr-1"></i>Th√™m v∆∞·ªùn
                            </button>
                        </div>
                    </div>
                    
                    <!-- Status Filter -->
                    <div class="flex overflow-x-auto space-x-2 mb-4 pb-2">
                        <button class="filter-btn active" onclick="filterFarms('all')">T·∫•t c·∫£</button>
                        <button class="filter-btn" onclick="filterFarms('urgent')">Kh·∫©n c·∫•p</button>
                        <button class="filter-btn" onclick="filterFarms('warning')">C·∫£nh b√°o</button>
                        <button class="filter-btn" onclick="filterFarms('normal')">B√¨nh th∆∞·ªùng</button>
                        <button class="filter-btn" onclick="filterFarms('offline')">M·∫•t k·∫øt n·ªëi</button>
                    </div>
                </div>

                <!-- Farm List -->
                <div class="px-4 space-y-3">
                    <!-- Critical Farm -->
                    <div class="farm-item urgent" onclick="selectFarm('farm-1')">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <span class="status-dot status-urgent"></span>
                                <span class="font-bold text-red-800">V∆∞·ªùn Anh Hi·ªÅn</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs">Kh·∫©n c·∫•p</span>
                                <i class="fas fa-exclamation-triangle text-red-600"></i>
                            </div>
                        </div>
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm text-gray-600">12.5ha ‚Ä¢ 156 c√¢y ‚Ä¢ C√∫ M'Gar, DL</span>
                            <span class="text-xs text-gray-500">2 gi·ªù tr∆∞·ªõc</span>
                        </div>
                        <div class="bg-red-50 p-2 rounded-lg mb-2">
                            <p class="text-xs text-red-700 font-medium">S√¢u ph·ªß qu·∫£ - 35 c√¢y b·ªã ·∫£nh h∆∞·ªüng</p>
                        </div>
                        
                        <!-- IoT Sensor Data -->
                        <div class="grid grid-cols-3 gap-2 mb-2">
                            <div class="bg-white p-2 rounded text-center">
                                <div class="text-xs text-orange-600 font-bold">34¬∞C</div>
                                <div class="text-xs text-gray-500">Nhi·ªát ƒë·ªô</div>
                            </div>
                            <div class="bg-white p-2 rounded text-center">
                                <div class="text-xs text-blue-600 font-bold">72%</div>
                                <div class="text-xs text-gray-500">ƒê·ªô ·∫©m</div>
                            </div>
                            <div class="bg-white p-2 rounded text-center">
                                <div class="text-xs text-green-600 font-bold">6.2</div>
                                <div class="text-xs text-gray-500">pH ƒë·∫•t</div>
                            </div>
                        </div>
                        
                        <!-- Smart Actions -->
                        <div class="flex space-x-2">
                            <button class="bg-red-500 text-white px-3 py-1 rounded text-xs" onclick="handleFarmEmergency('farm-1')">
                                üö® X·ª≠ l√Ω ngay
                            </button>
                            <button class="bg-blue-500 text-white px-3 py-1 rounded text-xs" onclick="openAICamera('farm-1')">
                                üì∏ AI Scan
                            </button>
                            <button class="bg-green-500 text-white px-3 py-1 rounded text-xs" onclick="startNavigation('farm-1')">
                                üß≠ D·∫´n ƒë∆∞·ªùng
                            </button>
                        </div>
                    </div>

                    <!-- Warning Farm -->
                    <div class="farm-item warning" onclick="selectFarm('farm-2')">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <span class="status-dot status-warning"></span>
                                <span class="font-bold text-yellow-800">V∆∞·ªùn B√°c T√¢m</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span class="bg-yellow-500 text-white px-2 py-1 rounded-full text-xs">Theo d√µi</span>
                                <i class="fas fa-eye text-yellow-600"></i>
                            </div>
                        </div>
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm text-gray-600">8.2ha ‚Ä¢ 98 c√¢y ‚Ä¢ Tr·∫£ng Bom, DN</span>
                            <span class="text-xs text-gray-500">4 gi·ªù tr∆∞·ªõc</span>
                        </div>
                        <div class="bg-yellow-50 p-2 rounded-lg mb-2">
                            <p class="text-xs text-yellow-700 font-medium">Thi·∫øu ph√¢n NPK - C·∫ßn ƒë·∫∑t h√†ng</p>
                        </div>
                        <div class="flex space-x-2">
                            <button class="bg-yellow-500 text-white px-3 py-1 rounded text-xs" onclick="scheduleFertilizer('farm-2')">
                                üì¶ ƒê·∫∑t ph√¢n
                            </button>
                            <button class="bg-blue-500 text-white px-3 py-1 rounded text-xs" onclick="callFarmer('farm-2')">
                                üìû G·ªçi
                            </button>
                            <button class="bg-green-500 text-white px-3 py-1 rounded text-xs" onclick="chatFarmer('farm-2')">
                                üí¨ Chat
                            </button>
                        </div>
                    </div>

                    <!-- Normal Farm -->
                    <div class="farm-item normal" onclick="selectFarm('farm-3')">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <span class="status-dot status-normal"></span>
                                <span class="font-bold text-green-800">V∆∞·ªùn Ch√∫ D≈©ng</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span class="bg-green-500 text-white px-2 py-1 rounded-full text-xs">T·ªët</span>
                                <i class="fas fa-check text-green-600"></i>
                            </div>
                        </div>
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm text-gray-600">15.8ha ‚Ä¢ 201 c√¢y ‚Ä¢ Xu√¢n L·ªôc, DN</span>
                            <span class="text-xs text-gray-500">1 ng√†y tr∆∞·ªõc</span>
                        </div>
                        <div class="bg-green-50 p-2 rounded-lg mb-2">
                            <p class="text-xs text-green-700 font-medium">Ti·∫øn ƒë·ªô b√≥n ph√¢n: 78% ho√†n th√†nh</p>
                        </div>
                        <div class="flex space-x-2">
                            <button class="bg-green-500 text-white px-3 py-1 rounded text-xs" onclick="viewProgress('farm-3')">
                                üìä Xem ti·∫øn ƒë·ªô
                            </button>
                            <button class="bg-blue-500 text-white px-3 py-1 rounded text-xs" onclick="callFarmer('farm-3')">
                                üìû G·ªçi
                            </button>
                            <button class="bg-purple-500 text-white px-3 py-1 rounded text-xs" onclick="scheduleVisit('farm-3')">
                                üìÖ H·∫πn thƒÉm
                            </button>
                        </div>
                    </div>

                    <!-- Show more farms -->
                    <div class="text-center py-4">
                        <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm" onclick="loadMoreFarms()">
                            <i class="fas fa-chevron-down mr-2"></i>Xem th√™m 20 v∆∞·ªùn
                        </button>
                    </div>
                </div>
            </div>

            <!-- Communication Tab - Focused on Manager Reporting -->
            <div id="communication-tab" class="tab-content">
                <div class="card">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-chart-line text-indigo-600 mr-2"></i>
                            B√°o c√°o & Giao ti·∫øp
                        </h3>
                        <div class="flex items-center space-x-2">
                            <div class="flex items-center space-x-1">
                                <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                <span class="text-xs text-green-600">KS. Sang Online</span>
                            </div>
                            <button class="bg-indigo-500 text-white px-3 py-1 rounded-lg text-xs" onclick="quickReport()">
                                <i class="fas fa-paper-plane mr-1"></i>B√°o c√°o nhanh
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Progress Report -->
                <div class="card">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-bold text-gray-800 flex items-center">
                            <i class="fas fa-tasks text-blue-600 mr-2"></i>
                            B√°o c√°o ti·∫øn ƒë·ªô h√¥m nay
                        </h4>
                        <div class="flex items-center space-x-2">
                            <span class="bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs">18/23 ho√†n th√†nh</span>
                            <button class="bg-blue-500 text-white px-3 py-1 rounded-lg text-xs" onclick="sendProgressReport()">
                                üìä G·ª≠i b√°o c√°o
                            </button>
                        </div>
                    </div>
                    
                    <div class="space-y-3">
                        <!-- Completed Tasks -->
                        <div class="bg-green-50 p-3 rounded-lg border border-green-200">
                            <h5 class="font-semibold text-green-800 mb-2 text-sm">‚úÖ Ho√†n th√†nh (18 c√¥ng vi·ªác)</h5>
                            <div class="space-y-1">
                                <div class="flex items-center justify-between text-sm">
                                    <span class="text-green-700">‚Ä¢ X·ª≠ l√Ω s√¢u ph·ªß qu·∫£ - V∆∞·ªùn Anh Hi·ªÅn</span>
                                    <span class="text-xs text-green-600">14:30</span>
                                </div>
                                <div class="flex items-center justify-between text-sm">
                                    <span class="text-green-700">‚Ä¢ Ki·ªÉm tra ph√¢n b√≥n - V∆∞·ªùn B√°c T√¢m</span>
                                    <span class="text-xs text-green-600">11:45</span>
                                </div>
                                <div class="flex items-center justify-between text-sm">
                                    <span class="text-green-700">‚Ä¢ T∆∞·ªõi n∆∞·ªõc kh·∫©n c·∫•p - 3 v∆∞·ªùn</span>
                                    <span class="text-xs text-green-600">09:20</span>
                                </div>
                                <div class="text-center">
                                    <button class="text-xs text-green-600 hover:text-green-800" onclick="viewAllCompleted()">
                                        ... xem t·∫•t c·∫£ 18 c√¥ng vi·ªác
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- In Progress Tasks -->
                        <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200">
                            <h5 class="font-semibold text-yellow-800 mb-2 text-sm">üîÑ ƒêang th·ª±c hi·ªán (3 c√¥ng vi·ªác)</h5>
                            <div class="space-y-1">
                                <div class="flex items-center justify-between text-sm">
                                    <span class="text-yellow-700">‚Ä¢ Ki·ªÉm tra GAP - V∆∞·ªùn Ch·ªã Lan</span>
                                    <span class="text-xs text-yellow-600">60% ho√†n th√†nh</span>
                                </div>
                                <div class="flex items-center justify-between text-sm">
                                    <span class="text-yellow-700">‚Ä¢ T∆∞ v·∫•n n√¥ng d√¢n - V∆∞·ªùn Ch√∫ Minh</span>
                                    <span class="text-xs text-yellow-600">30% ho√†n th√†nh</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Pending Tasks -->
                        <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                            <h5 class="font-semibold text-red-800 mb-2 text-sm">‚è≥ Ch·∫≠m ti·∫øn ƒë·ªô (2 c√¥ng vi·ªác)</h5>
                            <div class="space-y-1">
                                <div class="flex items-center justify-between text-sm">
                                    <span class="text-red-700">‚Ä¢ Phun thu·ªëc ƒë·ªãnh k·ª≥ - V∆∞·ªùn C√¥ Hoa</span>
                                    <span class="text-xs text-red-600">Tr·ªÖ 2 gi·ªù</span>
                                </div>
                                <div class="flex items-center justify-between text-sm">
                                    <span class="text-red-700">‚Ä¢ Ki·ªÉm tra pH ƒë·∫•t - V∆∞·ªùn Anh D≈©ng</span>
                                    <span class="text-xs text-red-600">Ch·ªù thi·∫øt b·ªã</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Manager Communication -->
                <div class="card">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-bold text-gray-800 flex items-center">
                            <i class="fas fa-user-tie text-indigo-600 mr-2"></i>
                            Giao ti·∫øp v·ªõi Qu·∫£n l√Ω
                        </h4>
                        <div class="flex items-center space-x-2">
                            <button class="bg-indigo-500 text-white px-3 py-1 rounded-lg text-xs" onclick="callManager()">
                                üìû G·ªçi
                            </button>
                            <button class="bg-blue-500 text-white px-3 py-1 rounded-lg text-xs" onclick="chatManager()">
                                üí¨ Chat
                            </button>
                        </div>
                    </div>
                    
                    <div class="space-y-3">
                        <!-- Latest conversation -->
                        <div class="bg-indigo-50 p-3 rounded-lg border border-indigo-200">
                            <div class="flex items-center space-x-2 mb-2">
                                <img src="https://via.placeholder.com/32x32/6366F1/FFFFFF?text=KS" alt="Manager" class="w-8 h-8 rounded-full">
                                <div>
                                    <span class="font-semibold text-indigo-800">KS. Nguy·ªÖn VƒÉn Sang</span>
                                    <span class="text-xs text-indigo-600 ml-2">15 ph√∫t tr∆∞·ªõc</span>
                                </div>
                            </div>
                            <p class="text-sm text-indigo-700 mb-2">"Anh Minh l√†m t·ªët l·∫Øm! V∆∞·ªùn Anh Hi·ªÅn ƒë√£ x·ª≠ l√Ω s√¢u ph·ªß qu·∫£ hi·ªáu qu·∫£. Ti·∫øp t·ª•c duy tr√¨ ch·∫•t l∆∞·ª£ng nh∆∞ v·∫≠y."</p>
                            <div class="flex space-x-2">
                                <button class="bg-indigo-500 text-white px-3 py-1 rounded text-xs" onclick="thankManager()">
                                    üôè C·∫£m ∆°n
                                </button>
                                <button class="bg-blue-500 text-white px-3 py-1 rounded text-xs" onclick="shareAdditionalInfo()">
                                    ‚ÑπÔ∏è Th√™m th√¥ng tin
                                </button>
                            </div>
                        </div>
                        
                        <!-- My response -->
                        <div class="bg-blue-50 p-3 rounded-lg border border-blue-200">
                            <div class="flex items-center space-x-2 mb-2">
                                <img src="https://via.placeholder.com/32x32/22C55E/FFFFFF?text=PM" alt="Me" class="w-8 h-8 rounded-full">
                                <div>
                                    <span class="font-semibold text-blue-800">T√¥i</span>
                                    <span class="text-xs text-blue-600 ml-2">2 gi·ªù tr∆∞·ªõc</span>
                                </div>
                            </div>
                            <p class="text-sm text-blue-700 mb-2">"D·∫°, em ƒë√£ ho√†n th√†nh x·ª≠ l√Ω s√¢u ph·ªß qu·∫£ t·∫°i v∆∞·ªùn Anh Hi·ªÅn. T·ª∑ l·ªá hi·ªáu qu·∫£ 95%. ƒê√£ g·ª≠i b√°o c√°o chi ti·∫øt v·ªõi h√¨nh ·∫£nh."</p>
                            <div class="flex space-x-2">
                                <span class="bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs">‚úì ƒê√£ ƒë·ªçc</span>
                                <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-xs">üìé C√≥ ƒë√≠nh k√®m</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Report Actions -->
                <div class="card">
                    <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                        <i class="fas fa-bolt text-orange-600 mr-2"></i>
                        B√°o c√°o nhanh
                    </h4>
                    <div class="grid grid-cols-2 gap-3">
                        <button class="bg-green-50 hover:bg-green-100 p-4 rounded-lg border border-green-200 transition-all text-left" onclick="reportSuccess()">
                            <div class="flex items-center space-x-2 mb-2">
                                <i class="fas fa-check-circle text-green-600"></i>
                                <span class="font-medium text-green-800">Ho√†n th√†nh c√¥ng vi·ªác</span>
                            </div>
                            <p class="text-xs text-green-600">B√°o c√°o k·∫øt qu·∫£ t√≠ch c·ª±c</p>
                        </button>
                        
                        <button class="bg-orange-50 hover:bg-orange-100 p-4 rounded-lg border border-orange-200 transition-all text-left" onclick="reportIssue()">
                            <div class="flex items-center space-x-2 mb-2">
                                <i class="fas fa-exclamation-triangle text-orange-600"></i>
                                <span class="font-medium text-orange-800">B√°o c√°o v·∫•n ƒë·ªÅ</span>
                            </div>
                            <p class="text-xs text-orange-600">C·∫ßn h·ªó tr·ª£ t·ª´ qu·∫£n l√Ω</p>
                        </button>
                        
                        <button class="bg-blue-50 hover:bg-blue-100 p-4 rounded-lg border border-blue-200 transition-all text-left" onclick="requestResources()">
                            <div class="flex items-center space-x-2 mb-2">
                                <i class="fas fa-boxes text-blue-600"></i>
                                <span class="font-medium text-blue-800">Y√™u c·∫ßu v·∫≠t t∆∞</span>
                            </div>
                            <p class="text-xs text-blue-600">ƒê·ªÅ xu·∫•t b·ªï sung thi·∫øt b·ªã</p>
                        </button>
                        
                        <button class="bg-purple-50 hover:bg-purple-100 p-4 rounded-lg border border-purple-200 transition-all text-left" onclick="submitSuggestion()">
                            <div class="flex items-center space-x-2 mb-2">
                                <i class="fas fa-lightbulb text-purple-600"></i>
                                <span class="font-medium text-purple-800">ƒê·ªÅ xu·∫•t c·∫£i ti·∫øn</span>
                            </div>
                            <p class="text-xs text-purple-600">√ù ki·∫øn t·ª´ th·ª±c ƒë·ªãa</p>
                        </button>
                    </div>
                </div>

                <!-- Performance Metrics -->
                <div class="card">
                    <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                        <i class="fas fa-chart-bar text-purple-600 mr-2"></i>
                        Hi·ªáu su·∫•t c·ªßa t√¥i
                    </h4>
                    <div class="grid grid-cols-2 gap-3 mb-3">
                        <div class="bg-gradient-to-r from-green-50 to-emerald-50 p-3 rounded-lg">
                            <div class="flex items-center justify-between mb-1">
                                <span class="text-sm font-medium text-green-800">Tu·∫ßn n√†y</span>
                                <i class="fas fa-arrow-up text-green-500"></i>
                            </div>
                            <div class="text-2xl font-bold text-green-700">94%</div>
                            <div class="text-xs text-green-600">Hi·ªáu su·∫•t t·ªïng th·ªÉ</div>
                        </div>
                        <div class="bg-gradient-to-r from-blue-50 to-sky-50 p-3 rounded-lg">
                            <div class="flex items-center justify-between mb-1">
                                <span class="text-sm font-medium text-blue-800">Ph·∫£n h·ªìi TB</span>
                                <i class="fas fa-clock text-blue-500"></i>
                            </div>
                            <div class="text-2xl font-bold text-blue-700">12 ph√∫t</div>
                            <div class="text-xs text-blue-600">M·ª•c ti√™u: <15 ph√∫t</div>
                        </div>
                    </div>
                    <div class="bg-purple-50 p-3 rounded-lg border border-purple-200">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-medium text-purple-800">Ranking trong ƒë·ªôi</span>
                            <span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs">#1</span>
                        </div>
                        <div class="text-xs text-purple-600">Duy tr√¨ v·ªã tr√≠ s·ªë 1 trong 3 tu·∫ßn li√™n ti·∫øp</div>
                    </div>
                    <div class="flex space-x-2 mt-3">
                        <button class="bg-purple-500 text-white px-3 py-1 rounded text-xs" onclick="viewDetailedStats()">
                            üìä Th·ªëng k√™ chi ti·∫øt
                        </button>
                        <button class="bg-blue-500 text-white px-3 py-1 rounded text-xs" onclick="shareAchievement()">
                            üèÜ Chia s·∫ª th√†nh t√≠ch
                        </button>
                    </div>
                </div>
            </div>

            <!-- Schedule Tab -->
            <div id="schedule-tab" class="tab-content">
                <div class="card">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-calendar-alt text-purple-600 mr-2"></i>
                            L·ªãch thƒÉm v∆∞·ªùn
                        </h3>
                        <div class="flex items-center space-x-2">
                            <button class="bg-purple-500 text-white px-3 py-1 rounded-lg text-xs" onclick="addSchedule()">
                                <i class="fas fa-plus mr-1"></i>Th√™m l·ªãch
                            </button>
                            <button class="bg-blue-500 text-white px-3 py-1 rounded-lg text-xs" onclick="optimizeRoute()">
                                <i class="fas fa-route mr-1"></i>T·ªëi ∆∞u
                            </button>
                        </div>
                    </div>
                    
                    <!-- Calendar View Toggle -->
                    <div class="flex overflow-x-auto space-x-2 mb-4 pb-2">
                        <button class="filter-btn active" onclick="showScheduleView('today')">H√¥m nay</button>
                        <button class="filter-btn" onclick="showScheduleView('week')">Tu·∫ßn n√†y</button>
                        <button class="filter-btn" onclick="showScheduleView('month')">Th√°ng n√†y</button>
                        <button class="filter-btn" onclick="showScheduleView('overdue')">Tr·ªÖ h·∫πn</button>
                    </div>
                    
                    <!-- Route Optimization -->
                    <div class="bg-blue-50 rounded-lg p-3 border border-blue-200 mb-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-bold text-blue-800">L·ªô tr√¨nh t·ªëi ∆∞u h√¥m nay</span>
                            <span class="text-sm text-blue-700">67.3 km ‚Ä¢ 4 gi·ªù</span>
                        </div>
                        <div class="text-sm text-blue-700 mb-2">
                            C√∫ M'Gar ‚Üí Tr·∫£ng Bom ‚Üí Xu√¢n L·ªôc ‚Üí Dƒ© An
                        </div>
                        <button class="bg-blue-500 text-white px-3 py-1 rounded text-xs" onclick="startNavigation()">
                            üó∫Ô∏è B·∫Øt ƒë·∫ßu d·∫´n ƒë∆∞·ªùng
                        </button>
                    </div>
                </div>

                <!-- Schedule List -->
                <div class="px-4 space-y-3">
                    <!-- Today's Schedule -->
                    <div class="schedule-item today">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                                <span class="font-bold text-green-800">8:00 - 11:00</span>
                            </div>
                            <span class="bg-green-500 text-white px-2 py-1 rounded-full text-xs">H√¥m nay</span>
                        </div>
                        <div class="mb-2">
                            <span class="font-medium">V∆∞·ªùn Anh Hi·ªÅn</span>
                            <span class="text-sm text-gray-600 ml-2">‚Ä¢ C√∫ M'Gar, ƒê·ªìng Nai</span>
                        </div>
                        <div class="bg-green-50 p-2 rounded-lg mb-2">
                            <p class="text-sm font-medium text-green-800">M·ª•c ti√™u:</p>
                            <ul class="text-sm text-green-700 list-disc ml-4">
                                <li>Ki·ªÉm tra t√¨nh h√¨nh s√¢u ph·ªß qu·∫£</li>
                                <li>H∆∞·ªõng d·∫´n phun thu·ªëc Imidacloprid</li>
                                <li>ƒê√°nh gi√° hi·ªáu qu·∫£ b√≥n ph√¢n</li>
                            </ul>
                        </div>
                        <div class="flex space-x-2">
                            <button class="bg-green-500 text-white px-3 py-1 rounded text-xs" onclick="startVisit('visit-1')">
                                üöó B·∫Øt ƒë·∫ßu
                            </button>
                            <button class="bg-blue-500 text-white px-3 py-1 rounded text-xs" onclick="callBeforeVisit('visit-1')">
                                üìû G·ªçi tr∆∞·ªõc
                            </button>
                            <button class="bg-gray-500 text-white px-3 py-1 rounded text-xs" onclick="reschedule('visit-1')">
                                üìÖ ƒê·ªïi l·ªãch
                            </button>
                        </div>
                    </div>

                    <!-- Upcoming Visit -->
                    <div class="schedule-item">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                                <span class="font-bold text-blue-800">14:00 - 16:30</span>
                            </div>
                            <span class="bg-blue-500 text-white px-2 py-1 rounded-full text-xs">S·∫Øp t·ªõi</span>
                        </div>
                        <div class="mb-2">
                            <span class="font-medium">V∆∞·ªùn B√°c T√¢m</span>
                            <span class="text-sm text-gray-600 ml-2">‚Ä¢ Tr·∫£ng Bom, ƒê·ªìng Nai</span>
                        </div>
                        <div class="bg-blue-50 p-2 rounded-lg mb-2">
                            <p class="text-sm font-medium text-blue-800">M·ª•c ti√™u:</p>
                            <ul class="text-sm text-blue-700 list-disc ml-4">
                                <li>H∆∞·ªõng d·∫´n b√≥n ph√¢n NPK</li>
                                <li>Ki·ªÉm tra h·ªá th·ªëng t∆∞·ªõi</li>
                                <li>T∆∞ v·∫•n k·∫ø ho·∫°ch thu ho·∫°ch</li>
                            </ul>
                        </div>
                        <div class="flex space-x-2">
                            <button class="bg-blue-500 text-white px-3 py-1 rounded text-xs" onclick="setReminder('visit-2')">
                                ‚è∞ Nh·∫Øc nh·ªü
                            </button>
                            <button class="bg-green-500 text-white px-3 py-1 rounded text-xs" onclick="callBeforeVisit('visit-2')">
                                üìû G·ªçi tr∆∞·ªõc
                            </button>
                        </div>
                    </div>

                    <!-- Overdue Visit -->
                    <div class="schedule-item overdue">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                                <span class="font-bold text-red-800">Th·ª© 6 - Tr·ªÖ h·∫πn</span>
                            </div>
                            <span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs">C·∫ßn x·ª≠ l√Ω</span>
                        </div>
                        <div class="mb-2">
                            <span class="font-medium">V∆∞·ªùn Ch√∫ D≈©ng</span>
                            <span class="text-sm text-gray-600 ml-2">‚Ä¢ Xu√¢n L·ªôc, ƒê·ªìng Nai</span>
                        </div>
                        <div class="bg-red-50 p-2 rounded-lg mb-2">
                            <p class="text-sm font-medium text-red-800">L√Ω do tr·ªÖ:</p>
                            <p class="text-sm text-red-700">Ch√∫ D≈©ng c√≥ vi·ªác ƒë·ªôt xu·∫•t, c·∫ßn ƒë·ªïi l·ªãch</p>
                        </div>
                        <div class="flex space-x-2">
                            <button class="bg-red-500 text-white px-3 py-1 rounded text-xs" onclick="callToReschedule('visit-3')">
                                üìû G·ªçi ƒë·ªïi l·ªãch
                            </button>
                            <button class="bg-yellow-500 text-white px-3 py-1 rounded text-xs" onclick="quickReschedule('visit-3')">
                                üìÖ L√™n l·ªãch m·ªõi
                            </button>
                        </div>
                    </div>

                    <!-- Weekly Summary -->
                    <div class="bg-purple-50 rounded-lg p-3 border border-purple-200">
                        <h4 class="font-bold text-purple-800 mb-2">üìä Th·ªëng k√™ tu·∫ßn n√†y</h4>
                        <div class="grid grid-cols-2 gap-3">
                            <div class="bg-white p-2 rounded text-center">
                                <div class="text-lg font-bold text-purple-700">12</div>
                                <div class="text-xs text-gray-600">L∆∞·ª£t thƒÉm</div>
                            </div>
                            <div class="bg-white p-2 rounded text-center">
                                <div class="text-lg font-bold text-green-700">94%</div>
                                <div class="text-xs text-gray-600">ƒê√∫ng h·∫πn</div>
                            </div>
                            <div class="bg-white p-2 rounded text-center">
                                <div class="text-lg font-bold text-blue-700">3.2h</div>
                                <div class="text-xs text-gray-600">TB/v∆∞·ªùn</div>
                            </div>
                            <div class="bg-white p-2 rounded text-center">
                                <div class="text-lg font-bold text-orange-700">247km</div>
                                <div class="text-xs text-gray-600">T·ªïng qu√£ng ƒë∆∞·ªùng</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tools Tab -->
            <div id="tools-tab" class="tab-content">
                <div class="card">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-toolbox text-orange-600 mr-2"></i>
                            C√¥ng c·ª• K·ªπ thu·∫≠t
                        </h3>
                        <div class="flex items-center space-x-2">
                            <span class="bg-orange-100 text-orange-700 px-2 py-1 rounded-full text-xs">12 c√¥ng c·ª•</span>
                            <button class="bg-orange-500 text-white px-3 py-1 rounded-lg text-xs" onclick="addCustomTool()">
                                <i class="fas fa-plus mr-1"></i>Th√™m
                            </button>
                        </div>
                    </div>
                </div>

                <!-- AI Tools Section -->
                <div class="card">
                    <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                        <i class="fas fa-robot text-blue-600 mr-2"></i>
                        C√¥ng c·ª• AI & Ph√¢n t√≠ch
                    </h4>
                    <div class="grid grid-cols-2 gap-3 mb-4">
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200 cursor-pointer hover:bg-blue-100 transition-all" onclick="openPestIdentifier()">
                            <div class="flex items-center space-x-3">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-search text-blue-600"></i>
                                </div>
                                <div>
                                    <h5 class="font-bold text-blue-800">AI Nh·∫≠n di·ªán S√¢u b·ªánh</h5>
                                    <p class="text-xs text-blue-700">Ch·ª•p ·∫£nh ƒë·ªÉ nh·∫≠n di·ªán</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-green-50 p-4 rounded-lg border border-green-200 cursor-pointer hover:bg-green-100 transition-all" onclick="openDosageCalculator()">
                            <div class="flex items-center space-x-3">
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-calculator text-green-600"></i>
                                </div>
                                <div>
                                    <h5 class="font-bold text-green-800">T√≠nh li·ªÅu l∆∞·ª£ng</h5>
                                    <p class="text-xs text-green-700">Thu·ªëc & ph√¢n b√≥n</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-purple-50 p-4 rounded-lg border border-purple-200 cursor-pointer hover:bg-purple-100 transition-all" onclick="openPlantHealthScanner()">
                            <div class="flex items-center space-x-3">
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-heartbeat text-purple-600"></i>
                                </div>
                                <div>
                                    <h5 class="font-bold text-purple-800">ƒê√°nh gi√° S·ª©c kh·ªèe C√¢y</h5>
                                    <p class="text-xs text-purple-700">Qu√©t l√° & th√¢n c√¢y</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200 cursor-pointer hover:bg-yellow-100 transition-all" onclick="openWeatherAnalyzer()">
                            <div class="flex items-center space-x-3">
                                <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-cloud-sun text-yellow-600"></i>
                                </div>
                                <div>
                                    <h5 class="font-bold text-yellow-800">Ph√¢n t√≠ch Th·ªùi ti·∫øt</h5>
                                    <p class="text-xs text-yellow-700">D·ª± b√°o & khuy·∫øn ngh·ªã</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Tools -->
                <div class="card">
                    <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                        <i class="fas fa-bolt text-orange-600 mr-2"></i>
                        C√¥ng c·ª• Nhanh
                    </h4>
                    <div class="grid grid-cols-3 gap-3 mb-4">
                        <div class="bg-white p-3 rounded-lg border border-gray-200 text-center cursor-pointer hover:shadow-md transition-all" onclick="openVoiceRecorder()">
                            <i class="fas fa-microphone text-red-600 text-xl mb-2"></i>
                            <div class="text-sm font-medium">Ghi √¢m</div>
                            <div class="text-xs text-gray-500">B√°o c√°o b·∫±ng gi·ªçng n√≥i</div>
                        </div>
                        
                        <div class="bg-white p-3 rounded-lg border border-gray-200 text-center cursor-pointer hover:shadow-md transition-all" onclick="openQRScanner()">
                            <i class="fas fa-qrcode text-indigo-600 text-xl mb-2"></i>
                            <div class="text-sm font-medium">Qu√©t QR</div>
                            <div class="text-xs text-gray-500">Nh·∫≠n di·ªán v·∫≠t t∆∞</div>
                        </div>
                        
                        <div class="bg-white p-3 rounded-lg border border-gray-200 text-center cursor-pointer hover:shadow-md transition-all" onclick="openMeasurementTool()">
                            <i class="fas fa-ruler text-green-600 text-xl mb-2"></i>
                            <div class="text-sm font-medium">ƒêo l∆∞·ªùng</div>
                            <div class="text-xs text-gray-500">K√≠ch th∆∞·ªõc & di·ªán t√≠ch</div>
                        </div>
                        
                        <div class="bg-white p-3 rounded-lg border border-gray-200 text-center cursor-pointer hover:shadow-md transition-all" onclick="openColorAnalyzer()">
                            <i class="fas fa-palette text-purple-600 text-xl mb-2"></i>
                            <div class="text-sm font-medium">Ph√¢n t√≠ch M√†u</div>
                            <div class="text-xs text-gray-500">T√¨nh tr·∫°ng l√°</div>
                        </div>
                        
                        <div class="bg-white p-3 rounded-lg border border-gray-200 text-center cursor-pointer hover:shadow-md transition-all" onclick="openOfflineSync()">
                            <i class="fas fa-sync text-blue-600 text-xl mb-2"></i>
                            <div class="text-sm font-medium">Sync Offline</div>
                            <div class="text-xs text-gray-500">ƒê·ªìng b·ªô d·ªØ li·ªáu</div>
                        </div>
                        
                        <div class="bg-white p-3 rounded-lg border border-gray-200 text-center cursor-pointer hover:shadow-md transition-all" onclick="openEmergencyHelp()">
                            <i class="fas fa-exclamation-triangle text-red-600 text-xl mb-2"></i>
                            <div class="text-sm font-medium">SOS</div>
                            <div class="text-xs text-gray-500">H·ªó tr·ª£ kh·∫©n c·∫•p</div>
                        </div>
                    </div>
                </div>

                <!-- Reference Materials -->
                <div class="card">
                    <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                        <i class="fas fa-book-open text-teal-600 mr-2"></i>
                        T√†i li·ªáu Tham kh·∫£o
                    </h4>
                    <div class="space-y-2">
                        <div class="bg-teal-50 p-3 rounded-lg border border-teal-200 cursor-pointer hover:bg-teal-100 transition-all" onclick="openPestGuide()">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-bug text-teal-600"></i>
                                    <div>
                                        <h5 class="font-medium text-teal-800">C·∫©m nang S√¢u b·ªánh</h5>
                                        <p class="text-xs text-teal-700">150+ lo·∫°i s√¢u b·ªánh & c√°ch x·ª≠ l√Ω</p>
                                    </div>
                                </div>
                                <span class="bg-teal-200 text-teal-800 px-2 py-1 rounded-full text-xs">Offline</span>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 p-3 rounded-lg border border-blue-200 cursor-pointer hover:bg-blue-100 transition-all" onclick="openFertilizerGuide()">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-seedling text-blue-600"></i>
                                    <div>
                                        <h5 class="font-medium text-blue-800">H∆∞·ªõng d·∫´n Ph√¢n b√≥n</h5>
                                        <p class="text-xs text-blue-700">Li·ªÅu l∆∞·ª£ng & th·ªùi gian b√≥n</p>
                                    </div>
                                </div>
                                <span class="bg-blue-200 text-blue-800 px-2 py-1 rounded-full text-xs">Offline</span>
                            </div>
                        </div>
                        
                        <div class="bg-purple-50 p-3 rounded-lg border border-purple-200 cursor-pointer hover:bg-purple-100 transition-all" onclick="openGAPStandards()">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-certificate text-purple-600"></i>
                                    <div>
                                        <h5 class="font-medium text-purple-800">Ti√™u chu·∫©n GAP</h5>
                                        <p class="text-xs text-purple-700">VietGAP & GlobalGAP</p>
                                    </div>
                                </div>
                                <span class="bg-purple-200 text-purple-800 px-2 py-1 rounded-full text-xs">Offline</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Equipment Management -->
                <div class="card">
                    <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                        <i class="fas fa-cogs text-gray-600 mr-2"></i>
                        Qu·∫£n l√Ω Thi·∫øt b·ªã
                    </h4>
                    <div class="space-y-2">
                        <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-spray-can text-gray-600"></i>
                                    <div>
                                        <h5 class="font-medium text-gray-800">B√¨nh x·ªãt thu·ªëc</h5>
                                        <p class="text-xs text-gray-600">Cu·ªëi c√πng b·∫£o d∆∞·ª°ng: 5 ng√†y tr∆∞·ªõc</p>
                                    </div>
                                </div>
                                <span class="bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs">T·ªët</span>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-thermometer-half text-gray-600"></i>
                                    <div>
                                        <h5 class="font-medium text-gray-800">Nhi·ªát k·∫ø & pH meter</h5>
                                        <p class="text-xs text-gray-600">C·∫ßn hi·ªáu ch·ªânh</p>
                                    </div>
                                </div>
                                <span class="bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full text-xs">C·∫ßn ki·ªÉm tra</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                <div class="card">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fas fa-graduation-cap text-orange-600 mr-2"></i>
                            Kho ki·∫øn th·ª©c
                        </h3>
                        <div class="flex items-center space-x-2">
                            <button class="bg-orange-500 text-white px-3 py-1 rounded-lg text-xs" onclick="addKnowledge()">
                                <i class="fas fa-plus mr-1"></i>Th√™m t√†i li·ªáu
                            </button>
                            <button class="bg-blue-500 text-white px-3 py-1 rounded-lg text-xs" onclick="searchKnowledge()">
                                <i class="fas fa-search mr-1"></i>T√¨m ki·∫øm
                            </button>
                        </div>
                    </div>
                    
                    <!-- Knowledge Categories -->
                    <div class="flex overflow-x-auto space-x-2 mb-4 pb-2">
                        <button class="filter-btn active" onclick="filterKnowledge('all')">T·∫•t c·∫£</button>
                        <button class="filter-btn" onclick="filterKnowledge('pest')">S√¢u b·ªánh</button>
                        <button class="filter-btn" onclick="filterKnowledge('fertilizer')">Ph√¢n b√≥n</button>
                        <button class="filter-btn" onclick="filterKnowledge('harvest')">Thu ho·∫°ch</button>
                        <button class="filter-btn" onclick="filterKnowledge('standards')">Ti√™u chu·∫©n</button>
                    </div>
                </div>

                <!-- Knowledge List -->
                <div class="px-4 space-y-3">
                    <!-- Pest Control Guide -->
                    <div class="knowledge-item" onclick="openKnowledgeItem('pest-control-guide')">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-bug text-red-600"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="font-medium text-red-800">H∆∞·ªõng d·∫´n ph√≤ng tr·ª´ s√¢u ph·ªß qu·∫£</span>
                                    <span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs">C·∫≠p nh·∫≠t</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-1">Tri·ªáu ch·ª©ng, ph∆∞∆°ng ph√°p ƒëi·ªÅu tr·ªã v√† ph√≤ng ng·ª´a</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs text-gray-500">üìÑ 15 trang</span>
                                    <span class="text-xs text-gray-500">üë• 23 n√¥ng d√¢n ƒë√£ s·ª≠ d·ª•ng</span>
                                    <span class="text-xs text-gray-500">‚≠ê 4.8/5</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Fertilizer Guide -->
                    <div class="knowledge-item" onclick="openKnowledgeItem('fertilizer-guide')">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-seedling text-green-600"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="font-medium text-green-800">K·ªπ thu·∫≠t b√≥n ph√¢n theo giai ƒëo·∫°n</span>
                                    <span class="bg-green-500 text-white px-2 py-1 rounded-full text-xs">Ph·ªï bi·∫øn</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-1">Li·ªÅu l∆∞·ª£ng, th·ªùi gian b√≥n ph√¢n cho t·ª´ng giai ƒëo·∫°n</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs text-gray-500">üìÑ 12 trang</span>
                                    <span class="text-xs text-gray-500">üë• 45 n√¥ng d√¢n ƒë√£ s·ª≠ d·ª•ng</span>
                                    <span class="text-xs text-gray-500">‚≠ê 4.9/5</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- VietGAP Standards -->
                    <div class="knowledge-item" onclick="openKnowledgeItem('vietgap-standards')">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-certificate text-blue-600"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="font-medium text-blue-800">Ti√™u chu·∫©n VietGAP cho s·∫ßu ri√™ng</span>
                                    <span class="bg-blue-500 text-white px-2 py-1 rounded-full text-xs">Ch√≠nh th·ª©c</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-1">Quy tr√¨nh chu·∫©n ƒë·ªÉ ƒë·∫°t ch·ª©ng nh·∫≠n VietGAP</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs text-gray-500">üìÑ 28 trang</span>
                                    <span class="text-xs text-gray-500">üë• 12 n√¥ng d√¢n ƒë√£ √°p d·ª•ng</span>
                                    <span class="text-xs text-gray-500">‚≠ê 4.7/5</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Reference -->
                    <div class="knowledge-item" onclick="openKnowledgeItem('quick-reference')">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-tachometer-alt text-purple-600"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="font-medium text-purple-800">B·∫£ng tra c·ª©u nhanh</span>
                                    <span class="bg-purple-500 text-white px-2 py-1 rounded-full text-xs">Ti·ªán d·ª•ng</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-1">Li·ªÅu l∆∞·ª£ng thu·ªëc, ph√¢n b√≥n, l·ªãch canh t√°c</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs text-gray-500">üìÑ 4 trang</span>
                                    <span class="text-xs text-gray-500">üë• 67 n√¥ng d√¢n ƒë√£ l∆∞u</span>
                                    <span class="text-xs text-gray-500">‚≠ê 4.9/5</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Video Tutorial -->
                    <div class="knowledge-item" onclick="openKnowledgeItem('video-tutorial')">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-play text-red-600"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="font-medium text-red-800">Video: C√°ch nh·∫≠n bi·∫øt s√¢u b·ªánh</span>
                                    <span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs">Video</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-1">H∆∞·ªõng d·∫´n chi ti·∫øt v·ªõi h√¨nh ·∫£nh th·ª±c t·∫ø</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs text-gray-500">üé• 15 ph√∫t</span>
                                    <span class="text-xs text-gray-500">üë• 34 l∆∞·ª£t xem</span>
                                    <span class="text-xs text-gray-500">‚≠ê 4.8/5</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ Section -->
                    <div class="bg-yellow-50 rounded-lg p-3 border border-yellow-200">
                        <h4 class="font-bold text-yellow-800 mb-2">‚ùì C√¢u h·ªèi th∆∞·ªùng g·∫∑p</h4>
                        <div class="space-y-2">
                            <button class="w-full text-left bg-white p-2 rounded border text-sm" onclick="viewFAQ('pest-season')">
                                <span class="font-medium">M√πa n√†o s√¢u b·ªánh xu·∫•t hi·ªán nhi·ªÅu nh·∫•t?</span>
                            </button>
                            <button class="w-full text-left bg-white p-2 rounded border text-sm" onclick="viewFAQ('fertilizer-timing')">
                                <span class="font-medium">Khi n√†o n√™n b√≥n ph√¢n cho hi·ªáu qu·∫£ cao nh·∫•t?</span>
                            </button>
                            <button class="w-full text-left bg-white p-2 rounded border text-sm" onclick="viewFAQ('harvest-signs')">
                                <span class="font-medium">L√†m sao bi·∫øt qu·∫£ s·∫ßu ri√™ng ch√≠n?</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Floating Action Button with Menu -->
        <div class="fab-menu" id="fabMenu">
            <div class="fab-item" onclick="openAIAssistant()">
                <i class="fab-ai fas fa-robot"></i>
                <span>AI Assistant</span>
            </div>
            <div class="fab-item" onclick="openSmartCamera()">
                <i class="fab-camera fas fa-camera"></i>
                <span>AI Camera</span>
            </div>
            <div class="fab-item" onclick="startVoiceReport()">
                <i class="fab-voice fas fa-microphone"></i>
                <span>Voice Report</span>
            </div>
            <div class="fab-item" onclick="startEmergencyCall()">
                <i class="fab-emergency fas fa-phone"></i>
                <span>Emergency</span>
            </div>
            <div class="fab-item" onclick="openQuickNavigation()">
                <i class="fab-nav fas fa-directions"></i>
                <span>Quick Nav</span>
            </div>
        </div>
        
        <button class="fab" id="mainFab" onclick="toggleFabMenu()">
            <i class="fas fa-plus"></i>
        </button>

        <!-- Bottom Navigation - Optimized -->
        <div class="bottom-nav">
            <div class="nav-item active" onclick="showTab('dashboard')">
                <i class="fas fa-tachometer-alt"></i>
                <span>T·ªïng quan</span>
            </div>
            <div class="nav-item" onclick="showTab('tasks')">
                <i class="fas fa-clipboard-check"></i>
                <span>C√¥ng vi·ªác</span>
                <div class="alert-badge">5</div>
            </div>
            <div class="nav-item" onclick="showTab('communication')">
                <i class="fas fa-comments"></i>
                <span>B√°o c√°o</span>
                <div class="alert-badge">3</div>
            </div>
            <div class="nav-item" onclick="showTab('tools')">
                <i class="fas fa-toolbox"></i>
                <span>C√¥ng c·ª•</span>
                <div class="w-2 h-2 bg-orange-500 rounded-full absolute top-1 right-8"></div>
            </div>
        </div>
    </div>

    <script>
        // Tab navigation
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Add active class to clicked nav item
            event.currentTarget.classList.add('active');
        }

        // Dashboard Functions
        function handleMassEmergency(type) {
            showNotification(`Kh·ªüi ƒë·ªông quy tr√¨nh x·ª≠ l√Ω ${type} h√†ng lo·∫°t cho 4 v∆∞·ªùn`, 'warning');
        }

        function createGroupChat(topic) {
            showNotification(`T·∫°o nh√≥m chat v·ªÅ ${topic} v·ªõi 4 n√¥ng d√¢n`, 'info');
        }

        function startVideoCall() {
            showNotification('Kh·ªüi ƒë·ªông video call kh·∫©n c·∫•p...', 'info');
        }

        function createReport() {
            showNotification('T·∫°o b√°o c√°o tu·∫ßn...', 'info');
        }

        function sendBroadcast() {
            showNotification('G·ª≠i th√¥ng b√°o ƒë·∫øn t·∫•t c·∫£ v∆∞·ªùn...', 'info');
        }

        function openKnowledge() {
            showTab('knowledge');
        }

        // Farm Management Functions
        function filterByRegion(region) {
            showNotification(`L·ªçc v∆∞·ªùn theo khu v·ª±c: ${region}`, 'info');
        }

        function filterFarms(filter) {
            showNotification(`L·ªçc v∆∞·ªùn theo tr·∫°ng th√°i: ${filter}`, 'info');
        }

        function selectFarm(farmId) {
            showNotification(`Xem chi ti·∫øt v∆∞·ªùn: ${farmId}`, 'info');
        }

        function handleFarmEmergency(farmId) {
            showNotification(`X·ª≠ l√Ω t√¨nh hu·ªëng kh·∫©n c·∫•p t·∫°i ${farmId}`, 'warning');
        }

        function callFarmer(farmId) {
            showNotification(`G·ªçi ƒëi·ªán cho n√¥ng d√¢n ${farmId}`, 'info');
        }

        function chatFarmer(farmId) {
            showNotification(`M·ªü chat v·ªõi n√¥ng d√¢n ${farmId}`, 'info');
            setTimeout(() => showTab('communication'), 1000);
        }

        function scheduleFertilizer(farmId) {
            showNotification(`L·∫≠p ƒë∆°n ƒë·∫∑t ph√¢n cho ${farmId}`, 'info');
        }

        function viewProgress(farmId) {
            showNotification(`Xem ti·∫øn ƒë·ªô canh t√°c ${farmId}`, 'info');
        }

        function scheduleVisit(farmId) {
            showNotification(`L√™n l·ªãch thƒÉm ${farmId}`, 'info');
            setTimeout(() => showTab('schedule'), 1000);
        }

        // Communication Functions
        function filterCommunications(filter) {
            showNotification(`L·ªçc tin nh·∫Øn theo: ${filter}`, 'info');
        }

        function openChat(farmerId) {
            showNotification(`M·ªü chat v·ªõi ${farmerId}`, 'info');
        }

        function openGroupChat(topic) {
            showNotification(`M·ªü nh√≥m chat v·ªÅ ${topic}`, 'info');
        }

        function callUrgent(farmerId) {
            showNotification(`G·ªçi kh·∫©n c·∫•p cho ${farmerId}`, 'warning');
        }

        function sendQuickReply(farmerId) {
            showNotification(`G·ª≠i ph·∫£n h·ªìi nhanh cho ${farmerId}`, 'info');
        }

        function replyToGroup(groupId) {
            showNotification(`Tr·∫£ l·ªùi trong nh√≥m ${groupId}`, 'info');
        }

        function sendGuide(groupId) {
            showNotification(`G·ª≠i h∆∞·ªõng d·∫´n cho nh√≥m ${groupId}`, 'info');
        }

        function acceptVideoCall(farmerId) {
            showNotification(`Ch·∫•p nh·∫≠n video call t·ª´ ${farmerId}`, 'info');
        }

        function declineVideoCall(farmerId) {
            showNotification(`T·ª´ ch·ªëi video call, chuy·ªÉn sang g·ªçi th∆∞·ªùng`, 'info');
        }

        function followUp(farmerId) {
            showNotification(`Theo d√µi ti·∫øn ƒë·ªô c·ªßa ${farmerId}`, 'info');
        }

        function scheduleCheckup(farmerId) {
            showNotification(`L√™n l·ªãch ki·ªÉm tra cho ${farmerId}`, 'info');
        }

        // Schedule Functions
        function addSchedule() {
            showNotification('Th√™m l·ªãch thƒÉm v∆∞·ªùn m·ªõi...', 'info');
        }

        function optimizeRoute() {
            showNotification('T·ªëi ∆∞u h√≥a l·ªô tr√¨nh thƒÉm v∆∞·ªùn...', 'info');
        }

        function showScheduleView(view) {
            showNotification(`Chuy·ªÉn sang xem l·ªãch: ${view}`, 'info');
        }

        function startNavigation() {
            showNotification('B·∫Øt ƒë·∫ßu d·∫´n ƒë∆∞·ªùng theo l·ªô tr√¨nh t·ªëi ∆∞u...', 'info');
        }

        function startVisit(visitId) {
            showNotification(`B·∫Øt ƒë·∫ßu thƒÉm v∆∞·ªùn: ${visitId}`, 'success');
        }

        function callBeforeVisit(visitId) {
            showNotification(`G·ªçi tr∆∞·ªõc khi thƒÉm: ${visitId}`, 'info');
        }

        function reschedule(visitId) {
            showNotification(`ƒê·ªïi l·ªãch thƒÉm: ${visitId}`, 'info');
        }

        function setReminder(visitId) {
            showNotification(`ƒê·∫∑t nh·∫Øc nh·ªü cho: ${visitId}`, 'info');
        }

        function callToReschedule(visitId) {
            showNotification(`G·ªçi ƒë·ªÉ ƒë·ªïi l·ªãch: ${visitId}`, 'info');
        }

        function quickReschedule(visitId) {
            showNotification(`L√™n l·ªãch m·ªõi nhanh cho: ${visitId}`, 'info');
        }

        // Knowledge Functions
        function addKnowledge() {
            showNotification('Th√™m t√†i li·ªáu ki·∫øn th·ª©c m·ªõi...', 'info');
        }

        function searchKnowledge() {
            showNotification('T√¨m ki·∫øm trong kho ki·∫øn th·ª©c...', 'info');
        }

        function filterKnowledge(category) {
            showNotification(`L·ªçc ki·∫øn th·ª©c theo: ${category}`, 'info');
        }

        function openKnowledgeItem(itemId) {
            showNotification(`M·ªü t√†i li·ªáu: ${itemId}`, 'info');
        }

        function viewFAQ(faqId) {
            showNotification(`Xem c√¢u h·ªèi th∆∞·ªùng g·∫∑p: ${faqId}`, 'info');
        }

        // Updated Tab Management
        function showTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all nav items
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            
            // Show selected tab
            const selectedTab = document.getElementById(tabName + '-tab');
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            
            // Add active class to clicked nav item
            event.target.closest('.nav-item').classList.add('active');
            
            // Update header title based on tab
            updateHeaderTitle(tabName);
            
            // Load tab-specific data
            loadTabData(tabName);
        }

        function updateHeaderTitle(tabName) {
            const headerTitle = document.querySelector('.app-header h1');
            const titles = {
                'dashboard': 'T·ªïng quan',
                'tasks': 'C√¥ng vi·ªác h√¥m nay',
                'communication': 'B√°o c√°o & Giao ti·∫øp',
                'tools': 'C√¥ng c·ª• k·ªπ thu·∫≠t'
            };
            
            if (headerTitle && titles[tabName]) {
                headerTitle.textContent = titles[tabName];
            }
        }

        function loadTabData(tabName) {
            switch(tabName) {
                case 'dashboard':
                    updateDashboardMetrics();
                    break;
                case 'tasks':
                    loadTasksData();
                    break;
                case 'communication':
                    loadCommunicationData();
                    break;
                case 'tools':
                    loadToolsData();
                    break;
            }
        }

        // Manager Communication Functions
        function quickReplyManager() {
            showNotification('G·ª≠i ph·∫£n h·ªìi nhanh...', 'success');
            // Auto-reply to manager
            setTimeout(() => {
                showNotification('ƒê√£ g·ª≠i: "D·∫°, em hi·ªÉu r·ªìi ·∫°!"', 'success');
            }, 1000);
        }

        function askQuestion() {
            showNotification('M·ªü chat v·ªõi qu·∫£n l√Ω...', 'info');
            // Open chat interface with manager
        }

        function sendProgressReport() {
            showNotification('ƒêang g·ª≠i b√°o c√°o ti·∫øn ƒë·ªô...', 'info');
            // Send progress report to manager
            setTimeout(() => {
                showNotification('B√°o c√°o ƒë√£ g·ª≠i th√†nh c√¥ng!', 'success');
            }, 2000);
        }

        function requestSupport() {
            showNotification('G·ª≠i y√™u c·∫ßu h·ªó tr·ª£...', 'info');
            // Request support from manager
        }

        function confirmWithManager(taskId) {
            showNotification('X√°c nh·∫≠n v·ªõi qu·∫£n l√Ω...', 'info');
            // Confirm task understanding with manager
            setTimeout(() => {
                showNotification('ƒê√£ x√°c nh·∫≠n hi·ªÉu r√µ nhi·ªám v·ª•', 'success');
            }, 1500);
        }

        function callManager() {
            showNotification('ƒêang g·ªçi KS. Nguy·ªÖn VƒÉn Sang...', 'info');
        }

        function chatManager() {
            showNotification('M·ªü chat v·ªõi qu·∫£n l√Ω...', 'info');
        }

        function thankManager() {
            showNotification('G·ª≠i l·ªùi c·∫£m ∆°n...', 'success');
        }

        function shareAdditionalInfo() {
            showNotification('Chia s·∫ª th√¥ng tin b·ªï sung...', 'info');
        }

        // Task Management Functions
        function syncWithManager() {
            showNotification('ƒê·ªìng b·ªô v·ªõi h·ªá th·ªëng qu·∫£n l√Ω...', 'info');
            setTimeout(() => {
                showNotification('ƒê√£ c·∫≠p nh·∫≠t 3 c√¥ng vi·ªác m·ªõi', 'success');
                updateTaskBadges();
            }, 2000);
        }

        function filterTasks(filter) {
            const filterBtns = document.querySelectorAll('.task-filter-btn');
            filterBtns.forEach(btn => btn.classList.remove('active'));
            
            const activeBtn = document.getElementById(filter + 'TasksBtn');
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            const taskItems = document.querySelectorAll('.task-item');
            taskItems.forEach(item => {
                if (filter === 'all' || item.classList.contains(filter)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
            
            showNotification(`Hi·ªÉn th·ªã c√¥ng vi·ªác: ${filter}`, 'info');
        }

        function startTask(taskId) {
            showNotification(`B·∫Øt ƒë·∫ßu c√¥ng vi·ªác ${taskId}...`, 'info');
            // Start task execution
            setTimeout(() => {
                showNotification('ƒê√£ b·∫Øt ƒë·∫ßu th·ª±c hi·ªán', 'success');
            }, 1000);
        }

        function acceptTask(taskId) {
            showNotification(`Ch·∫•p nh·∫≠n c√¥ng vi·ªác ${taskId}...`, 'success');
            // Accept task from manager
        }

        function requestDelay(taskId) {
            showNotification('G·ª≠i y√™u c·∫ßu ho√£n...', 'info');
            // Request task delay
        }

        function askForDetails(taskId) {
            showNotification('H·ªèi chi ti·∫øt v·ªÅ c√¥ng vi·ªác...', 'info');
            // Ask manager for task details
        }

        function continueTask(taskId) {
            showNotification(`Ti·∫øp t·ª•c c√¥ng vi·ªác ${taskId}...`, 'info');
            // Continue paused task
        }

        function viewTaskReport(taskId) {
            showNotification('M·ªü b√°o c√°o c√¥ng vi·ªác...', 'info');
            // View task completion report
        }

        function shareSuccess(taskId) {
            showNotification('Chia s·∫ª th√†nh c√¥ng...', 'success');
            // Share successful completion
        }

        function viewFarmMap() {
            showNotification('M·ªü b·∫£n ƒë·ªì v∆∞·ªùn...', 'info');
            // Open farm map view
        }

        function viewWeekSchedule() {
            showNotification('M·ªü l·ªãch tu·∫ßn...', 'info');
            // Open weekly schedule
        }

        function requestScheduleChange() {
            showNotification('G·ª≠i ƒë·ªÅ xu·∫•t thay ƒë·ªïi l·ªãch...', 'info');
            // Request schedule modification
        }

        // Route and Navigation Functions
        function startRoute() {
            showNotification('B·∫Øt ƒë·∫ßu l·ªô tr√¨nh t·ªëi ∆∞u...', 'info');
            // Start optimized route
        }

        function getDirections(farmId) {
            showNotification(`D·∫´n ƒë∆∞·ªùng ƒë·∫øn ${farmId}...`, 'info');
            // Get directions to specific farm
        }

        // Reporting Functions
        function reportSuccess() {
            showNotification('M·ªü form b√°o c√°o th√†nh c√¥ng...', 'success');
            // Open success report form
        }

        function reportIssue() {
            showNotification('M·ªü form b√°o c√°o v·∫•n ƒë·ªÅ...', 'warning');
            // Open issue report form
        }

        function requestResources() {
            showNotification('M·ªü form y√™u c·∫ßu v·∫≠t t∆∞...', 'info');
            // Open resource request form
        }

        function submitSuggestion() {
            showNotification('M·ªü form ƒë·ªÅ xu·∫•t...', 'info');
            // Open suggestion form
        }

        function viewDetailedStats() {
            showNotification('M·ªü th·ªëng k√™ chi ti·∫øt...', 'info');
            // Open detailed statistics
        }

        function shareAchievement() {
            showNotification('Chia s·∫ª th√†nh t√≠ch...', 'success');
            // Share achievement with team
        }

        function viewAllCompleted() {
            showNotification('Hi·ªÉn th·ªã t·∫•t c·∫£ c√¥ng vi·ªác ho√†n th√†nh...', 'info');
            // Show all completed tasks
        }

        // Dashboard Functions
        function updateDashboardMetrics() {
            // Update dashboard metrics
            const metrics = {
                completed: Math.floor(Math.random() * 5) + 16,
                inProgress: Math.floor(Math.random() * 3) + 3,
                urgent: Math.floor(Math.random() * 2) + 1,
                totalFarms: 23
            };
            
            updateMetricCards(metrics);
        }

        function updateMetricCards(metrics) {
            const cards = document.querySelectorAll('.metric-card');
            if (cards.length >= 4) {
                cards[0].querySelector('.text-2xl').textContent = metrics.completed;
                cards[1].querySelector('.text-2xl').textContent = metrics.inProgress;
                cards[2].querySelector('.text-2xl').textContent = metrics.urgent;
                cards[3].querySelector('.text-2xl').textContent = metrics.totalFarms;
            }
        }

        function updateTaskBadges() {
            const badges = document.querySelectorAll('.alert-badge');
            badges.forEach(badge => {
                if (badge.textContent === '5') {
                    badge.textContent = '8';
                } else if (badge.textContent === '3') {
                    badge.textContent = '5';
                }
            });
        }

        // Data Loading Functions
        function loadTasksData() {
            // Load tasks data
            showNotification('ƒêang t·∫£i d·ªØ li·ªáu c√¥ng vi·ªác...', 'info');
        }

        function loadCommunicationData() {
            // Load communication data
            showNotification('ƒêang t·∫£i d·ªØ li·ªáu giao ti·∫øp...', 'info');
        }

        function loadToolsData() {
            // Load tools data
            showNotification('ƒêang t·∫£i c√¥ng c·ª•...', 'info');
        }

        // Performance and Metrics
        function updateMetrics() {
            // Update performance metrics
            const performanceElement = document.querySelector('.text-2xl.text-blue-700');
            if (performanceElement && performanceElement.textContent.includes('%')) {
                const currentValue = parseInt(performanceElement.textContent);
                const newValue = Math.max(85, Math.min(100, currentValue + (Math.random() * 4 - 2)));
                performanceElement.textContent = Math.round(newValue) + '%';
            }
        }

        function updateNotifications() {
            // Update notification counts
            const now = new Date();
            const timeElements = document.querySelectorAll('.text-xs.text-gray-500');
            timeElements.forEach(element => {
                if (element.textContent.includes('ph√∫t tr∆∞·ªõc')) {
                    const minutes = parseInt(element.textContent) + 1;
                    element.textContent = minutes + ' ph√∫t tr∆∞·ªõc';
                }
            });
        }

        function askAI() {
            showNotification('M·ªü AI Assistant...', 'info');
            // Open AI chat interface
        }

        function startOptimizedRoute() {
            showNotification('B·∫Øt ƒë·∫ßu l·ªô tr√¨nh t·ªëi ∆∞u...', 'info');
            // Start GPS navigation with optimized route
        }

        function customizeRoute() {
            showNotification('M·ªü t√πy ch·ªânh l·ªô tr√¨nh...', 'info');
        }

        function openAICamera(farmId) {
            showNotification('M·ªü AI Camera ƒë·ªÉ scan s√¢u b·ªánh...', 'info');
            // Open camera with AI pest detection
        }

        function startNavigation(farmId) {
            showNotification(`B·∫Øt ƒë·∫ßu d·∫´n ƒë∆∞·ªùng ƒë·∫øn ${farmId}...`, 'info');
            // Start GPS navigation
        }

        function startEmergencyCall() {
            showNotification('K·∫øt n·ªëi kh·∫©n c·∫•p v·ªõi trung t√¢m...', 'warning');
        }

        function openCamera() {
            showNotification('M·ªü camera AI...', 'info');
        }

        function toggleNotifications() {
            showNotification('Hi·ªÉn th·ªã th√¥ng b√°o...', 'info');
        }

        // AI Tools Functions
        function openPestIdentifier() {
            showNotification('M·ªü c√¥ng c·ª• nh·∫≠n di·ªán s√¢u b·ªánh AI...', 'info');
            // Open camera with AI pest identification
        }

        function openDosageCalculator() {
            showNotification('M·ªü m√°y t√≠nh li·ªÅu l∆∞·ª£ng...', 'info');
            // Open dosage calculation tool
        }

        function openPlantHealthScanner() {
            showNotification('M·ªü c√¥ng c·ª• ƒë√°nh gi√° s·ª©c kh·ªèe c√¢y...', 'info');
            // Open plant health scanner
        }

        function openWeatherAnalyzer() {
            showNotification('M·ªü ph√¢n t√≠ch th·ªùi ti·∫øt...', 'info');
            // Open weather analysis tool
        }

        // Quick Tools Functions
        function openVoiceRecorder() {
            showNotification('B·∫Øt ƒë·∫ßu ghi √¢m b√°o c√°o...', 'info');
            // Start voice recording
        }

        function openQRScanner() {
            showNotification('M·ªü qu√©t QR code...', 'info');
            // Open QR code scanner
        }

        function openMeasurementTool() {
            showNotification('M·ªü c√¥ng c·ª• ƒëo l∆∞·ªùng AR...', 'info');
            // Open AR measurement tool
        }

        function openColorAnalyzer() {
            showNotification('M·ªü ph√¢n t√≠ch m√†u l√°...', 'info');
            // Open color analysis tool
        }

        function openOfflineSync() {
            showNotification('ƒê·ªìng b·ªô d·ªØ li·ªáu offline...', 'info');
            // Sync offline data
        }

        function openEmergencyHelp() {
            showNotification('K√≠ch ho·∫°t h·ªó tr·ª£ kh·∫©n c·∫•p...', 'warning');
            // Activate emergency help
        }

        // Reference Materials Functions
        function openPestGuide() {
            showNotification('M·ªü c·∫©m nang s√¢u b·ªánh...', 'info');
        }

        function openFertilizerGuide() {
            showNotification('M·ªü h∆∞·ªõng d·∫´n ph√¢n b√≥n...', 'info');
        }

        function openGAPStandards() {
            showNotification('M·ªü ti√™u chu·∫©n GAP...', 'info');
        }

        function addCustomTool() {
            showNotification('Th√™m c√¥ng c·ª• t√πy ch·ªânh...', 'info');
        }
        
        // IoT Functions
        function viewAllSensors() {
            showNotification('M·ªü dashboard IoT ƒë·∫ßy ƒë·ªß...', 'info');
        }
        
        // Enhanced farm management with IoT integration
        function getFarmSensorData(farmId) {
            // Simulate getting real sensor data
            return {
                temperature: Math.round((Math.random() * 10 + 28) * 10) / 10,
                humidity: Math.round((Math.random() * 20 + 60) * 10) / 10,
                soilPH: Math.round((Math.random() * 2 + 5.5) * 10) / 10,
                lightIntensity: Math.round((Math.random() * 30 + 70) * 10) / 10
            };
        }
        
        // Auto-update sensor data every 30 seconds
        function updateSensorData() {
            // Update temperature
            const tempElements = document.querySelectorAll('.sensor-temp');
            tempElements.forEach(element => {
                const newTemp = Math.round((Math.random() * 2 + 30) * 10) / 10;
                element.textContent = newTemp + '¬∞C';
            });
            
            // Update humidity
            const humidityElements = document.querySelectorAll('.sensor-humidity');
            humidityElements.forEach(element => {
                const newHumidity = Math.round((Math.random() * 10 + 65) * 10) / 10;
                element.textContent = newHumidity + '%';
            });
        }
        
        // Voice commands integration
        function startVoiceCommand() {
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'vi-VN';
                
                recognition.onstart = function() {
                    showNotification('ƒêang nghe l·ªánh gi·ªçng n√≥i...', 'info');
                };
                
                recognition.onresult = function(event) {
                    const command = event.results[0][0].transcript.toLowerCase();
                    processVoiceCommand(command);
                };
                
                recognition.onerror = function(event) {
                    showNotification('L·ªói nh·∫≠n di·ªán gi·ªçng n√≥i', 'error');
                };
                
                recognition.start();
            } else {
                showNotification('Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ nh·∫≠n di·ªán gi·ªçng n√≥i', 'error');
            }
        }
        
        function processVoiceCommand(command) {
            if (command.includes('v∆∞·ªùn')) {
                showTab('farms');
                showNotification('ƒê√£ chuy·ªÉn ƒë·∫øn tab V∆∞·ªùn', 'success');
            } else if (command.includes('l·ªãch')) {
                showTab('schedule');
                showNotification('ƒê√£ chuy·ªÉn ƒë·∫øn tab L·ªãch', 'success');
            } else if (command.includes('b√°o c√°o')) {
                createReport();
                showNotification('ƒêang t·∫°o b√°o c√°o...', 'success');
            } else if (command.includes('kh·∫©n c·∫•p')) {
                startEmergencyCall();
                showNotification('K√≠ch ho·∫°t cu·ªôc g·ªçi kh·∫©n c·∫•p', 'warning');
            } else {
                showNotification('Kh√¥ng hi·ªÉu l·ªánh: ' + command, 'info');
            }
        }
        
        // Enhanced offline support
        function enableOfflineMode() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js').then(function(registration) {
                    console.log('Service Worker registered');
                    showNotification('ƒê√£ k√≠ch ho·∫°t ch·∫ø ƒë·ªô offline', 'success');
                }).catch(function(error) {
                    console.log('Service Worker registration failed');
                });
            }
        }
        
        // Check network status
        function checkNetworkStatus() {
            const isOnline = navigator.onLine;
            const statusElement = document.querySelector('.connection-status');
            
            if (isOnline) {
                statusElement.innerHTML = '<div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div><span class="text-xs opacity-80">Online</span>';
            } else {
                statusElement.innerHTML = '<div class="w-2 h-2 bg-red-400 rounded-full"></div><span class="text-xs opacity-80">Offline</span>';
            }
        }
        
        // Enhanced initialization with new features
        function initializeAdvancedFeatures() {
            // Check network status
            checkNetworkStatus();
            
            // Listen for network changes
            window.addEventListener('online', checkNetworkStatus);
            window.addEventListener('offline', checkNetworkStatus);
            
            // Enable offline mode
            enableOfflineMode();
            
            // Start sensor data updates
            setInterval(updateSensorData, 30000);
            
            // Add keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case '1':
                            showTab('dashboard');
                            break;
                        case '2':
                            showTab('farms');
                            break;
                        case '3':
                            showTab('communication');
                            break;
                        case '4':
                            showTab('schedule');
                            break;
                        case '5':
                            showTab('tools');
                            break;
                        case ' ':
                            e.preventDefault();
                            startVoiceCommand();
                            break;
                    }
                }
            });
        }

        function showNotification(message, type = 'info') {
            const colors = {
                'info': 'bg-blue-500',
                'success': 'bg-green-500',
                'warning': 'bg-yellow-500',
                'error': 'bg-red-500'
            };
            
            const notification = document.createElement('div');
            notification.className = `fixed top-20 left-1/2 transform -translate-x-1/2 ${colors[type]} text-white px-4 py-2 rounded-lg text-sm z-50 shadow-lg`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('FarmKeeper Technician App initialized');
            
            // Initialize advanced features
            initializeAdvancedFeatures();
            
            // Simulate real-time updates
            setInterval(() => {
                updateMetrics();
                updateNotifications();
                updateSensorData();
            }, 30000);
            
            // Add touch gestures for mobile
            let touchStartY = 0;
            let touchStartX = 0;
            
            document.addEventListener('touchstart', function(e) {
                touchStartY = e.touches[0].clientY;
                touchStartX = e.touches[0].clientX;
            });
            
            document.addEventListener('touchend', function(e) {
                const touchEndY = e.changedTouches[0].clientY;
                const touchEndX = e.changedTouches[0].clientX;
                const deltaY = touchStartY - touchEndY;
                const deltaX = touchStartX - touchEndX;
                
                // Pull to refresh
                if (deltaY < -100 && Math.abs(deltaX) < 50) {
                    refreshData();
                }
                
                // Swipe left/right to change tabs
                if (Math.abs(deltaX) > 100 && Math.abs(deltaY) < 50) {
                    const currentTab = document.querySelector('.nav-item.active');
                    const tabs = document.querySelectorAll('.nav-item');
                    const currentIndex = Array.from(tabs).indexOf(currentTab);
                    
                    if (deltaX > 0 && currentIndex > 0) {
                        // Swipe right - previous tab
                        tabs[currentIndex - 1].click();
                    } else if (deltaX < 0 && currentIndex < tabs.length - 1) {
                        // Swipe left - next tab
                        tabs[currentIndex + 1].click();
                    }
                }
            });
            
            // Add double tap to refresh
            let lastTap = 0;
            document.addEventListener('touchend', function(e) {
                const currentTime = new Date().getTime();
                const tapLength = currentTime - lastTap;
                if (tapLength < 500 && tapLength > 0) {
                    refreshData();
                }
                lastTap = currentTime;
            });
        });
        
        function refreshData() {
            showNotification('ƒêang l√†m m·ªõi d·ªØ li·ªáu...', 'info');
            // Simulate data refresh
            setTimeout(() => {
                showNotification('D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t', 'success');
                updateMetrics();
                updateSensorData();
            }, 2000);   
        }

        function updateMetrics() {
            // Simulate metric updates
            console.log('Metrics updated');
        }

        function updateNotifications() {
            // Simulate new notifications
            console.log('Notifications updated');
        }
    </script>
</body>
</html>